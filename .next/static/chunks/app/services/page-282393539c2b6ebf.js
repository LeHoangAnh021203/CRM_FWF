(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[763],{6044:(e,t,a)=>{"use strict";a.d(t,{V:()=>l,e:()=>s});var r=a(12115),n=a(90560);function l(e,t){let[a,l]=(0,r.useState)(()=>{try{let t=window.localStorage.getItem(e);if(t){let a=JSON.parse(t);if(e.includes("Date")&&a.year&&a.month&&a.day)return(0,n._U)("".concat(a.year,"-").concat(String(a.month).padStart(2,"0"),"-").concat(String(a.day).padStart(2,"0")));return a}}catch(t){console.warn('Error reading localStorage key "'.concat(e,'":'),t)}return t});return[a,t=>{try{let r="function"==typeof t?t(a):t;l(r),e.includes("Date")&&"object"==typeof r&&null!==r&&"year"in r?window.localStorage.setItem(e,JSON.stringify({year:r.year,month:r.month,day:r.day})):window.localStorage.setItem(e,JSON.stringify(r))}catch(t){console.warn('Error setting localStorage key "'.concat(e,'":'),t)}}]}function s(e){e.forEach(e=>window.localStorage.removeItem(e))}},11518:(e,t,a)=>{"use strict";e.exports=a(82269).style},17606:(e,t,a)=>{"use strict";a.d(t,{n:()=>s,o:()=>l});var r=a(12115);class n{subscribe(e){return this.listeners.add(e),()=>this.listeners.delete(e)}emit(){this.listeners.forEach(e=>e())}constructor(){this.listeners=new Set}}let l=new n;function s(e){let t=(0,r.useCallback)(async t=>{try{await fetch("/api/notifications",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({pageName:e,...t})}),l.emit()}catch(e){console.error("Failed to update page status:",e)}},[e]),a=(0,r.useCallback)(a=>{t({dataLoaded:!0,successCount:1,lastSuccess:a||"Trang ".concat(o(e)," đ\xe3 sẵn s\xe0ng sử dụng")})},[t,e]),n=(0,r.useCallback)(e=>{t({errorCount:1,lastError:e})},[t]),s=(0,r.useCallback)(e=>{t({lastSuccess:e})},[t]),i=(0,r.useCallback)((e,a)=>{t({successCount:1,lastSuccess:a?"Dữ liệu ".concat(e,": ").concat(a.toLocaleString()," bản ghi đ\xe3 sẵn s\xe0ng"):"Dữ liệu ".concat(e," đ\xe3 được tải th\xe0nh c\xf4ng")})},[t]),c=(0,r.useCallback)((e,a)=>{t({errorCount:1,lastError:"Kh\xf4ng thể tải dữ liệu ".concat(e,": ").concat(a)})},[t]),d=(0,r.useCallback)(e=>{t({lastSuccess:"Bộ lọc ".concat(e," đ\xe3 được cập nhật")})},[t]),u=(0,r.useCallback)(()=>{t({lastSuccess:"Tất cả bộ lọc đ\xe3 được đặt lại về mặc định"})},[t]),h=(0,r.useCallback)((e,a)=>{t({lastSuccess:"Biểu đồ ".concat(e,": ").concat(a)})},[t]),m=(0,r.useCallback)(a=>{let r="Trang ".concat(o(e)," đ\xe3 tải xong");a.loadTime&&(r+=" (".concat(a.loadTime,"ms)")),a.dataSize&&(r+=" - ".concat(a.dataSize," bản ghi")),t({dataLoaded:!0,successCount:1,lastSuccess:r})},[t,e]);return(0,r.useEffect)(()=>{t({dataLoaded:!1,errorCount:0,successCount:0})},[t]),{reportPageLoad:a,reportPageError:n,reportPageActivity:s,reportDataLoadSuccess:i,reportDataLoadError:c,reportFilterChange:d,reportResetFilters:u,reportChartInteraction:h,reportPagePerformance:m}}function o(e){return({customers:"Kh\xe1ch h\xe0ng",orders:"Đơn h\xe0ng",services:"Dịch vụ",dashboard:"Tổng quan"})[e]||e}},22635:(e,t,a)=>{Promise.resolve().then(a.bind(a,90837))},37945:(e,t,a)=>{"use strict";a.d(t,{E:()=>i,h:()=>c});var r=a(95155),n=a(12115),l=a(40646),s=a(54861),o=a(54416);let i=e=>{let{type:t,message:a,isVisible:i,onClose:c,duration:d=5e3}=e,[u,h]=(0,n.useState)(!1);if((0,n.useEffect)(()=>{if(i){h(!0);let e=setTimeout(()=>{h(!1),setTimeout(c,300)},d);return()=>clearTimeout(e)}},[i,d,c]),!i)return null;let m="success"===t?"text-green-800":"text-red-800",x="success"===t?l.A:s.A;return(0,r.jsx)("div",{className:"fixed top-4 right-4 z-50 max-w-sm w-full transition-all duration-300 ease-in-out ".concat(u?"opacity-100 translate-y-0":"opacity-0 -translate-y-2"),children:(0,r.jsx)("div",{className:"".concat("success"===t?"bg-green-50":"bg-red-50"," border ").concat("success"===t?"border-green-200":"border-red-200"," rounded-lg shadow-lg p-4"),children:(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)(x,{className:"h-5 w-5 ".concat("success"===t?"text-green-400":"text-red-400")})}),(0,r.jsx)("div",{className:"ml-3 flex-1",children:(0,r.jsx)("p",{className:"text-sm font-medium ".concat(m),children:a})}),(0,r.jsx)("div",{className:"ml-4 flex-shrink-0",children:(0,r.jsx)("button",{onClick:()=>{h(!1),setTimeout(c,300)},className:"inline-flex ".concat(m," hover:").concat(m," focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-").concat("success"===t?"green":"red","-500"),children:(0,r.jsx)(o.A,{className:"h-4 w-4"})})})]})})})},c=()=>{let[e,t]=(0,n.useState)({type:"success",message:"",isVisible:!1});return{notification:e,showSuccess:e=>{t({type:"success",message:e,isVisible:!0})},showError:e=>{t({type:"error",message:e,isVisible:!0})},hideNotification:()=>{t(e=>({...e,isVisible:!1}))}}}},68375:()=>{},82269:(e,t,a)=>{"use strict";var r=a(49509);a(68375);var n=a(12115),l=function(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}(n),s=void 0!==r&&r.env&&!0,o=function(e){return"[object String]"===Object.prototype.toString.call(e)},i=function(){function e(e){var t=void 0===e?{}:e,a=t.name,r=void 0===a?"stylesheet":a,n=t.optimizeForSpeed,l=void 0===n?s:n;c(o(r),"`name` must be a string"),this._name=r,this._deletedRulePlaceholder="#"+r+"-deleted-rule____{}",c("boolean"==typeof l,"`optimizeForSpeed` must be a boolean"),this._optimizeForSpeed=l,this._serverSheet=void 0,this._tags=[],this._injected=!1,this._rulesCount=0;var i="undefined"!=typeof window&&document.querySelector('meta[property="csp-nonce"]');this._nonce=i?i.getAttribute("content"):null}var t,a=e.prototype;return a.setOptimizeForSpeed=function(e){c("boolean"==typeof e,"`setOptimizeForSpeed` accepts a boolean"),c(0===this._rulesCount,"optimizeForSpeed cannot be when rules have already been inserted"),this.flush(),this._optimizeForSpeed=e,this.inject()},a.isOptimizeForSpeed=function(){return this._optimizeForSpeed},a.inject=function(){var e=this;if(c(!this._injected,"sheet already injected"),this._injected=!0,"undefined"!=typeof window&&this._optimizeForSpeed){this._tags[0]=this.makeStyleTag(this._name),this._optimizeForSpeed="insertRule"in this.getSheet(),this._optimizeForSpeed||(s||console.warn("StyleSheet: optimizeForSpeed mode not supported falling back to standard mode."),this.flush(),this._injected=!0);return}this._serverSheet={cssRules:[],insertRule:function(t,a){return"number"==typeof a?e._serverSheet.cssRules[a]={cssText:t}:e._serverSheet.cssRules.push({cssText:t}),a},deleteRule:function(t){e._serverSheet.cssRules[t]=null}}},a.getSheetForTag=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]},a.getSheet=function(){return this.getSheetForTag(this._tags[this._tags.length-1])},a.insertRule=function(e,t){if(c(o(e),"`insertRule` accepts only strings"),"undefined"==typeof window)return"number"!=typeof t&&(t=this._serverSheet.cssRules.length),this._serverSheet.insertRule(e,t),this._rulesCount++;if(this._optimizeForSpeed){var a=this.getSheet();"number"!=typeof t&&(t=a.cssRules.length);try{a.insertRule(e,t)}catch(t){return s||console.warn("StyleSheet: illegal rule: \n\n"+e+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),-1}}else{var r=this._tags[t];this._tags.push(this.makeStyleTag(this._name,e,r))}return this._rulesCount++},a.replaceRule=function(e,t){if(this._optimizeForSpeed||"undefined"==typeof window){var a="undefined"!=typeof window?this.getSheet():this._serverSheet;if(t.trim()||(t=this._deletedRulePlaceholder),!a.cssRules[e])return e;a.deleteRule(e);try{a.insertRule(t,e)}catch(r){s||console.warn("StyleSheet: illegal rule: \n\n"+t+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),a.insertRule(this._deletedRulePlaceholder,e)}}else{var r=this._tags[e];c(r,"old rule at index `"+e+"` not found"),r.textContent=t}return e},a.deleteRule=function(e){if("undefined"==typeof window)return void this._serverSheet.deleteRule(e);if(this._optimizeForSpeed)this.replaceRule(e,"");else{var t=this._tags[e];c(t,"rule at index `"+e+"` not found"),t.parentNode.removeChild(t),this._tags[e]=null}},a.flush=function(){this._injected=!1,this._rulesCount=0,"undefined"!=typeof window?(this._tags.forEach(function(e){return e&&e.parentNode.removeChild(e)}),this._tags=[]):this._serverSheet.cssRules=[]},a.cssRules=function(){var e=this;return"undefined"==typeof window?this._serverSheet.cssRules:this._tags.reduce(function(t,a){return a?t=t.concat(Array.prototype.map.call(e.getSheetForTag(a).cssRules,function(t){return t.cssText===e._deletedRulePlaceholder?null:t})):t.push(null),t},[])},a.makeStyleTag=function(e,t,a){t&&c(o(t),"makeStyleTag accepts only strings as second parameter");var r=document.createElement("style");this._nonce&&r.setAttribute("nonce",this._nonce),r.type="text/css",r.setAttribute("data-"+e,""),t&&r.appendChild(document.createTextNode(t));var n=document.head||document.getElementsByTagName("head")[0];return a?n.insertBefore(r,a):n.appendChild(r),r},t=[{key:"length",get:function(){return this._rulesCount}}],function(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}();function c(e,t){if(!e)throw Error("StyleSheet: "+t+".")}var d=function(e){for(var t=5381,a=e.length;a;)t=33*t^e.charCodeAt(--a);return t>>>0},u={};function h(e,t){if(!t)return"jsx-"+e;var a=String(t),r=e+a;return u[r]||(u[r]="jsx-"+d(e+"-"+a)),u[r]}function m(e,t){"undefined"==typeof window&&(t=t.replace(/\/style/gi,"\\/style"));var a=e+t;return u[a]||(u[a]=t.replace(/__jsx-style-dynamic-selector/g,e)),u[a]}var x=function(){function e(e){var t=void 0===e?{}:e,a=t.styleSheet,r=void 0===a?null:a,n=t.optimizeForSpeed,l=void 0!==n&&n;this._sheet=r||new i({name:"styled-jsx",optimizeForSpeed:l}),this._sheet.inject(),r&&"boolean"==typeof l&&(this._sheet.setOptimizeForSpeed(l),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer=void 0,this._indices={},this._instancesCounts={}}var t=e.prototype;return t.add=function(e){var t=this;void 0===this._optimizeForSpeed&&(this._optimizeForSpeed=Array.isArray(e.children),this._sheet.setOptimizeForSpeed(this._optimizeForSpeed),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),"undefined"==typeof window||this._fromServer||(this._fromServer=this.selectFromServer(),this._instancesCounts=Object.keys(this._fromServer).reduce(function(e,t){return e[t]=0,e},{}));var a=this.getIdAndRules(e),r=a.styleId,n=a.rules;if(r in this._instancesCounts){this._instancesCounts[r]+=1;return}var l=n.map(function(e){return t._sheet.insertRule(e)}).filter(function(e){return -1!==e});this._indices[r]=l,this._instancesCounts[r]=1},t.remove=function(e){var t=this,a=this.getIdAndRules(e).styleId;if(function(e,t){if(!e)throw Error("StyleSheetRegistry: "+t+".")}(a in this._instancesCounts,"styleId: `"+a+"` not found"),this._instancesCounts[a]-=1,this._instancesCounts[a]<1){var r=this._fromServer&&this._fromServer[a];r?(r.parentNode.removeChild(r),delete this._fromServer[a]):(this._indices[a].forEach(function(e){return t._sheet.deleteRule(e)}),delete this._indices[a]),delete this._instancesCounts[a]}},t.update=function(e,t){this.add(t),this.remove(e)},t.flush=function(){this._sheet.flush(),this._sheet.inject(),this._fromServer=void 0,this._indices={},this._instancesCounts={}},t.cssRules=function(){var e=this,t=this._fromServer?Object.keys(this._fromServer).map(function(t){return[t,e._fromServer[t]]}):[],a=this._sheet.cssRules();return t.concat(Object.keys(this._indices).map(function(t){return[t,e._indices[t].map(function(e){return a[e].cssText}).join(e._optimizeForSpeed?"":"\n")]}).filter(function(e){return!!e[1]}))},t.styles=function(e){var t,a;return t=this.cssRules(),void 0===(a=e)&&(a={}),t.map(function(e){var t=e[0],r=e[1];return l.default.createElement("style",{id:"__"+t,key:"__"+t,nonce:a.nonce?a.nonce:void 0,dangerouslySetInnerHTML:{__html:r}})})},t.getIdAndRules=function(e){var t=e.children,a=e.dynamic,r=e.id;if(a){var n=h(r,a);return{styleId:n,rules:Array.isArray(t)?t.map(function(e){return m(n,e)}):[m(n,t)]}}return{styleId:h(r),rules:Array.isArray(t)?t:[t]}},t.selectFromServer=function(){return Array.prototype.slice.call(document.querySelectorAll('[id^="__jsx-"]')).reduce(function(e,t){return e[t.id.slice(2)]=t,e},{})},e}(),g=n.createContext(null);g.displayName="StyleSheetContext";var f=l.default.useInsertionEffect||l.default.useLayoutEffect,p="undefined"!=typeof window?new x:void 0;function b(e){var t=p||n.useContext(g);return t&&("undefined"==typeof window?t.add(e):f(function(){return t.add(e),function(){t.remove(e)}},[e.id,String(e.dynamic)])),null}b.dynamic=function(e){return e.map(function(e){return h(e[0],e[1])}).join(" ")},t.style=b},90837:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>z});var r=a(95155),n=a(12115),l=a(68931),s=a(90560);function o(e){let{startDate:t,endDate:a,setStartDate:l,setEndDate:o,today:i,getLocalTimeZone:c,selectedRegions:d,setSelectedRegions:u,selectedBranches:h,setSelectedBranches:m,selectedServiceTypes:x,setSelectedServiceTypes:g,selectedGenders:f,setSelectedGenders:p,regionOptions:b,locationOptions:v,filteredRegionOptions:y,ALL_SERVICE_TYPES:j,ALL_GENDERS:N,filteredServiceTypes:w,filteredGenders:S,genderActualPrice:C,formatMoneyShort:k}=e,[T,D]=n.useState(""),[_,M]=n.useState("");n.useEffect(()=>{D(i(c()).toString()),M(t?t.toString():"")},[t,c,i]);let[A,E]=(0,n.useState)(!1),[L,R]=(0,n.useState)(!1),[H,V]=(0,n.useState)(!1),[z,F]=(0,n.useState)(!1),[P,K]=(0,n.useState)(""),[Q,W]=(0,n.useState)(""),[I,G]=(0,n.useState)(""),[O,B]=(0,n.useState)(""),U=(0,n.useRef)(null),X=(0,n.useRef)(null),q=(0,n.useRef)(null),Z=(0,n.useRef)(null);return(0,n.useEffect)(()=>{function e(e){U.current&&!U.current.contains(e.target)&&E(!1),X.current&&!X.current.contains(e.target)&&R(!1),q.current&&!q.current.contains(e.target)&&V(!1),Z.current&&!Z.current.contains(e.target)&&F(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,r.jsxs)("div",{className:"w-full flex flex-col gap-4 md:flex-row md:gap-10",children:[(0,r.jsxs)("div",{className:"w-full max-w-xl flex flex-col gap-4 md:flex-row md:gap-4 bg-white p-2 rounded",children:[(0,r.jsxs)("div",{className:"w-full flex flex-col gap-1",children:[(0,r.jsx)("h3",{children:"Start date"}),(0,r.jsx)("input",{type:"date",className:"border rounded p-2 bg-white",value:t.toString(),onChange:e=>{l((0,s._U)(e.target.value))},max:i(c()).toString()})]}),(0,r.jsxs)("div",{className:"w-full flex flex-col gap-1",children:[(0,r.jsx)("h3",{children:"End date"}),(0,r.jsx)("input",{type:"date",className:"border rounded p-2 bg-white",value:a.toString(),onChange:e=>{o((0,s._U)(e.target.value))},min:_,max:T})]})]}),(0,r.jsx)("div",{className:"w-full flex flex-col gap-2",children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:flex-wrap gap-2 w-full",children:[(0,r.jsxs)("div",{className:"relative w-full sm:w-auto",ref:U,children:[(0,r.jsxs)("button",{className:"bg-yellow-300 px-3 py-2 rounded-lg font-bold flex items-center gap-2 w-full sm:w-auto border-b-2 border-yellow-400",onClick:()=>E(e=>!e),type:"button",children:[(0,r.jsx)("span",{className:"material-icons"})," Region"]}),A&&(0,r.jsxs)("div",{className:"absolute z-20 bg-white shadow-xl rounded-b-lg w-full min-w-[250px] border border-yellow-200",children:[(0,r.jsxs)("div",{className:"bg-yellow-200 px-4 py-2 font-bold flex items-center gap-2 border-b border-yellow-300",children:[(0,r.jsx)("input",{type:"checkbox",checked:d.length===b.length,onChange:()=>u(d.length===b.length?[]:b.map(e=>e.name)),className:"accent-yellow-400"}),"Region",(0,r.jsx)("span",{className:"ml-auto",children:"Branches "})]}),(0,r.jsx)("div",{className:"px-2 py-2 border-b",children:(0,r.jsx)("input",{className:"w-full border rounded px-2 py-1",placeholder:"Nhập để t\xecm kiếm",value:P,onChange:e=>K(e.target.value)})}),(0,r.jsx)("div",{className:"max-h-60 overflow-y-auto",children:y.map(e=>(0,r.jsxs)("label",{className:"flex items-center gap-2 px-4 py-2 hover:bg-yellow-50 cursor-pointer border-b last:border-b-0",children:[(0,r.jsx)("input",{type:"checkbox",checked:d.includes(e.name),onChange:()=>{u(t=>t.includes(e.name)?t.filter(t=>t!==e.name):[...t,e.name])},className:"accent-yellow-400"}),(0,r.jsx)("span",{className:"font-medium",children:e.name}),(0,r.jsx)("span",{className:"ml-auto text-right min-w-[70px] font-semibold",children:e.total})]},e.name))})]})]}),(0,r.jsxs)("div",{className:"relative w-full sm:w-auto",ref:X,children:[(0,r.jsxs)("button",{className:"bg-yellow-300 px-3 py-2 rounded-lg font-bold flex items-center gap-2 w-full sm:w-auto border-b-2 border-yellow-400",onClick:()=>R(e=>!e),type:"button",children:[(0,r.jsx)("span",{className:"material-icons"})," Locations"]}),L&&(0,r.jsxs)("div",{className:"absolute z-20 bg-white shadow-xl rounded-b-lg w-full min-w-[220px] border border-yellow-200",children:[(0,r.jsxs)("div",{className:"bg-yellow-100 px-4 py-2 font-bold flex items-center gap-2 border-b border-yellow-200",children:[(0,r.jsx)("input",{type:"checkbox",checked:h.length===v.length,onChange:()=>m(h.length===v.length?[]:[...v]),className:"accent-yellow-400"}),"Locations"]}),(0,r.jsx)("div",{className:"px-2 py-2 border-b",children:(0,r.jsx)("input",{className:"w-full border rounded px-2 py-1",placeholder:"Nhập để t\xecm kiếm",value:Q,onChange:e=>W(e.target.value)})}),(0,r.jsx)("div",{className:"max-h-60 overflow-y-auto",children:v.filter(e=>e.toLowerCase().includes(Q.toLowerCase())).map(e=>(0,r.jsxs)("label",{className:"flex items-center gap-2 px-4 py-2 hover:bg-yellow-50 cursor-pointer border-b last:border-b-0",children:[(0,r.jsx)("input",{type:"checkbox",checked:h.includes(e),onChange:()=>{m(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},className:"accent-yellow-400"}),(0,r.jsx)("span",{className:"font-medium",children:e})]},e))})]})]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2 mb-4",children:[(0,r.jsxs)("div",{className:"relative w-full sm:w-auto",ref:q,children:[(0,r.jsxs)("button",{className:"bg-yellow-300 px-3 py-2 rounded-lg font-bold flex items-center gap-2 w-full sm:w-auto border-b-2 border-yellow-400",onClick:()=>V(e=>!e),type:"button",children:[(0,r.jsx)("span",{className:"material-icons"})," Services"]}),H&&(0,r.jsxs)("div",{className:"absolute z-20 bg-white shadow-xl rounded-b-lg w-full min-w-[180px] border border-yellow-200",children:[(0,r.jsxs)("div",{className:"bg-yellow-200 px-4 py-2 font-bold flex items-center gap-2 border-b border-yellow-300",children:[(0,r.jsx)("input",{type:"checkbox",checked:x.length===j.length,onChange:()=>g(x.length===j.length?[]:j.map(e=>e.key)),className:"accent-yellow-400"}),"Services"]}),(0,r.jsx)("div",{className:"px-2 py-2 border-b",children:(0,r.jsx)("input",{className:"w-full border rounded px-2 py-1",placeholder:"Nhập để t\xecm kiếm",value:I,onChange:e=>G(e.target.value)})}),(0,r.jsx)("div",{className:"max-h-60 overflow-y-auto",children:w.map(e=>(0,r.jsxs)("label",{className:"flex items-center gap-2 px-4 py-2 hover:bg-yellow-50 cursor-pointer border-b last:border-b-0",children:[(0,r.jsx)("input",{type:"checkbox",checked:x.includes(e.key),onChange:()=>{g(t=>t.includes(e.key)?t.filter(t=>t!==e.key):[...t,e.key])},className:"accent-yellow-400"}),(0,r.jsx)("span",{className:"font-medium",children:e.label})]},e.key))})]})]}),(0,r.jsxs)("div",{className:"relative w-full sm:w-auto",ref:Z,children:[(0,r.jsxs)("button",{className:"bg-yellow-300 px-3 py-2 rounded-lg font-bold flex items-center gap-2 w-full sm:w-auto border-b-2 border-yellow-400",onClick:()=>F(e=>!e),type:"button",children:[(0,r.jsx)("span",{className:"material-icons"})," Gender"]}),z&&(0,r.jsxs)("div",{className:"absolute z-20 bg-white shadow-xl rounded-b-lg w-full min-w-[220px] border border-yellow-200",children:[(0,r.jsxs)("div",{className:"bg-yellow-200 px-4 py-2 font-bold flex items-center gap-2 border-b border-yellow-300",children:[(0,r.jsx)("input",{type:"checkbox",checked:f.length===N.length,onChange:()=>p(f.length===N.length?[]:[...N]),className:"accent-yellow-400"}),"Gender",(0,r.jsx)("span",{className:"ml-auto",children:"Actual price "})]}),(0,r.jsx)("div",{className:"px-2 py-2 border-b",children:(0,r.jsx)("input",{className:"w-full border rounded px-2 py-1",placeholder:"Nhập để t\xecm kiếm",value:O,onChange:e=>B(e.target.value)})}),(0,r.jsx)("div",{className:"max-h-60 overflow-y-auto",children:S.map(e=>{var t;let a=(null==(t=C.find(t=>t.gender===e))?void 0:t.total)||0;return(0,r.jsxs)("label",{className:"flex items-center gap-2 px-4 py-2 hover:bg-yellow-50 cursor-pointer border-b last:border-b-0 justify-between",children:[(0,r.jsxs)("span",{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{type:"checkbox",checked:f.includes(e),onChange:()=>{p(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},className:"accent-yellow-400"}),(0,r.jsx)("span",{className:"font-medium",children:e})]}),(0,r.jsx)("span",{className:"text-xs text-gray-500 min-w-[60px] text-right",children:k(a)})]},e)})})]})]})]})]})})]})}var i=a(83540),c=a(3401),d=a(94754),u=a(96025),h=a(52071),m=a(27086),x=a(64683),g=a(56690),f=a(36079);function p(e){let{weeklyServiceChartData:t,isMobile:a}=e,l=n.useMemo(()=>{let e=new Map;return t.forEach(t=>{let a=[t.combo||0,t.service||0,t.addedon||0,t.foxcard||0];e.set(t.date,Math.max(...a))}),e},[t]),s=n.useMemo(()=>{let e={combo:{date:"",value:0},service:{date:"",value:0},addedon:{date:"",value:0},foxcard:{date:"",value:0}};return t.forEach(t=>{(t.combo||0)>e.combo.value&&(e.combo={date:t.date,value:t.combo||0}),(t.service||0)>e.service.value&&(e.service={date:t.date,value:t.service||0}),(t.addedon||0)>e.addedon.value&&(e.addedon={date:t.date,value:t.addedon||0}),(t.foxcard||0)>e.foxcard.value&&(e.foxcard={date:t.date,value:t.foxcard||0})}),e},[t]),o=n.useMemo(()=>{let e=0;return t.forEach(t=>{let a=Math.max(t.combo||0,t.service||0,t.addedon||0,t.foxcard||0);a>e&&(e=a)}),e},[t]);return(0,r.jsxs)("div",{className:"w-full bg-white rounded-xl shadow-lg mt-5 p-2 sm:p-4",children:[(0,r.jsx)("div",{className:"text-sm sm:text-base md:text-xl font-medium text-gray-700 text-center mb-4",children:"Tổng dịch vụ thực hiện trong tuần"}),(0,r.jsx)("div",{className:"w-full overflow-x-auto",children:(0,r.jsx)(i.u,{width:"100%",height:a?300:400,minWidth:280,children:(0,r.jsxs)(c.E,{data:t,margin:{top:a?30:50,right:a?10:30,left:a?10:20,bottom:a?20:5},barCategoryGap:a?2:4,barGap:a?1:2,children:[(0,r.jsx)(d.d,{strokeDasharray:"3 3"}),(0,r.jsx)(u.W,{dataKey:"date",fontSize:a?10:12,angle:a?-45:0,textAnchor:a?"end":"middle",height:a?60:30}),(0,r.jsx)(h.h,{fontSize:a?10:12,width:a?60:80,domain:[0,o]}),(0,r.jsx)(m.m,{contentStyle:{fontSize:a?12:14,backgroundColor:"rgba(255, 255, 255, 0.95)",border:"1px solid #ccc",borderRadius:"4px",padding:"8px"}}),(0,r.jsx)(x.s,{wrapperStyle:{fontSize:a?10:12,paddingTop:a?10:20}}),(0,r.jsx)(g.y,{dataKey:"combo",name:"Combo",fill:"#795548",maxBarSize:a?80:120,children:(0,r.jsx)(f.Z,{dataKey:"combo",position:"top",fontSize:a?10:12,fill:"#795548",formatter:e=>{if("number"==typeof e&&0===e)return"";if(a){let a=t.find(t=>t.combo===e);return a&&a.date===s.combo.date&&e===s.combo.value?e.toString():""}{let a=t.find(t=>t.combo===e);if(!a)return"";let r=l.get(a.date)||0;return"number"==typeof e&&e===r&&e>0?e.toString():""}}})}),(0,r.jsx)(g.y,{dataKey:"service",name:"Dịch vụ",fill:"#c5e1a5",maxBarSize:a?80:120,children:(0,r.jsx)(f.Z,{dataKey:"service",position:"top",fontSize:a?10:12,fill:"#c5e1a5",formatter:e=>{if("number"==typeof e&&0===e)return"";if(a){let a=t.find(t=>t.service===e);return a&&a.date===s.service.date&&e===s.service.value?e.toString():""}{let a=t.find(t=>t.service===e);if(!a)return"";let r=l.get(a.date)||0;return"number"==typeof e&&e===r&&e>0?e.toString():""}}})}),(0,r.jsx)(g.y,{dataKey:"addedon",name:"Added on",fill:"#f16a3f",maxBarSize:a?80:120,children:(0,r.jsx)(f.Z,{dataKey:"addedon",position:"top",fontSize:a?10:12,fill:"#f16a3f",formatter:e=>{if("number"==typeof e&&0===e)return"";if(a){let a=t.find(t=>t.addedon===e);return a&&a.date===s.addedon.date&&e===s.addedon.value?e.toString():""}{let a=t.find(t=>t.addedon===e);if(!a)return"";let r=l.get(a.date)||0;return"number"==typeof e&&e===r&&e>0?e.toString():""}}})}),(0,r.jsx)(g.y,{dataKey:"foxcard",name:"Fox card",fill:"#c86b82",maxBarSize:a?80:120,children:(0,r.jsx)(f.Z,{dataKey:"foxcard",position:"top",fontSize:a?10:12,fill:"#c86b82",formatter:e=>{if("number"==typeof e&&0===e)return"";if(a){let a=t.find(t=>t.foxcard===e);return a&&a.date===s.foxcard.date&&e===s.foxcard.value?e.toString():""}{let a=t.find(t=>t.foxcard===e);if(!a)return"";let r=l.get(a.date)||0;return"number"==typeof e&&e===r&&e>0?e.toString():""}}})})]})})})]})}var b=a(90170),v=a(18357),y=a(54811);let j=e=>{let{active:t,payload:a,label:n}=e;if(t&&a&&a.length){let e=a[0],t=a.reduce((e,t)=>e+t.value,0),l=t>0?(e.value/t*100).toFixed(1):"0",s=(null==n?void 0:n.includes("gi\xe1 buổi"))||(null==n?void 0:n.includes("doanh thu"))||(null==n?void 0:n.includes("Top 10 dịch vụ theo gi\xe1 buổi"));return console.log("Tooltip label:",n,"isRevenueChart:",s,"data.value:",e.value,"total:",t,"percentage:",l),(0,r.jsxs)("div",{className:"bg-white p-3 border border-gray-200 rounded-lg shadow-lg",children:[(0,r.jsx)("p",{className:"font-medium text-gray-900",children:e.name||e.payload.label}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:[s?"Doanh thu: ":"Số lượng: ",(0,r.jsx)("span",{className:"font-semibold",children:s?"".concat((e.value/1e6).toFixed(1),"M VNĐ"):e.value.toLocaleString()})]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Tỷ lệ: ",(0,r.jsxs)("span",{className:"font-semibold",children:[l,"%"]})]})]})}return null};function N(e){let{pieChartData:t,pieTop10Data:a,pieTop10AvgData:n,top10ServicesLoading:l,top10ServicesError:s,top10ServicesUsageLoading:o,top10ServicesUsageError:c,isMobile:d,renderPieLabel:u}=e;return(0,r.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:gap-3",children:[(0,r.jsxs)("div",{className:"w-full sm:w-1/3 bg-white rounded-xl shadow-lg mt-5 p-4",children:[(0,r.jsx)("div",{className:"text-xl font-medium text-gray-700 text-center mb-4",children:"Tỉ lệ dịch vụ/combo/cộng th\xeam"}),(0,r.jsx)(i.u,{width:"100%",height:d?220:320,children:(0,r.jsxs)(b.r,{children:[(0,r.jsx)(v.F,{data:t,dataKey:"value",nameKey:"label",cx:"50%",cy:"50%",outerRadius:d?80:120,label:u,children:t.map(e=>(0,r.jsx)(y.f,{fill:e.color},e.key))}),(0,r.jsx)(m.m,{content:(0,r.jsx)(j,{label:"Tỉ lệ dịch vụ/combo/cộng th\xeam"})})]})}),(0,r.jsx)("div",{className:"overflow-hidden",children:(0,r.jsx)("ul",{className:"flex flex-wrap justify-center gap-2 mt-2 text-xs",children:t.map(e=>(0,r.jsxs)("li",{className:"flex items-start gap-1",children:[(0,r.jsx)("span",{className:"inline-block w-3 h-3 rounded-full flex-shrink-0 mt-0.5",style:{background:e.color}}),(0,r.jsx)("span",{className:"break-words",children:e.label})]},e.key))})})]}),(0,r.jsxs)("div",{className:"w-full sm:w-1/3 bg-white rounded-xl shadow-lg mt-5 p-4",children:[(0,r.jsx)("div",{className:"text-xl font-medium text-gray-700 text-center mb-4",children:"Top 10 dịch vụ theo số lượng"}),l&&(0,r.jsx)("div",{className:"text-blue-600 text-sm text-center mb-4",children:"\uD83D\uDD04 Đang tải dữ liệu top 10 dịch vụ..."}),s&&(0,r.jsxs)("div",{className:"text-red-600 text-sm text-center mb-4",children:["❌ Lỗi API top 10 dịch vụ: ",s]}),(0,r.jsx)(i.u,{width:"100%",height:d?220:320,children:(0,r.jsxs)(b.r,{children:[(0,r.jsx)(v.F,{data:a,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:d?80:120,label:u,children:a.map(e=>(0,r.jsx)(y.f,{fill:e.color},e.name))}),(0,r.jsx)(m.m,{content:(0,r.jsx)(j,{label:"Top 10 dịch vụ theo số lượng"})})]})}),(0,r.jsx)("div",{className:"overflow-hidden",children:(0,r.jsx)("ul",{className:"flex flex-wrap  gap-2 mt-2 text-xs",children:a.map(e=>(0,r.jsxs)("li",{className:"flex items-start gap-1",children:[(0,r.jsx)("span",{className:"inline-block w-3 h-3 rounded-full flex-shrink-0 mt-0.5",style:{background:e.color}}),(0,r.jsx)("span",{className:"break-words",children:e.name})]},e.name))})})]}),(0,r.jsxs)("div",{className:"w-full sm:w-1/3 bg-white rounded-xl shadow-lg mt-5 p-4",children:[(0,r.jsx)("div",{className:"text-xl font-medium text-gray-700 text-center mb-4",children:"Top 10 dịch vụ theo gi\xe1 buổi"}),o&&(0,r.jsx)("div",{className:"text-blue-600 text-sm text-center mb-4",children:"\uD83D\uDD04 Đang tải dữ liệu top 10 dịch vụ theo gi\xe1 buổi..."}),c&&(0,r.jsxs)("div",{className:"text-red-600 text-sm text-center mb-4",children:["❌ Lỗi API top 10 dịch vụ theo gi\xe1 buổi:"," ",c]}),(0,r.jsx)(i.u,{width:"100%",height:d?220:320,children:(0,r.jsxs)(b.r,{children:[(0,r.jsx)(v.F,{data:n,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:d?80:120,label:u,children:n.map(e=>(0,r.jsx)(y.f,{fill:e.color},e.name))}),(0,r.jsx)(m.m,{content:(0,r.jsx)(j,{label:"Top 10 dịch vụ theo gi\xe1 buổi"})})]})}),(0,r.jsx)("div",{className:"overflow-hidden",children:(0,r.jsx)("ul",{className:"flex flex-wrap  gap-2 mt-2 text-xs",children:n.map(e=>(0,r.jsxs)("li",{className:"flex items-start gap-1",children:[(0,r.jsx)("span",{className:"inline-block w-3 h-3 rounded-full flex-shrink-0 mt-0.5",style:{background:e.color}}),(0,r.jsx)("span",{className:"break-words",children:e.name})]},e.name))})})]})]})}var w=a(11518),S=a.n(w);let C=e=>{let{active:t,payload:a,label:n}=e;if(t&&a&&a.length){let e=a[0];return(0,r.jsxs)("div",{className:"bg-white p-3 border border-gray-200 rounded-lg shadow-lg",children:[(0,r.jsx)("p",{className:"font-medium text-gray-900",children:e.name||e.payload.name}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:[(null==n?void 0:n.includes("gi\xe1 buổi"))?"Doanh thu: ":"Số lượng: ",(0,r.jsx)("span",{className:"font-semibold",children:(null==n?void 0:n.includes("gi\xe1 buổi"))?"".concat((e.value/1e6).toFixed(1),"M VNĐ"):e.value.toLocaleString()})]})]})}return null};function k(e){let{bottom3ServicesUsageData:t,bottom3ServicesUsageLoading:a,bottom3ServicesUsageError:n,bottom3ServicesRevenueLoading:l,bottom3ServicesRevenueError:s,bottom3Data:o,bottom3RevenueData:c,filteredPieData:d,isMobile:u}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(S(),{id:"2f0483ac8cc1fbf0",dynamic:[u?"8px":"12px"],children:".recharts-pie-label-text.__jsx-style-dynamic-selector{font-size:".concat(u?"8px":"12px","!important}")}),(0,r.jsxs)("div",{className:S().dynamic([["2f0483ac8cc1fbf0",[u?"8px":"12px"]]])+" flex flex-col lg:flex-row gap-2 justify-center",children:[(0,r.jsxs)("div",{className:S().dynamic([["2f0483ac8cc1fbf0",[u?"8px":"12px"]]])+" w-full lg:w-1/2 bg-white rounded-xl shadow-lg mt-5 p-4",children:[(0,r.jsx)("div",{className:S().dynamic([["2f0483ac8cc1fbf0",[u?"8px":"12px"]]])+" text-lg lg:text-xl font-medium text-gray-700 text-center mb-4",children:"Bottom 3 dịch vụ theo số lượng"}),a&&(0,r.jsx)("div",{className:S().dynamic([["2f0483ac8cc1fbf0",[u?"8px":"12px"]]])+" text-blue-600 text-sm text-center mb-4",children:"\uD83D\uDD04 Đang tải dữ liệu bottom 3 dịch vụ..."}),n&&(0,r.jsxs)("div",{className:S().dynamic([["2f0483ac8cc1fbf0",[u?"8px":"12px"]]])+" text-red-600 text-sm text-center mb-4",children:["❌ Lỗi API bottom 3 dịch vụ: ",n]}),(0,r.jsx)(i.u,{width:"100%",height:u?250:350,children:(0,r.jsxs)(b.r,{children:[(0,r.jsx)(v.F,{data:(()=>{if(t){let e=["#bdbdbd","#9e9e9e","#e0e0e0"];return t.map((t,a)=>({name:t.serviceName,value:t.count,color:e[a%e.length]}))}let e=new Map;d.forEach(t=>{let a=t.serviceName||t.type;e.set(a,(e.get(a)||0)+1)});let a=Array.from(e.entries()).sort((e,t)=>e[1]-t[1]).slice(0,3),r=["#bdbdbd","#9e9e9e","#e0e0e0"];return a.map((e,t)=>{let[a,n]=e;return{name:a,value:n,color:r[t%r.length]}})})(),dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:u?45:90,label:e=>{let{percent:t}=e;return t&&t>.15?"".concat((100*t).toFixed(1),"%"):""},labelLine:!1,isAnimationActive:!1,children:(()=>{if(t){let e=["#bdbdbd","#9e9e9e","#e0e0e0"];return t.map((t,a)=>(0,r.jsx)(y.f,{fill:e[a%e.length]},t.serviceName))}let e=new Map;d.forEach(t=>{let a=t.serviceName||t.type;e.set(a,(e.get(a)||0)+1)});let a=Array.from(e.entries()).sort((e,t)=>e[1]-t[1]).slice(0,3),n=["#bdbdbd","#9e9e9e","#e0e0e0"];return a.map((e,t)=>{let[a]=e;return(0,r.jsx)(y.f,{fill:n[t%n.length]},a)})})()}),(0,r.jsx)(m.m,{content:(0,r.jsx)(C,{label:"Bottom 3 dịch vụ theo số lượng"})})]})}),(0,r.jsx)("div",{className:S().dynamic([["2f0483ac8cc1fbf0",[u?"8px":"12px"]]])+" overflow-hidden",children:(0,r.jsx)("ul",{className:S().dynamic([["2f0483ac8cc1fbf0",[u?"8px":"12px"]]])+" flex flex-wrap gap-2 mt-2 text-xs",children:o.map(e=>(0,r.jsxs)("li",{className:S().dynamic([["2f0483ac8cc1fbf0",[u?"8px":"12px"]]])+" flex items-start gap-1",children:[(0,r.jsx)("span",{style:{background:e.color},className:S().dynamic([["2f0483ac8cc1fbf0",[u?"8px":"12px"]]])+" inline-block w-3 h-3 rounded-full flex-shrink-0 mt-0.5"}),(0,r.jsx)("span",{className:S().dynamic([["2f0483ac8cc1fbf0",[u?"8px":"12px"]]])+" break-words",children:e.name})]},e.name))})})]}),(0,r.jsxs)("div",{className:S().dynamic([["2f0483ac8cc1fbf0",[u?"8px":"12px"]]])+" w-full lg:w-1/2 bg-white rounded-xl shadow-lg mt-5 p-4",children:[(0,r.jsx)("div",{className:S().dynamic([["2f0483ac8cc1fbf0",[u?"8px":"12px"]]])+" text-lg lg:text-xl font-medium text-gray-700 text-center mb-4",children:"Bottom 3 dịch vụ theo gi\xe1 buổi"}),l&&(0,r.jsx)("div",{className:S().dynamic([["2f0483ac8cc1fbf0",[u?"8px":"12px"]]])+" text-blue-600 text-sm text-center mb-4",children:"\uD83D\uDD04 Đang tải dữ liệu bottom 3 dịch vụ theo gi\xe1 buổi..."}),s&&(0,r.jsxs)("div",{className:S().dynamic([["2f0483ac8cc1fbf0",[u?"8px":"12px"]]])+" text-red-600 text-sm text-center mb-4",children:["❌ Lỗi API bottom 3 dịch vụ theo gi\xe1 buổi:"," ",s]}),(0,r.jsx)(i.u,{width:"100%",height:u?250:350,children:(0,r.jsxs)(b.r,{children:[(0,r.jsx)(v.F,{data:c,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:u?45:90,label:e=>{let{percent:t}=e;return t&&t>.15?"".concat((100*t).toFixed(1),"%"):""},labelLine:!1,isAnimationActive:!1,children:c.map(e=>(0,r.jsx)(y.f,{fill:e.color},e.name))}),(0,r.jsx)(m.m,{content:(0,r.jsx)(C,{label:"Bottom 3 dịch vụ theo gi\xe1 buổi"})})]})}),(0,r.jsx)("ul",{className:S().dynamic([["2f0483ac8cc1fbf0",[u?"8px":"12px"]]])+" flex flex-wrap  gap-3 mt-2 text-xs",children:o.map(e=>(0,r.jsxs)("li",{className:S().dynamic([["2f0483ac8cc1fbf0",[u?"8px":"12px"]]])+"  flex gap-1",children:[(0,r.jsx)("span",{style:{background:e.color},className:S().dynamic([["2f0483ac8cc1fbf0",[u?"8px":"12px"]]])+" inline-block w-3 h-3 rounded-full"}),e.name]},e.name))})]})]})]})}function T(e){let{title:t,value:a,delta:n,className:l,valueColor:s}=e,o=null!==n&&n>0,i=null!==n&&n<0;return(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow p-6 flex flex-col items-center min-w-[220px] border-4 transition-all duration-300 hover:scale-105 hover:shadow-lg ".concat(null!=l?l:"border-gray-200"),children:[(0,r.jsx)("div",{className:"text-sm text-gray-700 mb-1 text-center",children:t}),(0,r.jsx)("div",{className:"text-4xl font-bold mb-1 text-center ".concat(null!=s?s:"text-black"),children:a.toLocaleString()}),(0,r.jsxs)("div",{className:"text-lg font-semibold flex items-center gap-1 ".concat(o?"text-green-600":i?"text-red-500":"text-gray-500"),children:[o&&(0,r.jsx)("span",{children:"↑"}),i&&(0,r.jsx)("span",{children:"↓"}),null===n?"N/A":Math.abs(n).toLocaleString()]})]})}function D(e){let{serviceSummary:t,serviceSummaryLoading:a,serviceSummaryError:l}=e,[s,o]=n.useState(0),i=n.useRef(null),c=n.useCallback(()=>{if(i.current){let e=i.current,t=e.scrollLeft,a=e.clientWidth,r=e.scrollWidth-a;t<=0?o(0):t>=r?o(2):o(Math.round(t/r*2))}},[]),d=e=>{if(i.current){let t=i.current,a=t.clientWidth,r=t.scrollWidth-a;t.scrollTo({left:0===e?0:2===e?r:r/2,behavior:"smooth"}),o(e)}},u=n.useMemo(()=>t?{comboThisWeek:t.totalCombo,retailThisWeek:t.totalLe,ctThisWeek:t.totalCT,giftThisWeek:t.totalGift,totalServiceThisWeek:t.totalAll,pendingThisWeek:t.totalPending||0,deltaCombo:t.totalCombo-t.prevCombo,deltaRetail:t.totalLe-t.prevLe,deltaCT:t.totalCT-t.prevCT,deltaGift:t.totalGift-t.prevGift,deltaTotalService:t.totalAll-t.prevAll,deltaPending:(t.totalPending||0)-(t.prevPending||0)}:{comboThisWeek:1629,retailThisWeek:726,ctThisWeek:0,giftThisWeek:0,totalServiceThisWeek:2355,pendingThisWeek:180,deltaCombo:100,deltaRetail:50,deltaCT:0,deltaGift:0,deltaTotalService:150,deltaPending:25},[t]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"w-full mb-2",children:[a&&(0,r.jsx)("div",{className:"text-blue-600 text-sm",children:"\uD83D\uDD04 Đang tải dữ liệu..."}),l&&(0,r.jsxs)("div",{className:"text-red-600 text-sm",children:["❌ Lỗi API: ",l]})]}),(0,r.jsx)("div",{className:"md:hidden w-full mb-5 mt-5",children:(0,r.jsxs)("div",{style:{scrollbarWidth:"thin",scrollbarColor:"#fbbf24 #f3f4f6"},className:"jsx-426aa263b6fa0a9f max-h-96 overflow-y-auto",children:[(0,r.jsx)(S(),{id:"426aa263b6fa0a9f",children:"div.jsx-426aa263b6fa0a9f::-webkit-scrollbar{width:6px}div.jsx-426aa263b6fa0a9f::-webkit-scrollbar-track{background:#f3f4f6;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px}div.jsx-426aa263b6fa0a9f::-webkit-scrollbar-thumb{background:#fbbf24;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px}div.jsx-426aa263b6fa0a9f::-webkit-scrollbar-thumb:hover{background:#f59e0b}"}),(0,r.jsxs)("div",{className:"jsx-426aa263b6fa0a9f flex flex-col gap-4",children:[(0,r.jsx)(T,{title:"Tổng Combo",value:u.comboThisWeek,delta:u.deltaCombo,valueColor:"text-black",className:"bg-[#33a7b5] w-full"}),(0,r.jsx)(T,{title:"Tổng dịch vụ lẻ",value:u.retailThisWeek,delta:u.deltaRetail,valueColor:"text-black",className:"bg-[#9b51e0] w-full"}),(0,r.jsx)(T,{title:"Tổng dịch vụ CT",value:u.ctThisWeek,delta:u.deltaCT,valueColor:"text-black",className:"bg-[#ee2c82] w-full"}),(0,r.jsx)(T,{title:"Tổng qu\xe0 tặng",value:u.giftThisWeek,delta:u.deltaGift,valueColor:"text-black",className:"bg-[#f16a3f] w-full"}),(0,r.jsx)(T,{title:"Tổng dịch vụ thực hiện",value:u.totalServiceThisWeek,delta:u.deltaTotalService,valueColor:"text-black",className:"bg-[#7adcb4] w-full"}),(0,r.jsx)(T,{title:"Tổng dịch vụ chưa thực hiện",value:u.pendingThisWeek,delta:u.deltaPending,valueColor:"text-black",className:"bg-[#ff6b6b] w-full"})]})]})}),(0,r.jsxs)("div",{className:"hidden md:flex flex-col items-center w-full",children:[(0,r.jsxs)("div",{ref:i,onScroll:c,style:{scrollbarWidth:"none",scrollbarColor:"#fbbf24 #f3f4f6"},className:"jsx-fcbb50f812f88ea2 flex overflow-x-auto scrollbar-hide gap-4 mb-5 mt-5 w-[80%]",children:[(0,r.jsx)(S(),{id:"fcbb50f812f88ea2",children:"div.jsx-fcbb50f812f88ea2::-webkit-scrollbar{height:8px}div.jsx-fcbb50f812f88ea2::-webkit-scrollbar-track{background:#f3f4f6;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px}div.jsx-fcbb50f812f88ea2::-webkit-scrollbar-thumb{background:#fbbf24;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px}div.jsx-fcbb50f812f88ea2::-webkit-scrollbar-thumb:hover{background:#f59e0b}"}),(0,r.jsx)(T,{title:"Tổng Combo",value:u.comboThisWeek,delta:u.deltaCombo,valueColor:"text-black",className:"bg-[#33a7b5] flex-shrink-0 w-64"}),(0,r.jsx)(T,{title:"Tổng dịch vụ lẻ",value:u.retailThisWeek,delta:u.deltaRetail,valueColor:"text-black",className:"bg-[#9b51e0] flex-shrink-0 w-64"}),(0,r.jsx)(T,{title:"Tổng dịch vụ CT",value:u.ctThisWeek,delta:u.deltaCT,valueColor:"text-black",className:"bg-[#ee2c82] flex-shrink-0 w-64"}),(0,r.jsx)(T,{title:"Tổng qu\xe0 tặng",value:u.giftThisWeek,delta:u.deltaGift,valueColor:"text-black",className:"bg-[#f16a3f] flex-shrink-0 w-64"}),(0,r.jsx)(T,{title:"Tổng dịch vụ thực hiện",value:u.totalServiceThisWeek,delta:u.deltaTotalService,valueColor:"text-black",className:"bg-[#7adcb4] flex-shrink-0 w-64"}),(0,r.jsx)(T,{title:"Tổng dịch vụ chưa thực hiện",value:u.pendingThisWeek,delta:u.deltaPending,valueColor:"text-black",className:"bg-[#ff6b6b] flex-shrink-0 w-64"})]}),(0,r.jsx)("div",{className:"flex justify-center gap-2 mt-4",children:[0,1,2].map(e=>(0,r.jsx)("button",{onClick:()=>d(e),className:"w-3 h-3 rounded-full transition-all duration-300 ".concat(s===e?"bg-orange-300 scale-25":"bg-gray-300 hover:bg-gray-400"),title:"Card ".concat(e+1)},e))})]})]})}function _(e){let{shopLoading:t,shopError:a,isMobile:n,storeServiceChartData:l}=e;return(0,r.jsxs)("div",{className:"w-full bg-white rounded-xl shadow-lg mt-5 p-4",children:[(0,r.jsx)("div",{className:"text-xl font-medium text-gray-700 text-center mb-4",children:"Tổng dịch vụ thực hiện theo cửa h\xe0ng"}),t&&(0,r.jsx)("div",{className:"text-blue-600 text-sm text-center mb-4",children:"\uD83D\uDD04 Đang tải dữ liệu cửa h\xe0ng..."}),a&&(0,r.jsxs)("div",{className:"text-red-600 text-sm text-center mb-4",children:["❌ Lỗi API cửa h\xe0ng: ",a]}),(0,r.jsx)("div",{className:"w-full overflow-x-auto",children:(0,r.jsx)("div",{className:"min-w-[600px] md:min-w-0 ",children:(0,r.jsx)(i.u,{width:n?500:"100%",height:800,children:(0,r.jsxs)(c.E,{data:l,layout:"vertical",margin:{top:20,right:30,left:n?60:120,bottom:20},children:[(0,r.jsx)(d.d,{strokeDasharray:"3 3"}),(0,r.jsx)(u.W,{type:"number",tickFormatter:e=>e>=1e3?"".concat(e/1e3,"k"):e.toString(),tick:{fontSize:n?10:14}}),(0,r.jsx)(h.h,{dataKey:"store",type:"category",tick:{fontSize:n?10:12},width:n?150:200,tickLine:!1,axisLine:!1,interval:0}),(0,r.jsx)(m.m,{}),(0,r.jsx)(x.s,{wrapperStyle:{fontSize:n?10:14}}),(0,r.jsx)(g.y,{dataKey:"combo",name:"Combo",stackId:"a",fill:"#795548"}),(0,r.jsx)(g.y,{dataKey:"service",name:"Dịch vụ",stackId:"a",fill:"#c5e1a5"}),(0,r.jsx)(g.y,{dataKey:"other",name:"Kh\xe1c",stackId:"a",fill:"#f16a3f",children:(0,r.jsx)(f.Z,{dataKey:"total",position:"right",formatter:e=>"number"==typeof e?e>=1e3?"".concat((e/1e3).toFixed(1),"k"):e.toString():"",fill:"#333",fontSize:n?10:12})})]})})})})]})}function M(e){let{regionLoading:t,regionError:a,isMobile:n,regionChartData:l}=e;return(0,r.jsxs)("div",{className:"w-full bg-white rounded-xl shadow-lg mt-5 p-4",children:[(0,r.jsx)("div",{className:"text-xl font-medium text-gray-700 text-center mb-4",children:"Tổng dịch vụ thực hiện theo khu vực"}),t&&(0,r.jsx)("div",{className:"text-blue-600 text-sm text-center mb-4",children:"\uD83D\uDD04 Đang tải dữ liệu khu vực..."}),a&&(0,r.jsxs)("div",{className:"text-red-600 text-sm text-center mb-4",children:["❌ Lỗi API khu vực: ",a]}),(0,r.jsx)("div",{className:"w-full overflow-x-auto",children:(0,r.jsx)("div",{className:"min-w-[600px] md:min-w-0 ",children:(0,r.jsx)(i.u,{width:n?500:"100%",height:n?400:500,children:(0,r.jsxs)(c.E,{data:l,layout:"vertical",margin:{top:20,right:30,left:n?40:100,bottom:20},children:[(0,r.jsx)(d.d,{strokeDasharray:"3 3"}),(0,r.jsx)(u.W,{type:"number",tickFormatter:e=>e>=1e3?"".concat(e/1e3,"k"):e.toString(),tick:{fontSize:n?10:14}}),(0,r.jsx)(h.h,{dataKey:"region",type:"category",tick:{fontSize:n?10:12},width:n?120:150}),(0,r.jsx)(m.m,{}),(0,r.jsx)(x.s,{wrapperStyle:{fontSize:n?10:14}}),(0,r.jsx)(g.y,{dataKey:"combo",name:"Combo",stackId:"a",fill:"#795548"}),(0,r.jsx)(g.y,{dataKey:"service",name:"Dịch vụ",stackId:"a",fill:"#c5e1a5"}),(0,r.jsx)(g.y,{dataKey:"other",name:"Kh\xe1c",stackId:"a",fill:"#f16a3f"})]})})})})]})}function A(e){let{serviceTableData:t,serviceTableLoading:a,serviceTableError:n,serviceData:l}=e;return(0,r.jsxs)("div",{className:"w-full bg-white rounded-xl shadow-lg mt-5 p-4",children:[(0,r.jsx)("div",{className:"text-lg lg:text-xl font-medium text-gray-700 text-center mb-4",children:"Bảng dịch vụ"}),a&&(0,r.jsx)("div",{className:"text-blue-600 text-sm text-center mb-4",children:"\uD83D\uDD04 Đang tải dữ liệu bảng dịch vụ..."}),n&&(0,r.jsxs)("div",{className:"text-red-600 text-sm text-center mb-4",children:["❌ Lỗi API bảng dịch vụ: ",n]}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsx)("div",{style:{maxHeight:400,overflowY:"auto",scrollbarWidth:"none",msOverflowStyle:"none",width:"100%"},children:(0,r.jsxs)("table",{className:"min-w-[700px] lg:min-w-full text-xs sm:text-sm border table-fixed",style:{tableLayout:"fixed",width:"100%"},children:[(0,r.jsx)("thead",{className:"sticky top-0 z-10",children:(0,r.jsxs)("tr",{className:"bg-yellow-200 text-gray-900",children:[(0,r.jsx)("th",{className:"w-12 px-2 py-2 border text-center font-bold",children:"STT"}),(0,r.jsx)("th",{className:"w-64 px-2 py-2 border text-left font-bold",children:"Dịch vụ"}),(0,r.jsx)("th",{className:"w-24 px-2 py-2 border text-center font-bold",children:"Loại"}),(0,r.jsx)("th",{className:"w-20 px-2 py-2 border text-right font-bold bg-orange-100",children:"Số lượng"}),(0,r.jsx)("th",{className:"w-20 px-2 py-2 border text-right font-bold",children:"Δ"}),(0,r.jsx)("th",{className:"w-24 px-2 py-2 border text-right font-bold",children:"% Số lượng"}),(0,r.jsx)("th",{className:"w-32 px-2 py-2 border text-right font-bold bg-blue-100",children:"Tổng gi\xe1"}),(0,r.jsx)("th",{className:"w-20 px-2 py-2 border text-right font-bold",children:"% Δ"}),(0,r.jsx)("th",{className:"w-24 px-2 py-2 border text-right font-bold",children:"% Tổng gi\xe1"})]})}),(0,r.jsx)("tbody",{children:t?t.map((e,t)=>{var a,n,l,s,o,i,c,d,u,h,m,x;return(0,r.jsxs)("tr",{className:t%2==0?"bg-white":"bg-gray-50",children:[(0,r.jsx)("td",{className:"w-12 px-2 py-1 border text-center",children:t+1}),(0,r.jsx)("td",{className:"w-64 px-2 py-1 border text-left font-medium",title:e.serviceName,children:(0,r.jsxs)("div",{className:"truncate",children:[(0,r.jsx)("span",{className:"hidden lg:inline",children:e.serviceName}),(0,r.jsx)("span",{className:"lg:hidden text-xs",children:e.serviceName.length>15?e.serviceName.substring(0,15)+"...":e.serviceName})]})}),(0,r.jsx)("td",{className:"w-24 px-2 py-1 border text-center",children:e.type}),(0,r.jsx)("td",{className:"w-20 px-2 py-1 border text-right font-bold bg-orange-100 text-orange-700",children:null!=(h=null==(n=e.usageCount)||null==(a=n.toLocaleString)?void 0:a.call(n))?h:e.usageCount}),(0,r.jsxs)("td",{className:"w-20 px-2 py-1 border text-right font-semibold ".concat(e.usageDeltaCount>0?"text-green-600":e.usageDeltaCount<0?"text-red-500":""),children:[null!=(m=null==(s=e.usageDeltaCount)||null==(l=s.toLocaleString)?void 0:l.call(s))?m:e.usageDeltaCount," ",e.usageDeltaCount>0?"↑":e.usageDeltaCount<0?"↓":""]}),(0,r.jsxs)("td",{className:"w-24 px-2 py-1 border text-right",children:[null==(o=e.usagePercent)?void 0:o.toFixed(1),"%"]}),(0,r.jsx)("td",{className:"w-32 px-2 py-1 border text-right font-bold bg-blue-100 text-blue-700",children:null!=(x=null==(c=e.totalRevenue)||null==(i=c.toLocaleString)?void 0:i.call(c))?x:e.totalRevenue}),(0,r.jsxs)("td",{className:"w-20 px-2 py-1 border text-right font-semibold ".concat(e.revenueDeltaPercent>100?"text-green-600":e.revenueDeltaPercent<100?"text-red-500":""),children:[null==(d=e.revenueDeltaPercent)?void 0:d.toFixed(1),"%"," ",e.revenueDeltaPercent>100?"↑":e.revenueDeltaPercent<100?"↓":""]}),(0,r.jsxs)("td",{className:"w-24 px-2 py-1 border text-right",children:[null==(u=e.revenuePercent)?void 0:u.toFixed(1),"%"]})]},"".concat(e.serviceName,"-").concat(t))}):l.map((e,t)=>{var a,n,l,s,o,i,c,d;let u=Math.floor(1e3*Math.random())*(Math.random()>.2?1:-1),h=u>0?(10*Math.random()+100).toFixed(1):(10*Math.random()+90).toFixed(1);return(0,r.jsxs)("tr",{className:t%2==0?"bg-white":"bg-gray-50",children:[(0,r.jsx)("td",{className:"w-12 px-2 py-1 border text-center",children:t+1}),(0,r.jsx)("td",{className:"w-64 px-2 py-1 border text-left font-medium",title:e.tenDichVu,children:(0,r.jsxs)("div",{className:"truncate",children:[(0,r.jsx)("span",{className:"hidden lg:inline",children:e.tenDichVu}),(0,r.jsx)("span",{className:"lg:hidden text-xs",children:e.tenDichVu.length>15?e.tenDichVu.substring(0,15)+"...":e.tenDichVu})]})}),(0,r.jsx)("td",{className:"w-24 px-2 py-1 border text-center",children:e.loaiDichVu}),(0,r.jsx)("td",{className:"w-20 px-2 py-1 border text-right font-bold bg-orange-100 text-orange-700",children:null!=(i=null==(n=e.soLuong)||null==(a=n.toLocaleString)?void 0:a.call(n))?i:e.soLuong}),(0,r.jsxs)("td",{className:"w-20 px-2 py-1 border text-right font-semibold ".concat(u>0?"text-green-600":u<0?"text-red-500":""),children:[null!=(c=null==u||null==(l=u.toLocaleString)?void 0:l.call(u))?c:u," ",u>0?"↑":u<0?"↓":""]}),(0,r.jsxs)("td",{className:"w-24 px-2 py-1 border text-right",children:[e.percentSoLuong,"%"]}),(0,r.jsx)("td",{className:"w-32 px-2 py-1 border text-right font-bold bg-blue-100 text-blue-700",children:null!=(d=null==(o=e.tongGia)||null==(s=o.toLocaleString)?void 0:s.call(o))?d:e.tongGia}),(0,r.jsxs)("td",{className:"w-20 px-2 py-1 border text-right font-semibold ".concat(u>0?"text-green-600":u<0?"text-red-500":""),children:[h,"%"," ",u>0?"↑":u<0?"↓":""]}),(0,r.jsxs)("td",{className:"w-24 px-2 py-1 border text-right",children:[e.percentTongGia,"%"]})]},"".concat(e.tenDichVu,"-").concat(t))})}),(0,r.jsx)("tfoot",{children:(0,r.jsxs)("tr",{className:"bg-gray-100 font-bold border-t-2 border-gray-400 sticky bottom-0 z-10",children:[(0,r.jsx)("td",{className:"w-12 px-2 py-1 border text-center"}),(0,r.jsxs)("td",{className:"w-64 px-2 py-1 border text-left",children:[(0,r.jsx)("span",{className:"hidden lg:inline",children:"Tổng cộng"}),(0,r.jsx)("span",{className:"lg:hidden text-xs",children:"Tổng"})]}),(0,r.jsx)("td",{className:"w-24 px-2 py-1 border text-center"}),(0,r.jsx)("td",{className:"w-20 px-2 py-1 border text-right bg-orange-100 text-orange-700",children:t?t.reduce((e,t)=>e+(t.usageCount||0),0).toLocaleString():l.reduce((e,t)=>e+(t.soLuong||0),0).toLocaleString()}),(0,r.jsx)("td",{className:"w-20 px-2 py-1 border text-right",children:t?(t.reduce((e,t)=>e+(t.usageDeltaCount||0),0)/t.length).toFixed(0):"—"}),(0,r.jsx)("td",{className:"w-24 px-2 py-1 border text-right",children:"100%"}),(0,r.jsx)("td",{className:"w-32 px-2 py-1 border text-right bg-blue-100 text-blue-700",children:t?t.reduce((e,t)=>e+(t.totalRevenue||0),0).toLocaleString():l.reduce((e,t)=>e+(t.tongGia||0),0).toLocaleString()}),(0,r.jsx)("td",{className:"w-20 px-2 py-1 border text-right",children:t?(t.reduce((e,t)=>e+(t.revenueDeltaPercent||0),0)/t.length).toFixed(1):"—"}),(0,r.jsx)("td",{className:"w-24 px-2 py-1 border text-right",children:"100%"})]})})]})})})]})}var E=a(37945),L=a(6044),R=a(17606);let H="https://338bc771545b.ngrok-free.app";function V(e,t,a){let[r,l]=(0,n.useState)(null),[s,o]=(0,n.useState)(!0),[i,c]=(0,n.useState)(null);return(0,n.useEffect)(()=>{if(!e||!H)return void o(!1);o(!0),c(null),fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fromDate:t,toDate:a})}).then(e=>{if(!e.ok){if(404===e.status)return null;throw Error("API error: "+e.status)}return e.json()}).then(e=>{l(e),o(!1)}).catch(e=>{e.message.includes("404")||c(e.message),o(!1)})},[e,t,a]),{data:r,loading:s,error:i}}function z(){let{notification:e,showSuccess:t,showError:a,hideNotification:i}=(0,E.h)(),c=(0,n.useRef)(!1),d=(0,n.useRef)(!1),{reportPageError:u,reportDataLoadSuccess:h,reportFilterChange:m,reportResetFilters:x,reportPagePerformance:g}=(0,R.n)("services"),[f,b]=(0,L.V)("services-startDate",(0,l.Ec)((0,l.Xj)()).subtract({days:7})),[v,y]=(0,L.V)("services-endDate",(0,l.Ec)((0,l.Xj)())),[j,w]=(0,L.V)("services-selectedBranches",[]),[S,C]=(0,L.V)("services-selectedRegions",[]),[T,z]=(0,L.V)("services-selectedServiceTypes",["Kh\xe1ch h\xe0ng Th\xe0nh vi\xean","KH trải nghiệm","Added on","Qu\xe0 tặng"]),[F,P]=(0,L.V)("services-selectedGenders",["Nam","Nữ","#N/A"]),K=f?"".concat(f.year,"-").concat(String(f.month).padStart(2,"0"),"-").concat(String(f.day).padStart(2,"0"),"T00:00:00"):"",Q=v?"".concat(v.year,"-").concat(String(v.month).padStart(2,"0"),"-").concat(String(v.day).padStart(2,"0"),"T23:59:59"):"",{data:W}=V("".concat(H,"/api/service-record/service-type-breakdown"),K,Q),{data:I,loading:G,error:O}=V("".concat(H,"/api/service-record/service-summary"),K,Q),{data:B,loading:U,error:X}=V("".concat(H,"/api/service-record/region"),K,Q);(0,n.useEffect)(()=>{if(I&&!G&&!O){let e=Date.now(),t=I.totalAll||0;g({loadTime:Date.now()-e,dataSize:t}),h("dịch vụ",t)}},[I,G,O,g,h]),(0,n.useEffect)(()=>{O&&u("Lỗi tải dữ liệu dịch vụ: ".concat(O))},[O,u]),(0,n.useEffect)(()=>{S.length>0&&m("khu vực: ".concat(S.join(", ")))},[S,m]),(0,n.useEffect)(()=>{j.length>0&&m("chi nh\xe1nh: ".concat(j.join(", ")))},[j,m]),(0,n.useEffect)(()=>{T.length>0&&m("loại dịch vụ: ".concat(T.join(", ")))},[T,m]);let{data:q,loading:Z,error:J}=V("".concat(H,"/api/service-record/shop"),K,Q),{data:Y,loading:$,error:ee}=V("".concat(H,"/api/service-record/top10-services-revenue"),K,Q),{data:et,loading:ea,error:er}=V("".concat(H,"/api/service-record/top10-services-usage"),K,Q),{data:en,loading:el,error:es}=V("".concat(H,"/api/service-record/bottom3-services-usage"),K,Q),{data:eo,loading:ei,error:ec}=V("".concat(H,"/api/service-record/bottom3-services-revenue"),K,Q),{data:ed,loading:eu,error:eh}=V("".concat(H,"/api/service-record/top-table"),K,Q),em=[O,X,J,ee,er,es,ec,eh],ex=[G,U,Z,$,ea,el,ei,eu].some(e=>e),eg=em.some(e=>e);(0,n.useEffect)(()=>{ex||eg||!I||c.current||(t("Dữ liệu dịch vụ đ\xe3 được tải th\xe0nh c\xf4ng!"),c.current=!0)},[ex,eg,I,t]),(0,n.useEffect)(()=>{eg&&!d.current&&(a("Kh\xf4ng thể kết nối đến API. Vui l\xf2ng thử lại sau."),d.current=!0)},[eg,a]);let ef=640>function(){let[e,t]=(0,n.useState)(1024);return(0,n.useEffect)(()=>{let e;function a(){clearTimeout(e),e=setTimeout(()=>{t(window.innerWidth)},100)}return a(),window.addEventListener("resize",a),()=>{window.removeEventListener("resize",a),clearTimeout(e)}},[]),e}(),ep=[{key:"Kh\xe1ch h\xe0ng Th\xe0nh vi\xean",label:"Combo"},{key:"KH trải nghiệm",label:"Dịch vụ"},{key:"Added on",label:"Added on"},{key:"Qu\xe0 tặng",label:"Gifts"},{key:"Fox card",label:"Fox card"}],eb=["Nam","Nữ","#N/A"],[ev]=(0,n.useState)(""),ey=n.useMemo(()=>["Crescent Mall Q7","Vincom Thảo Điền","Vista Verde","Aeon Mall T\xe2n Ph\xfa Celadon","Westpoint Phạm H\xf9ng","Aeon Mall B\xecnh T\xe2n","Vincom Phan Văn Trị","Vincom Landmark 81","TTTM Estella Place","V\xf5 Thị S\xe1u Q.1","The Sun Avenue","Trương Định Q.3","Hoa Lan Q.PN","Nowzone Q.1","Everrich Infinity Q.5","SC VivoCity","Đảo Ngọc Ngũ X\xe3 HN","Vincom L\xea Văn Việt","The Bonatica Q.TB","Midtown Q.7","Trần Ph\xfa Đ\xe0 Nẵng","Vincom Quang Trung","Vincom B\xe0 Triệu","Imperia Sky Garden HN","Gold Coast Nha Trang","Riviera Point Q7","Saigon Ofice","Millenium Apartment Q.4","Parc Mall Q.8","Saigon Mia Trung Sơn"],[]),ej=n.useMemo(()=>({"Crescent Mall Q7":"HCM","Vincom Thảo Điền":"HCM","Vista Verde":"HCM","Aeon Mall T\xe2n Ph\xfa Celadon":"HCM","Westpoint Phạm H\xf9ng":"HCM","Aeon Mall B\xecnh T\xe2n":"HCM","Vincom Phan Văn Trị":"HCM","Vincom Landmark 81":"HCM","TTTM Estella Place":"HCM","V\xf5 Thị S\xe1u Q.1":"HCM","The Sun Avenue":"HCM","Trương Định Q.3":"HCM","Hoa Lan Q.PN":"HCM","Nowzone Q.1":"HCM","Everrich Infinity Q.5":"HCM","SC VivoCity":"HCM","Vincom L\xea Văn Việt":"HCM","The Bonatica Q.TB":"HCM","Midtown Q.7":"HCM","Riviera Point Q7":"HCM","Saigon Ofice":"HCM","Millenium Apartment Q.4":"HCM","Parc Mall Q.8":"HCM","Saigon Mia Trung Sơn":"HCM","Đảo Ngọc Ngũ X\xe3 HN":"H\xe0 Nội","Imperia Sky Garden HN":"H\xe0 Nội","Vincom B\xe0 Triệu":"H\xe0 Nội","Gold Coast Nha Trang":"Nha Trang","Trần Ph\xfa Đ\xe0 Nẵng":"Đ\xe0 Nẵng","Vincom Quang Trung":"HCM"}),[]),eN=n.useMemo(()=>[...Array.from({length:30},(e,t)=>{let a="".concat(t+1," thg 6"),r=["Crescent Mall Q7","Vincom Thảo Điền","Vista Verde","Aeon Mall T\xe2n Ph\xfa Celadon","Westpoint Phạm H\xf9ng","Aeon Mall B\xecnh T\xe2n","Vincom Phan Văn Trị","Vincom Landmark 81","TTTM Estella Place","V\xf5 Thị S\xe1u Q.1","The Sun Avenue","Trương Định Q.3","Hoa Lan Q.PN","Nowzone Q.1","Everrich Infinity Q.5","SC VivoCity","Đảo Ngọc Ngũ X\xe3 HN","Vincom L\xea Văn Việt","The Bonatica Q.TB","Midtown Q.7","Trần Ph\xfa Đ\xe0 Nẵng","Vincom Quang Trung","Vincom B\xe0 Triệu","Imperia Sky Garden HN","Gold Coast Nha Trang","Riviera Point Q7","Saigon Ofice","Millenium Apartment Q.4","Parc Mall Q.8","Saigon Mia Trung Sơn"];return[{date:a,value:12e5+t%5*2e4+1e3*t,value2:1e6+t%3*15e3+800*t,type:"KH trải nghiệm",status:"New",gender:"Nam",region:ej[r[t%r.length]],branch:r[t%r.length]},{date:a,value:125e4+t%4*18e3+1200*t,value2:105e4+t%2*17e3+900*t,type:"KH trải nghiệm",status:"New",gender:"Nữ",region:ej[r[(t+1)%r.length]],branch:r[(t+1)%r.length]},{date:a,value:13e5+t%6*22e3+1100*t,value2:11e5+t%4*13e3+700*t,type:"Kh\xe1ch h\xe0ng Th\xe0nh vi\xean",status:"New",gender:"Nam",region:ej[r[(t+2)%r.length]],branch:r[(t+2)%r.length]},{date:a,value:135e4+t%3*25e3+900*t,value2:115e4+t%5*12e3+600*t,type:"Kh\xe1ch h\xe0ng Th\xe0nh vi\xean",status:"New",gender:"Nữ",region:ej[r[(t+3)%r.length]],branch:r[(t+3)%r.length]}]}).flat()],[ej]),ew=[{date:"9 thg 6, 2025",HCM:100,HaNoi:90,DaNang:80,NhaTrang:70,DaDongCua:60,type:"Tổng",status:"All"},{date:"8 thg 6, 2025",HCM:100,HaNoi:90,DaNang:80,NhaTrang:70,DaDongCua:60,type:"Tổng",status:"All"},{date:"7 thg 6, 2025",HCM:100,HaNoi:90,DaNang:80,NhaTrang:70,DaDongCua:60,type:"Tổng",status:"All"},{date:"6 thg 6, 2025",HCM:100,HaNoi:90,DaNang:80,NhaTrang:70,DaDongCua:60,type:"Tổng",status:"All"},{date:"5 thg 6, 2025",HCM:100,HaNoi:90,DaNang:80,NhaTrang:70,DaDongCua:60,type:"Tổng",status:"All"},{date:"4 thg 6, 2025",HCM:100,HaNoi:90,DaNang:80,NhaTrang:70,DaDongCua:60,type:"Tổng",status:"All"},{date:"3 thg 6, 2025",HCM:100,HaNoi:90,DaNang:80,NhaTrang:70,DaDongCua:60,type:"Tổng",status:"All"},{date:"1 thg 6, 2025",HCM:100,HaNoi:90,DaNang:80,NhaTrang:70,DaDongCua:60,type:"Tổng",status:"All"},{date:"2 thg 6, 2025",HCM:100,HaNoi:90,DaNang:80,NhaTrang:70,DaDongCua:60,type:"Tổng",status:"All"}],eS=n.useCallback((e,t,a)=>{let r=function(e){let t=e.match(/^(\d{1,2}) thg (\d{1,2}), (\d{4})$/);if(t){let[,e,a,r]=t;return(0,s._U)("".concat(r,"-").concat(a.padStart(2,"0"),"-").concat(e.padStart(2,"0")))}if(t=e.match(/^(\d{1,2}) thg (\d{1,2})$/)){let[,e,a]=t,r=String(new Date().getFullYear());return(0,s._U)("".concat(r,"-").concat(a.padStart(2,"0"),"-").concat(e.padStart(2,"0")))}throw Error("Invalid date format: "+e)}(e.date);return r.compare(t)>=0&&0>=r.compare(a)},[]),eC=f.subtract({days:7}),ek=f.subtract({days:1}),eT=eM(ew,S,j),eD=eM(ew,S,j),e_=["HCM","H\xe0 Nội","Đ\xe0 Nẵng","Nha Trang","Đ\xe3 Đ\xf3ng Cửa","Kh\xe1c"].map(e=>{let t=eN.filter(t=>t.region===e&&eS(t,f,v)).length,a=eN.filter(t=>t.region===e&&eS(t,eC,ek)).length,r=function(e){switch(e){case"HCM":default:return"HCM";case"H\xe0 Nội":return"HaNoi";case"Đ\xe0 Nẵng":return"DaNang";case"Nha Trang":return"NhaTrang";case"Đ\xe3 Đ\xf3ng Cửa":return"DaDongCua";case"Kh\xe1c":return"Khac"}}(e),n=eT.reduce((e,t)=>{var a;return e+Number(null!=(a=t[r])?a:0)},0),l=eD.reduce((e,t)=>{var a;return e+Number(null!=(a=t[r])?a:0)},0);return{region:e,ordersThisWeek:t,deltaOrders:t-a,revenueThisWeek:n,percentDelta:0===l?null:(n-l)/l*100,revenueLastWeek:l}});function eM(e,t,a){return e.filter(e=>{let r=!t||0===t.length||!e.region||t.includes(e.region),n=!a||0===a.length||!e.branch||a.includes(e.branch);return r&&n})}let[eA]=(0,n.useState)(""),[eE]=(0,n.useState)(""),eL=(0,n.useRef)(null),eR=(0,n.useRef)(null);(0,n.useEffect)(()=>{function e(e){eL.current&&eL.current.contains(e.target),eR.current&&eR.current.contains(e.target)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let eH=ep.filter(e=>e.label.toLowerCase().includes(eA.toLowerCase())),eV=eb.filter(e=>e.toLowerCase().includes(eE.toLowerCase())),ez=e_.map(e=>({name:e.region,total:Object.values(ej).filter(t=>t===e.region).length})),eF=n.useMemo(()=>ez.filter(e=>e.name.toLowerCase().includes(ev.toLowerCase())),[ez,ev]),eP={};ey.forEach(e=>{eP[e]=eN.filter(t=>t.branch===e&&eS(t,f,v)).reduce((e,t)=>e+t.value,0)});let eK={};eN.forEach(e=>{"Kh\xe1ch h\xe0ng Th\xe0nh vi\xean"!==e.type&&(eK[e.date]||(eK[e.date]={count:0,avgPerShop:0}),eK[e.date].count++)}),Object.keys(eK).forEach(e=>{let t=new Set(eN.filter(t=>t.date===e&&"Kh\xe1ch h\xe0ng Th\xe0nh vi\xean"!==t.type).map(e=>e.branch));eK[e].avgPerShop=t.size>0?Math.round(eK[e].count/t.size):0});let eQ=Object.entries(eK).sort((e,t)=>{let[a,r]=e[0].split(" thg "),[n,l]=t[0].split(" thg ");return Number(r)!==Number(l)?Number(r)-Number(l):Number(a)-Number(n)}),eW=[240,173,201,281,269,167,166,131,228,247,380,403,217,193,210,236,244,367,411,271,256,288,291,358,398,309,191,49,17,31,67];eQ.forEach((e,t)=>{let[,a]=e;a.count=eW[t%eW.length],a.avgPerShop=5+Math.floor(11*Math.random())});let eI=n.useMemo(()=>{let e=[],t=f;for(;0>=t.compare(v);)e.push(t),t=t.add({days:1});return e},[f,v]),eG=n.useMemo(()=>{if(!W)return eI.map(e=>({date:"".concat(e.day," thg ").concat(e.month),combo:0,service:0,addedon:0,foxcard:0}));let e=new Map;return eI.forEach(t=>{let a="".concat(t.year,"-").concat(String(t.month).padStart(2,"0"),"-").concat(String(t.day).padStart(2,"0"));e.set(a,{combo:0,service:0,addedon:0,foxcard:0})}),W.forEach(t=>{let a=t.date,r=e.get(a);if(r)switch(t.type){case"Combo":r.combo=t.count;break;case"Dịch vụ":r.service=t.count;break;case"Kh\xe1c":r.addedon=t.count}}),eI.map(t=>{let a="".concat(t.year,"-").concat(String(t.month).padStart(2,"0"),"-").concat(String(t.day).padStart(2,"0")),r=e.get(a)||{combo:0,service:0,addedon:0,foxcard:0},n=Math.round(.218*(r.combo+r.service+r.addedon));return{date:"".concat(t.day," thg ").concat(t.month),combo:r.combo,service:r.service,addedon:r.addedon,foxcard:n}})},[W,eI]),eO=n.useMemo(()=>{if(!B)return[];let e=new Map;return B.forEach(t=>{e.has(t.region)||e.set(t.region,{combo:0,service:0,other:0});let a=e.get(t.region);switch(t.type){case"Combo":a.combo=t.total;break;case"Dịch vụ":a.service=t.total;break;case"Kh\xe1c":a.other=t.total}}),Array.from(e.entries()).map(e=>{let[t,a]=e;return{region:t,combo:a.combo,service:a.service,other:a.other,total:a.combo+a.service+a.other}}).sort((e,t)=>t.total-e.total)},[B]),eB=n.useMemo(()=>{if(!W)return[];let e=new Map;W.forEach(t=>{let a=t.type;e.has(a)||e.set(a,{count:0,type:t.type}),e.get(a).count+=t.count});let t=Array.from(e.values()).reduce((e,t)=>e+t.count,0);return Array.from(e.entries()).map(e=>{let[a,r]=e;return{tenDichVu:a,loaiDichVu:a,soLuong:r.count,tongGia:1e6*r.count,percentSoLuong:t>0?(r.count/t*100).toFixed(1):"0.0",percentTongGia:t>0?(r.count/t*100).toFixed(1):"0.0"}})},[W]);eN.some(e=>"Added on"===e.type)||eN.push({date:"".concat(f.day," thg ").concat(f.month),value:1e6,value2:5e5,type:"Added on",status:"New",gender:"Nam",region:"HCM",branch:"Crescent Mall Q7"}),eN.some(e=>"Qu\xe0 tặng"===e.type)||eN.push({date:"".concat(f.day," thg ").concat(f.month),value:8e5,value2:3e5,type:"Qu\xe0 tặng",status:"New",gender:"#N/A",region:"HCM",branch:"Vincom Landmark 81"}),eN.some(e=>"#N/A"===e.gender)||eN.push({date:"".concat(f.day," thg ").concat(f.month),value:12e5,value2:6e5,type:"KH trải nghiệm",status:"New",gender:"#N/A",region:"HCM",branch:"Vista Verde"});let eU=q?Object.entries(q.reduce((e,t)=>(e[t.shopName]||(e[t.shopName]={}),e[t.shopName][t.serviceType]=t.total,e),{})).map(e=>{let[t,a]=e,r=a.Combo||0,n=a["Dịch vụ"]||0,l=a["Kh\xe1c"]||0;return{store:t,combo:r,service:n,other:l,total:r+n+l}}).sort((e,t)=>t.total-e.total):ey.map(e=>{let t=eN.filter(t=>t.branch===e&&eS(t,f,v)&&T.includes(t.type)&&F.includes(t.gender)),a=t.filter(e=>"Kh\xe1ch h\xe0ng Th\xe0nh vi\xean"===e.type).length,r=t.filter(e=>"KH trải nghiệm"===e.type).length,n=t.filter(e=>"Added on"===e.type).length,l=t.filter(e=>"Qu\xe0 tặng"===e.type).length,s=a+r+n+l;return{store:e,combo:a,service:r,addedon:n,gifts:l,foxcard:Math.round(.218*s),total:s}}).sort((e,t)=>t.total-e.total),eX=eb.map(e=>{let t=eN.filter(t=>t.gender===e&&eS(t,f,v)&&T.includes(t.type)).reduce((e,t)=>e+t.value,0);return{gender:e,total:t}}),eq=eN.filter(e=>eS(e,f,v)&&(0===S.length||!e.region||S.includes(e.region))&&(0===j.length||!e.branch||j.includes(e.branch))&&T.includes(e.type)&&F.includes(e.gender)),eZ=n.useMemo(()=>{if(I){let e=[{key:"combo",label:"Combo",value:I.totalCombo,color:"#795548"},{key:"service",label:"Dịch vụ",value:I.totalLe,color:"#c5e1a5"},{key:"addedon",label:"Added on",value:I.totalCT,color:"#f16a3f"},{key:"gifts",label:"Gifts",value:I.totalGift,color:"#8fd1fc"}],t=Math.round(.218*e.reduce((e,t)=>e+t.value,0));return[...e,{key:"foxcard",label:"Fox card",value:t,color:"#b26e7a"}]}let e=[{key:"combo",label:"Combo",value:eq.filter(e=>"Kh\xe1ch h\xe0ng Th\xe0nh vi\xean"===e.type).length,color:"#795548"},{key:"service",label:"Dịch vụ",value:eq.filter(e=>"KH trải nghiệm"===e.type).length,color:"#c5e1a5"},{key:"addedon",label:"Added on",value:eq.filter(e=>"Added on"===e.type).length,color:"#f16a3f"},{key:"gifts",label:"Gifts",value:eq.filter(e=>"Qu\xe0 tặng"===e.type).length,color:"#8fd1fc"}],t=Math.round(.218*e.reduce((e,t)=>e+t.value,0));return[...e,{key:"foxcard",label:"Fox card",value:t,color:"#b26e7a"}]},[I,eq]),eJ=n.useMemo(()=>{if(et)return et.map((e,t)=>({name:e.serviceName,value:e.count,color:"hsl(0,0%,".concat(40+5*t,"%)")}));let e=eN.filter(e=>eS(e,f,v)&&(0===S.length||!e.region||S.includes(e.region))&&(0===j.length||!e.branch||j.includes(e.branch))&&T.includes(e.type)&&F.includes(e.gender)),t=new Map;e.forEach(e=>{let a=e.serviceName||e.type;t.set(a,(t.get(a)||0)+1)});let a=Array.from(t.entries()).sort((e,t)=>t[1]-e[1]),r=a.slice(0,10),n=a.slice(10).reduce((e,t)=>{let[,a]=t;return e+a},0),l=r.map((e,t)=>{let[a,r]=e;return{name:a,value:r,color:"hsl(0,0%,".concat(40+5*t,"%)")}});return n>0&&l.push({name:"Kh\xe1c",value:n,color:"#ededed"}),l},[et,eN,f,v,eS,S,j,T,F]),eY=n.useMemo(()=>{if(Y)return Y.map((e,t)=>({name:e.serviceName,value:e.servicePrice,color:"hsl(30, 100%, ".concat(45+5*t,"%)")}));let e=new Map;eq.forEach(t=>{let a=t.serviceName||t.type;e.has(a)||e.set(a,{totalValue:0,count:0});let r=e.get(a);r.totalValue+=t.value,r.count+=1});let t=Array.from(e.entries()).map(e=>{let[t,{totalValue:a,count:r}]=e;return{name:t,avg:r>0?a/r:0,count:r}}).sort((e,t)=>t.avg-e.avg),a=t.slice(0,10),r=t.slice(10).reduce((e,t)=>e+t.avg,0),n=a.map((e,t)=>({name:e.name,value:e.avg,color:"hsl(30, 100%, ".concat(45+5*t,"%)")}));return t.length>10&&n.push({name:"Kh\xe1c",value:r,color:"#ffe0b2"}),n},[Y,eq]),e$=n.useMemo(()=>{if(en){let e=["#bdbdbd","#9e9e9e","#e0e0e0"];return en.map((t,a)=>({name:t.serviceName,value:t.count,color:e[a%e.length]}))}let e=new Map;eq.forEach(t=>{let a=t.serviceName||t.type;e.set(a,(e.get(a)||0)+1)});let t=Array.from(e.entries()).sort((e,t)=>e[1]-t[1]).slice(0,3),a=["#bdbdbd","#9e9e9e","#e0e0e0"];return t.map((e,t)=>{let[r,n]=e;return{name:r,value:n,color:a[t%a.length]}})},[en,eq]),e0=n.useMemo(()=>{if(eo){let e=["#bdbdbd","#9e9e9e","#e0e0e0"];return eo.map((t,a)=>({name:t.serviceName,value:t.servicePrice,color:e[a%e.length]}))}let e=new Map;eq.forEach(t=>{let a=t.serviceName||t.type;e.has(a)||e.set(a,{totalValue:0,count:0});let r=e.get(a);r.totalValue+=t.value,r.count+=1});let t=Array.from(e.entries()).map(e=>{let[t,{totalValue:a,count:r}]=e;return{name:t,avg:r>0?a/r:0,count:r}}).sort((e,t)=>e.avg-t.avg).slice(0,3),a=["#bdbdbd","#9e9e9e","#e0e0e0"];return t.map((e,t)=>({name:e.name,value:e.avg,color:a[t%a.length]}))},[eo,eq]);return(0,r.jsxs)("div",{className:"p-2 sm:p-4 md:p-6 max-w-full",children:[(0,r.jsx)(E.E,{type:e.type,message:e.message,isVisible:e.isVisible,onClose:i}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("div",{className:"p-2",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Services Report"}),(0,r.jsx)("button",{onClick:()=>{(0,L.e)(["services-startDate","services-endDate","services-selectedBranches","services-selectedRegions","services-selectedServiceTypes","services-selectedGenders"]),b((0,l.Ec)((0,l.Xj)()).subtract({days:7})),y((0,l.Ec)((0,l.Xj)())),w([]),C([]),z(["Kh\xe1ch h\xe0ng Th\xe0nh vi\xean","KH trải nghiệm","Added on","Qu\xe0 tặng"]),P(["Nam","Nữ","#N/A"]),t("Đ\xe3 reset tất cả filter về mặc định!"),x()},className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors text-sm",children:"Reset Filters"})]}),(0,r.jsx)(o,{startDate:f,endDate:v,setStartDate:b,setEndDate:y,today:l.Ec,getLocalTimeZone:l.Xj,selectedRegions:S,setSelectedRegions:C,selectedBranches:j,setSelectedBranches:w,selectedServiceTypes:T,setSelectedServiceTypes:z,selectedGenders:F,setSelectedGenders:P,regionOptions:ez,locationOptions:ey,filteredRegionOptions:eF,ALL_SERVICE_TYPES:ep,ALL_GENDERS:eb,filteredServiceTypes:eH,filteredGenders:eV,genderActualPrice:eX,formatMoneyShort:function(e){return e>=1e12?(e/1e12).toFixed(1)+" T":e>=1e9?(e/1e9).toFixed(1)+" T":e>=1e6?(e/1e6).toFixed(1)+" Tr":e.toLocaleString()}})]}),(0,r.jsx)(p,{weeklyServiceChartData:eG,isMobile:ef}),(0,r.jsx)(N,{pieChartData:eZ,pieTop10Data:eJ,pieTop10AvgData:eY,top10ServicesLoading:$,top10ServicesError:ee,top10ServicesUsageLoading:ea,top10ServicesUsageError:er,isMobile:ef,renderPieLabel:e=>{var t;let{percent:a,x:n,y:l,index:s}=e;return ef&&void 0!==a&&a<0||void 0!==a&&a<.05?null:(0,r.jsxs)("text",{x:n,y:l,fill:(null==(t=eJ[null!=s?s:0])?void 0:t.color)||"#333",fontSize:ef?10:14,fontWeight:"bold",textAnchor:"middle",dominantBaseline:"central",children:[(100*a).toFixed(1),"%"]})}}),(0,r.jsx)(k,{bottom3ServicesUsageData:en,bottom3ServicesUsageLoading:el,bottom3ServicesUsageError:es,bottom3ServicesRevenueLoading:ei,bottom3ServicesRevenueError:ec,bottom3Data:e$,bottom3RevenueData:e0,filteredPieData:eq,isMobile:ef}),(0,r.jsx)(D,{serviceSummary:I,serviceSummaryLoading:G,serviceSummaryError:O}),(0,r.jsx)(_,{shopLoading:Z,shopError:J,isMobile:ef,storeServiceChartData:eU}),(0,r.jsx)(M,{regionLoading:U,regionError:X,isMobile:ef,regionChartData:eO}),(0,r.jsx)(A,{serviceTableData:ed,serviceTableLoading:eu,serviceTableError:eh,serviceData:eB})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[156,939,932,464,262,441,684,358],()=>t(22635)),_N_E=e.O()}]);