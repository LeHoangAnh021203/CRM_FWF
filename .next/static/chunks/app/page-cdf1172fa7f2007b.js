(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8974],{17606:(e,s,a)=>{"use strict";a.d(s,{n:()=>n,o:()=>c});var t=a(12115);class l{subscribe(e){return this.listeners.add(e),()=>this.listeners.delete(e)}emit(){this.listeners.forEach(e=>e())}constructor(){this.listeners=new Set}}let c=new l;function n(e){let s=(0,t.useCallback)(async s=>{try{await fetch("/api/notifications",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({pageName:e,...s})}),c.emit()}catch(e){console.error("Failed to update page status:",e)}},[e]),a=(0,t.useCallback)(a=>{s({dataLoaded:!0,successCount:1,lastSuccess:a||"Trang ".concat(i(e)," đ\xe3 sẵn s\xe0ng sử dụng")})},[s,e]),l=(0,t.useCallback)(e=>{s({errorCount:1,lastError:e})},[s]),n=(0,t.useCallback)(e=>{s({lastSuccess:e})},[s]),d=(0,t.useCallback)((e,a)=>{s({successCount:1,lastSuccess:a?"Dữ liệu ".concat(e,": ").concat(a.toLocaleString()," bản ghi đ\xe3 sẵn s\xe0ng"):"Dữ liệu ".concat(e," đ\xe3 được tải th\xe0nh c\xf4ng")})},[s]),r=(0,t.useCallback)((e,a)=>{s({errorCount:1,lastError:"Kh\xf4ng thể tải dữ liệu ".concat(e,": ").concat(a)})},[s]),o=(0,t.useCallback)(e=>{s({lastSuccess:"Bộ lọc ".concat(e," đ\xe3 được cập nhật")})},[s]),u=(0,t.useCallback)(()=>{s({lastSuccess:"Tất cả bộ lọc đ\xe3 được đặt lại về mặc định"})},[s]),h=(0,t.useCallback)((e,a)=>{s({lastSuccess:"Biểu đồ ".concat(e,": ").concat(a)})},[s]),m=(0,t.useCallback)(a=>{let t="Trang ".concat(i(e)," đ\xe3 tải xong");a.loadTime&&(t+=" (".concat(a.loadTime,"ms)")),a.dataSize&&(t+=" - ".concat(a.dataSize," bản ghi")),s({dataLoaded:!0,successCount:1,lastSuccess:t})},[s,e]);return(0,t.useEffect)(()=>{s({dataLoaded:!1,errorCount:0,successCount:0})},[s]),{reportPageLoad:a,reportPageError:l,reportPageActivity:n,reportDataLoadSuccess:d,reportDataLoadError:r,reportFilterChange:o,reportResetFilters:u,reportChartInteraction:h,reportPagePerformance:m}}function i(e){return({customers:"Kh\xe1ch h\xe0ng",orders:"Đơn h\xe0ng",services:"Dịch vụ",dashboard:"Tổng quan"})[e]||e}},37327:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>g});var t=a(95155),l=a(12115);let c=(0,l.lazy)(()=>Promise.all([a.e(4277),a.e(550)]).then(a.bind(a,30550)).then(e=>({default:e.StatsCards}))),n=(0,l.lazy)(()=>Promise.all([a.e(4277),a.e(8759)]).then(a.bind(a,28759)).then(e=>({default:e.RevenueChart}))),i=(0,l.lazy)(()=>Promise.all([a.e(4277),a.e(4697)]).then(a.bind(a,24697)).then(e=>({default:e.RecentActivity}))),d=(0,l.lazy)(()=>Promise.all([a.e(4277),a.e(1625),a.e(4223)]).then(a.bind(a,34223)).then(e=>({default:e.TasksWidget}))),r=(0,l.lazy)(()=>Promise.all([a.e(4277),a.e(5386)]).then(a.bind(a,75386)).then(e=>({default:e.CustomerInsights}))),o=(0,l.lazy)(()=>Promise.all([a.e(4277),a.e(8573)]).then(a.bind(a,88573)).then(e=>({default:e.QuickActions})));var u=a(37945),h=a(17606),m=a(49049);function g(){let{notification:e,showSuccess:s,showError:a,hideNotification:g}=(0,u.h)(),x=(0,l.useRef)(!1),b=(0,l.useRef)(!1),{reportPageError:p,reportDataLoadSuccess:v,reportPagePerformance:f,reportDataLoadError:j}=(0,h.n)("dashboard"),{loading:y,error:N,apiErrors:w,apiSuccesses:S}=(0,m.e)();return(0,l.useEffect)(()=>{S.length>0&&!x.current&&(s(1===S.length?S[0]:"".concat(S.length," data sources loaded successfully")),x.current=!0,v("dashboard",S.length))},[S,s,v]),(0,l.useEffect)(()=>{if(w.length>0&&!b.current){let e=1===w.length?w[0]:"".concat(w.length," data sources failed to load");a(e),b.current=!0,j("dashboard",e)}},[w,a,j]),(0,l.useEffect)(()=>{N&&!b.current&&(a(N),b.current=!0,p(N))},[N,a,p]),(0,l.useEffect)(()=>{y||f({loadTime:2e3})},[y,f]),(0,t.jsxs)("div",{className:"p-3 sm:p-6",children:[(0,t.jsx)(u.E,{type:e.type,message:e.message,isVisible:e.isVisible,onClose:g}),(0,t.jsxs)("div",{className:"mb-3 sm:mb-6",children:[(0,t.jsx)("h1",{className:"text-lg sm:text-2xl font-semibold text-gray-900 mb-2",children:"Dashboard"}),(0,t.jsxs)("p",{className:"text-gray-600 flex flex-wrap items-center gap-[3px] text-sm sm:text-base",children:["Welcome back! Here's what's happening with"," ",(0,t.jsx)("span",{className:"text-orange-500 flex",children:"Face Wash Fox"})," today."]})]}),(0,t.jsx)(l.Suspense,{fallback:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[(0,t.jsx)("div",{className:"h-6 bg-gray-200 rounded animate-pulse mb-4 w-32"}),(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[void 0,void 0,void 0,void 0].map((e,s)=>(0,t.jsx)("div",{className:"h-20 bg-gray-200 rounded animate-pulse"},s))})]}),children:(0,t.jsx)(o,{})}),(0,t.jsx)(l.Suspense,{fallback:(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[void 0,void 0,void 0,void 0].map((e,s)=>(0,t.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-24"}),(0,t.jsx)("div",{className:"h-8 bg-gray-200 rounded animate-pulse w-20"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-16"}),(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-20"})]})]}),(0,t.jsx)("div",{className:"h-12 w-12 bg-gray-200 rounded-full animate-pulse"})]})},s))}),children:(0,t.jsx)(c,{})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-3 sm:gap-6 mt-6",children:[(0,t.jsx)("div",{className:"lg:col-span-2",children:(0,t.jsx)(l.Suspense,{fallback:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,t.jsx)("div",{className:"h-6 bg-gray-200 rounded animate-pulse mb-4 w-32"}),(0,t.jsx)("div",{className:"h-64 bg-gray-200 rounded animate-pulse"})]}),children:(0,t.jsx)(n,{})})}),(0,t.jsx)(l.Suspense,{fallback:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,t.jsx)("div",{className:"h-6 bg-gray-200 rounded animate-pulse mb-4 w-36"}),(0,t.jsx)("div",{className:"space-y-3",children:[void 0,void 0,void 0,void 0].map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"h-10 w-10 bg-gray-200 rounded-full animate-pulse"}),(0,t.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-24"}),(0,t.jsx)("div",{className:"h-3 bg-gray-200 rounded animate-pulse w-16"})]})]},s))})]}),children:(0,t.jsx)(r,{})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3 sm:gap-6 mt-6",children:[(0,t.jsx)(l.Suspense,{fallback:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,t.jsx)("div",{className:"h-6 bg-gray-200 rounded animate-pulse mb-4 w-24"}),(0,t.jsx)("div",{className:"space-y-3",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"h-4 w-4 bg-gray-200 rounded animate-pulse"}),(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-32"})}),(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-12"})]},s))})]}),children:(0,t.jsx)(d,{})}),(0,t.jsx)(l.Suspense,{fallback:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,t.jsx)("div",{className:"h-6 bg-gray-200 rounded animate-pulse mb-4 w-32"}),(0,t.jsx)("div",{className:"space-y-3",children:[void 0,void 0,void 0,void 0].map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"h-10 w-10 bg-gray-200 rounded-full animate-pulse"}),(0,t.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-28"}),(0,t.jsx)("div",{className:"h-3 bg-gray-200 rounded animate-pulse w-20"})]}),(0,t.jsx)("div",{className:"h-3 bg-gray-200 rounded animate-pulse w-12"})]},s))})]}),children:(0,t.jsx)(i,{})})]})]})}},37945:(e,s,a)=>{"use strict";a.d(s,{E:()=>d,h:()=>r});var t=a(95155),l=a(12115),c=a(40646),n=a(54861),i=a(54416);let d=e=>{let{type:s,message:a,isVisible:d,onClose:r,duration:o=5e3}=e,[u,h]=(0,l.useState)(!1);if((0,l.useEffect)(()=>{if(d){h(!0);let e=setTimeout(()=>{h(!1),setTimeout(r,300)},o);return()=>clearTimeout(e)}},[d,o,r]),!d)return null;let m="success"===s?"text-green-800":"text-red-800",g="success"===s?c.A:n.A;return(0,t.jsx)("div",{className:"fixed top-4 right-4 z-50 max-w-sm w-full transition-all duration-300 ease-in-out ".concat(u?"opacity-100 translate-y-0":"opacity-0 -translate-y-2"),children:(0,t.jsx)("div",{className:"".concat("success"===s?"bg-green-50":"bg-red-50"," border ").concat("success"===s?"border-green-200":"border-red-200"," rounded-lg shadow-lg p-4"),children:(0,t.jsxs)("div",{className:"flex items-start",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)(g,{className:"h-5 w-5 ".concat("success"===s?"text-green-400":"text-red-400")})}),(0,t.jsx)("div",{className:"ml-3 flex-1",children:(0,t.jsx)("p",{className:"text-sm font-medium ".concat(m),children:a})}),(0,t.jsx)("div",{className:"ml-4 flex-shrink-0",children:(0,t.jsx)("button",{onClick:()=>{h(!1),setTimeout(r,300)},className:"inline-flex ".concat(m," hover:").concat(m," focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-").concat("success"===s?"green":"red","-500"),children:(0,t.jsx)(i.A,{className:"h-4 w-4"})})})]})})})},r=()=>{let[e,s]=(0,l.useState)({type:"success",message:"",isVisible:!1});return{notification:e,showSuccess:e=>{s({type:"success",message:e,isVisible:!0})},showError:e=>{s({type:"error",message:e,isVisible:!0})},hideNotification:()=>{s(e=>({...e,isVisible:!1}))}}}},49049:(e,s,a)=>{"use strict";a.d(s,{e:()=>n});var t=a(12115),l=a(68931);let c="https://ed56edc8f406.ngrok-free.app";function n(){let[e,s]=(0,t.useState)(null),[a,n]=(0,t.useState)([]),[i,d]=(0,t.useState)([]),[r,o]=(0,t.useState)([]),[u,h]=(0,t.useState)(!0),[m,g]=(0,t.useState)(null),[x,b]=(0,t.useState)([]),[p,v]=(0,t.useState)([]);return(0,t.useEffect)(()=>{(async()=>{try{h(!0),g(null),b([]),v([]);let e=(0,l.Ec)((0,l.Xj)()),a=e.subtract({days:30}).toString(),t=e.toString(),i=[{name:"Stats",url:"".concat(c,"/api/dashboard/stats"),handler:e=>s(e)},{name:"Revenue",url:"".concat(c,"/api/dashboard/revenue"),handler:e=>n(e)},{name:"Activity",url:"".concat(c,"/api/dashboard/activity"),handler:e=>d(e)},{name:"Insights",url:"".concat(c,"/api/dashboard/insights"),handler:e=>o(e)}],r=(await Promise.allSettled(i.map(async e=>{try{let s=await fetch(e.url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fromDate:a,toDate:t})});if(!s.ok)throw Error("HTTP ".concat(s.status,": ").concat(s.statusText));let l=await s.json();return e.handler(l),v(s=>[...s,"".concat(e.name," data loaded successfully")]),{name:e.name,success:!0,data:l}}catch(a){let s=a instanceof Error?a.message:"Failed to fetch ".concat(e.name," data");throw b(e=>[...e,s]),a}}))).filter(e=>"rejected"===e.status);if(r.length>0){let e=r.map(e=>"rejected"===e.status?e.reason.message:"Unknown error");g("Some data failed to load: ".concat(e.join(", ")))}0===r.length&&g(null)}catch(e){g(e instanceof Error?e.message:"Failed to fetch dashboard data"),console.error("Dashboard data fetch error:",e)}finally{h(!1)}})()},[]),{stats:e,revenueData:a,recentActivity:i,customerInsights:r,loading:u,error:m,apiErrors:x,apiSuccesses:p}}},59752:(e,s,a)=>{Promise.resolve().then(a.bind(a,37327))}},e=>{var s=s=>e(e.s=s);e.O(0,[8262,8441,1684,7358],()=>s(59752)),_N_E=e.O()}]);