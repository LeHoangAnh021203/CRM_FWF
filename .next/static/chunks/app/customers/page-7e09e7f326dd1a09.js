(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5812],{50660:(e,t,a)=>{Promise.resolve().then(a.bind(a,55900))},55900:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>M});var n=a(95155),r=a(12115),s=a(68931),l=a(90560);let i=e=>{let{allHourRanges:t,facilityHourTableData:a,getCellBg:r,isMobile:s,loadingFacilityHour:l,errorFacilityHour:i}=e;return(0,n.jsxs)("div",{className:"w-full bg-white rounded-xl shadow-lg p-4 mt-5",children:[(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mt-5 gap-4",children:[(0,n.jsx)("h2",{className:"text-lg sm:text-xl font-semibold",children:"Thời gian đơn h\xe0ng được tạo"}),(0,n.jsxs)("div",{className:"flex flex-wrap gap-2 text-xs mt-2 sm:mt-0",children:[(0,n.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded bg-[#68B2A0] text-white",children:"Cao điểm (≥50 đơn)"}),(0,n.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded bg-[#CDE0C9]",children:"Bận rộn (≥35 đơn)"}),(0,n.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded bg-[#E0ECDE]",children:"Kh\xe1 bận (≥25 đơn)"}),(0,n.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded bg-[#F0F8F0]",children:"\xcdt bận (≤15 đơn)"})]})]}),l?(0,n.jsx)("div",{children:"Đang tải dữ liệu..."}):i?(0,n.jsx)("div",{className:"text-red-500",children:i}):(0,n.jsx)("div",{className:"overflow-x-auto mt-4 custom-scrollbar",children:(0,n.jsx)("div",{className:"max-h-[420px] overflow-y-auto custom-scrollbar",children:(0,n.jsx)("div",{className:"max-h-[420px] overflow-y-auto",children:(0,n.jsxs)("table",{className:"min-w-[600px] w-full border text-center ".concat(s?"text-xs":""),children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"border px-2 py-1 bg-[#2C6975] text-white text-left font-bold \n        ".concat(s?"text-xs":""," sticky left-0 top-0 z-20"),children:"Cơ sở"}),t.map(e=>(0,n.jsx)("th",{className:"border px-2 py-1 font-bold text-sm bg-[#2C6975] text-white \n          ".concat(s?"text-xs px-1 py-0.5":""," sticky top-0 z-10"),children:e},e)),(0,n.jsx)("th",{className:"border px-2 py-1 bg-[#2C6975] text-white font-bold \n        ".concat(s?"text-xs":""," sticky right-0 top-0 z-20"),children:"Tổng"})]})}),(0,n.jsxs)("tbody",{children:[a.map(e=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"border px-2 py-1 text-left font-semibold ".concat(s?"text-xs px-1 py-0.5":""," sticky left-0 z-10 bg-gray-50"),children:e.facility}),t.map(t=>{var a;let l=Number(null!=(a=e[t])?a:0);return(0,n.jsx)("td",{className:"border px-2 py-1 ".concat(r(l)," ").concat(s?"text-xs px-1 py-0.5":""),children:l},t)}),(0,n.jsx)("td",{className:"border px-2 py-1 font-bold ".concat(s?"text-xs px-1 py-0.5":""," sticky right-0 z-10 bg-gray-100"),children:e.total})]},e.facility)),(0,n.jsxs)("tr",{className:"bg-gray-200 font-bold sticky bottom-0 z-10",children:[(0,n.jsx)("td",{className:"border px-2 py-1 text-left ".concat(s?"text-xs px-1 py-0.5":""," \n      sticky left-0 bottom-0 bg-gray-200 z-20"),children:"TỔNG CỘNG"}),t.map(e=>{let t=a.reduce((t,a)=>{var n;return t+Number(null!=(n=a[e])?n:0)},0);return(0,n.jsx)("td",{className:"border px-2 py-1 ".concat(r(t)," \n          ").concat(s?"text-xs px-1 py-0.5":""," sticky bottom-0 bg-gray-200"),children:t},e)}),(0,n.jsx)("td",{className:"border px-2 py-1 ".concat(s?"text-xs px-1 py-0.5":""," \n      sticky right-0 bottom-0 bg-gray-200"),children:a.reduce((e,t)=>{var a;return e+Number(null!=(a=t.total)?a:0)},0)})]})]})]})})})})]})};var c=a(41088);let o=e=>{var t,a,s,l,i,c;let{mainValue:o,mainLabel:d,mainPercentChange:x,maleValue:h,malePercentChange:m,femaleValue:u,femalePercentChange:g,avgRevenueMale:f,avgServiceMale:p,avgRevenueFemale:j,avgServiceFemale:b,loading:v,error:y}=e,[w,N]=(0,r.useState)(!1),[S,k]=(0,r.useState)(!1),[D,T]=(0,r.useState)(!1);return(0,n.jsxs)("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[(0,n.jsxs)("div",{className:"p-4 lg:p-6 flex flex-col items-center cursor-pointer hover:bg-gray-50 transition-colors mb-5",onClick:()=>N(!w),children:[(0,n.jsx)("div",{className:"text-sm lg:text-xl text-gray-700 mb-2 text-center font-semibold",children:d}),(0,n.jsx)("div",{className:"text-3xl lg:text-5xl font-bold text-[#f66035] mb-2",children:v?(0,n.jsx)("span",{children:"Đang tải dữ liệu..."}):y?(0,n.jsx)("span",{className:"text-red-500",children:y}):(0,n.jsxs)(n.Fragment,{children:[o," ",(0,n.jsx)("span",{className:"text-lg lg:text-2xl",children:"kh\xe1ch"})]})}),void 0!==x&&!v&&!y&&(0,n.jsxs)("div",{className:"text-base lg:text-xl font-semibold ".concat(x>0?"text-green-600":x<0?"text-red-500":"text-gray-500"),children:[x>0?"↑":x<0?"↓":""," ",Math.abs(x).toFixed(2),"%"]}),(0,n.jsx)("div",{className:"mt-2 text-xl text-green-600 transition-transform duration-200",children:w?"⌃":"⌄"})]}),w&&(0,n.jsxs)("div",{className:"flex justify-center items-center border-t border-gray-200",children:[(0,n.jsxs)("div",{className:"w-1/2 p-4 border-r border-gray-100",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center cursor-pointer hover:bg-gray-50 p-2 rounded transition-colors",onClick:()=>k(!S),children:[(0,n.jsxs)("div",{className:"flex gap-2 justify-center items-center",children:[(0,n.jsx)("div",{className:"text-lg font-semibold text-gray-800",children:"Lượt kh\xe1ch nam thực đi"}),(0,n.jsxs)("div",{className:"text-2xl font-bold text-blue-600",children:[null!=(t=null==h?void 0:h.toLocaleString())?t:0," ",(0,n.jsx)("span",{className:"text-sm",children:"kh\xe1ch"})]}),void 0!==m&&(0,n.jsxs)("div",{className:"text-sm font-semibold ".concat(m>0?"text-green-600":m<0?"text-red-500":"text-gray-500"),children:[m>0?"↑":m<0?"↓":""," ",Math.abs(m).toFixed(2),"%"]})]}),(0,n.jsx)("div",{className:"flex items-center justify-center text-lg text-blue-600 transition-transform duration-200",children:S?"⌃":"⌄"})]}),S&&(0,n.jsx)("div",{className:"mt-4 pl-4 border-l-2 border-blue-200",children:(0,n.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg",children:[(0,n.jsx)("div",{className:"text-sm text-gray-600",children:"Trung b\xecnh đơn thực thu nam"}),(0,n.jsxs)("div",{className:"text-lg font-bold text-blue-700",children:[null!=(a=null==f?void 0:f.toLocaleString())?a:0," ",(0,n.jsx)("span",{className:"text-sm",children:"VNĐ"})]})]}),(0,n.jsxs)("div",{className:"bg-green-50 p-3 rounded-lg",children:[(0,n.jsx)("div",{className:"text-sm text-gray-600",children:"Trung b\xecnh đơn dịch vụ nam"}),(0,n.jsxs)("div",{className:"text-lg font-bold text-green-700",children:[null!=(s=null==p?void 0:p.toLocaleString())?s:0," ",(0,n.jsx)("span",{className:"text-sm",children:"VNĐ"})]})]})]})})]}),(0,n.jsxs)("div",{className:"w-1/2 p-4 border-l border-gray-100",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center cursor-pointer hover:bg-gray-50 p-2 rounded transition-colors",onClick:()=>T(!D),children:[(0,n.jsxs)("div",{className:"flex gap-2 justify-center items-center",children:[(0,n.jsx)("div",{className:"text-lg font-semibold text-gray-800",children:"Lượt kh\xe1ch nữ thực đi"}),(0,n.jsxs)("div",{className:"text-2xl font-bold text-pink-600",children:[null!=(l=null==u?void 0:u.toLocaleString())?l:0," ",(0,n.jsx)("span",{className:"text-sm",children:"kh\xe1ch"})]}),void 0!==g&&(0,n.jsxs)("div",{className:"text-sm font-semibold ".concat(g>0?"text-green-600":g<0?"text-red-500":"text-gray-500"),children:[g>0?"↑":g<0?"↓":""," ",Math.abs(g).toFixed(2),"%"]})]}),(0,n.jsx)("div",{className:"flex items-center justify-center text-lg text-pink-600 transition-transform duration-200",children:D?"⌃":"⌄"})]}),D&&(0,n.jsx)("div",{className:"mt-4 pl-4 border-l-2 border-pink-200",children:(0,n.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{className:"bg-pink-50 p-3 rounded-lg",children:[(0,n.jsx)("div",{className:"text-sm text-gray-600",children:"Trung b\xecnh đơn thực thu nữ"}),(0,n.jsxs)("div",{className:"text-lg font-bold text-pink-700",children:[null!=(i=null==j?void 0:j.toLocaleString())?i:0," ",(0,n.jsx)("span",{className:"text-sm",children:"VNĐ"})]})]}),(0,n.jsxs)("div",{className:"bg-purple-50 p-3 rounded-lg",children:[(0,n.jsx)("div",{className:"text-sm text-gray-600",children:"Trung b\xecnh đơn dịch vụ nữ"}),(0,n.jsxs)("div",{className:"text-lg font-bold text-purple-700",children:[null!=(c=null==b?void 0:b.toLocaleString())?c:0," ",(0,n.jsx)("span",{className:"text-sm",children:"VNĐ"})]})]})]})})]})]})]})};var d=a(83540),x=a(93504),h=a(94754),m=a(96025),u=a(52071),g=a(27086),f=a(64683),p=a(42366),j=a(90170),b=a(18357),v=a(54811);let y=e=>{let{isMobile:t,loadingNewCustomer:a,errorNewCustomer:r,newCustomerChartData:s,loadingGenderRatio:l,errorGenderRatio:i,genderRatioData:c,COLORS:o}=e;return(0,n.jsxs)("div",{className:"flex flex-col lg:flex-row w-full gap-4 lg:gap-4",children:[(0,n.jsx)("div",{className:"bg-white rounded-xl shadow p-2 ".concat(t?"w-full flex justify-center items-center mx-auto":"lg:w-1/2"," ").concat(t?"max-w-xs":""),style:{minWidth:t?220:void 0},children:(0,n.jsxs)("div",{className:"w-full",children:[(0,n.jsx)("h2",{className:"text-base lg:text-xl text-center font-semibold text-gray-800 mb-2",children:"Số kh\xe1ch tạo mới"}),a?(0,n.jsx)("div",{children:"Đang tải dữ liệu..."}):r?(0,n.jsx)("div",{className:"text-red-500",children:r}):(0,n.jsx)(d.u,{width:"100%",height:t?220:350,minWidth:220,children:(0,n.jsxs)(x.b,{data:s,margin:{top:t?10:30,right:10,left:10,bottom:t?20:40},children:[(0,n.jsx)(h.d,{stroke:"#e5e7eb",strokeDasharray:"5 5"}),(0,n.jsx)(m.W,{dataKey:"date",stroke:"#6b7280",fontSize:t?10:12,tickLine:!1,axisLine:{stroke:"#d1d5db"},angle:t?-20:0,textAnchor:t?"end":"middle",height:t?40:60,tickFormatter:e=>{if(!e)return"";let t=String(e).match(/^\d{4}-(\d{2})-(\d{2})$/);if(t){let[,e,a]=t;return"".concat(a,"/").concat(e)}return String(e)},tick:e=>{let{x:a,y:r,payload:s}=e,l=s.value,i=(()=>{if(!l)return!1;let e=String(l).match(/^(\d{4})-(\d{2})-(\d{2})$/);if(e){let[,t,a,n]=e,r=new Date(parseInt(t),parseInt(a)-1,parseInt(n)).getDay();return 0===r||6===r}return!1})();return(0,n.jsx)("g",{transform:"translate(".concat(a,",").concat(r,")"),children:(0,n.jsx)("text",{x:0,y:0,dy:16,textAnchor:"middle",fill:i?"#dc2626":"#6b7280",fontSize:t?10:12,fontWeight:i?"bold":"normal",children:s.value?(()=>{let e=String(s.value).match(/^\d{4}-(\d{2})-(\d{2})$/);if(e){let[,t,a]=e;return"".concat(a,"/").concat(t)}return String(s.value)})():""})})}}),(0,n.jsx)(u.h,{stroke:"#6b7280",fontSize:t?10:12,tickLine:!1,axisLine:{stroke:"#d1d5db"},tickFormatter:e=>e>0?"".concat(e," "):e,padding:{bottom:10,top:10}}),(0,n.jsx)(g.m,{}),(0,n.jsx)(f.s,{wrapperStyle:{paddingTop:t?0:"20px",fontSize:t?"10px":"14px",color:"#4b5563",display:t?"none":void 0},iconType:"circle",iconSize:t?8:10}),(0,n.jsx)(p.N,{type:"natural",dataKey:"value",name:"Số kh\xe1ch mới trong hệ thống",stroke:"#5bd1d7",strokeWidth:2,dot:!1,activeDot:{r:6,fill:"#5bd1d7",stroke:"#fff",strokeWidth:2},animationDuration:1500}),(0,n.jsx)(p.N,{type:"natural",dataKey:"value2",name:"Số kh\xe1ch mới trong hệ thống (kỳ trước)",stroke:"#eb94cf",strokeWidth:2,dot:!1,activeDot:{r:6,fill:"#eb94cf",stroke:"#fff",strokeWidth:2},animationDuration:1500})]})})]})}),(0,n.jsxs)("div",{className:"bg-white rounded-xl shadow p-2 ".concat(t?"w-full max-w-xs mx-auto flex flex-col items-center":"lg:w-1/2"),style:{minWidth:t?220:void 0},children:[(0,n.jsx)("h2",{className:"text-base lg:text-xl font-semibold text-gray-800 mb-2 text-center",children:"Tỷ lệ nam/nữ kh\xe1ch mới tạo"}),(0,n.jsx)("div",{className:"w-full flex justify-center",children:l?(0,n.jsx)("div",{children:"Loading..."}):i?(0,n.jsx)("div",{className:"text-red-500",children:i}):(0,n.jsx)(d.u,{width:"100%",height:t?180:350,minWidth:220,children:(0,n.jsxs)(j.r,{children:[(0,n.jsx)(b.F,{data:c,cx:"50%",cy:"50%",innerRadius:"0%",outerRadius:t?"40%":"80%",fill:"#f933347",dataKey:"count",nameKey:"gender",labelLine:!1,label:e=>{let{cx:a=0,cy:r=0,midAngle:s=0,innerRadius:l=0,outerRadius:i=0,percent:c=0,gender:d="",index:x=0}=e,h=Math.PI/180,m=(l+i)/.8,u=a+m*Math.cos(-s*h),g=r+m*Math.sin(-s*h);return(0,n.jsx)("text",{x:u,y:g,fill:o[x%o.length],fontSize:t?12:16,textAnchor:u>a?"start":"end",dominantBaseline:"central",fontWeight:600,children:"".concat(d,": ").concat((100*c).toFixed(1),"%")})},children:c.map((e,t)=>(0,n.jsx)(v.f,{fill:o[t%o.length]},e.gender))}),(0,n.jsx)(g.m,{}),(0,n.jsx)(f.s,{wrapperStyle:{paddingTop:t?0:"20px",fontSize:t?"10px":"14px",color:"#4b5563",display:t?"none":void 0},iconType:"circle",iconSize:t?8:10})]})})})]})]})},w=e=>{var t,a,r,s;let{loadingCustomerSummary:l,errorCustomerSummary:i,customerSummaryRaw:c}=e;return(0,n.jsxs)("div",{className:"flex flex-col md:flex-row gap-2 md:gap-4 mt-4",children:[(0,n.jsxs)("div",{className:"flex-1 bg-white rounded-xl shadow-lg p-6 flex flex-col items-center justify-center",children:[(0,n.jsx)("div",{className:"text-xl font-medium text-gray-700 mb-2 text-center",children:"Tổng số kh\xe1ch mới trong hệ thống"}),(0,n.jsx)("div",{className:"text-5xl font-bold text-black mb-2",children:l?(0,n.jsx)("span",{children:"Đang tải dữ liệu..."}):i?(0,n.jsx)("span",{className:"text-red-500",children:i}):null!=(r=null==c||null==(t=c.totalNewCustomers)?void 0:t.toLocaleString())?r:0}),!l&&!i&&(null==c?void 0:c.growthTotal)!==void 0&&(0,n.jsxs)("div",{className:"flex items-center gap-1 text-sm font-medium ".concat(c.growthTotal>=0?"text-green-600":"text-red-600"),children:[(0,n.jsx)("span",{children:c.growthTotal>=0?"↗":"↘"}),(0,n.jsxs)("span",{children:[Math.abs(c.growthTotal).toFixed(1),"%"]}),(0,n.jsx)("span",{className:"text-gray-500",children:"so với kỳ trước"})]})]}),(0,n.jsxs)("div",{className:"flex-1 bg-white rounded-xl shadow-lg p-6 flex flex-col items-center justify-center",children:[(0,n.jsx)("div",{className:"text-xl font-medium text-gray-700 mb-2 text-center",children:"Tổng số kh\xe1ch mới thực đi"}),(0,n.jsx)("div",{className:"text-5xl font-bold text-black mb-2",children:l?(0,n.jsx)("span",{children:"Đang tải dữ liệu..."}):i?(0,n.jsx)("span",{className:"text-red-500",children:i}):null!=(s=null==c||null==(a=c.actualCustomers)?void 0:a.toLocaleString())?s:0}),!l&&!i&&(null==c?void 0:c.growthActual)!==void 0&&(0,n.jsxs)("div",{className:"flex items-center gap-1 text-sm font-medium ".concat(c.growthActual>=0?"text-green-600":"text-red-600"),children:[(0,n.jsx)("span",{children:c.growthActual>=0?"↗":"↘"}),(0,n.jsxs)("span",{children:[Math.abs(c.growthActual).toFixed(1),"%"]}),(0,n.jsx)("span",{className:"text-gray-500",children:"so với kỳ trước"})]})]})]})},N=e=>{let{isMobile:t,customerTypeTrendData:a,customerTypeKeys:r,COLORS:s}=e;return(0,n.jsxs)("div",{className:"bg-white pt-2 mt-5 rounded-xl shadow-lg ".concat(t?"w-full max-w-xs mx-auto flex flex-col items-center":""),style:{minWidth:t?220:void 0},children:[(0,n.jsx)("h2",{className:"text-base lg:text-xl text-center font-semibold text-gray-800 p-3",children:"Số kh\xe1ch tới chia theo loại"}),(0,n.jsx)("div",{className:"w-full flex justify-center",children:(0,n.jsx)(d.u,{width:"100%",height:t?180:350,minWidth:220,children:(0,n.jsxs)(x.b,{data:a,margin:{top:t?10:30,right:10,left:10,bottom:t?20:40},children:[(0,n.jsx)(h.d,{stroke:"#e5e7eb",strokeDasharray:"5 5"}),(0,n.jsx)(m.W,{dataKey:"date",stroke:"#6b7280",fontSize:t?10:12,tickLine:!1,axisLine:{stroke:"#d1d5db"},angle:t?-20:0,textAnchor:t?"end":"middle",height:t?40:60,tickFormatter:e=>{if(!e)return"";let t=String(e).match(/^\d{4}-(\d{2})-(\d{2})$/);if(t){let[,e,a]=t;return"".concat(a,"/").concat(e)}return String(e)},tick:e=>{let{x:a,y:r,payload:s}=e,l=s.value,i=(()=>{if(!l)return!1;let e=String(l).match(/^(\d{4})-(\d{2})-(\d{2})$/);if(e){let[,t,a,n]=e,r=new Date(parseInt(t),parseInt(a)-1,parseInt(n)).getDay();return 0===r||6===r}return!1})();return(0,n.jsx)("g",{transform:"translate(".concat(a,",").concat(r,")"),children:(0,n.jsx)("text",{x:0,y:0,dy:16,textAnchor:"middle",fill:i?"#dc2626":"#6b7280",fontSize:t?10:12,fontWeight:i?"bold":"normal",children:s.value?(()=>{let e=String(s.value).match(/^\d{4}-(\d{2})-(\d{2})$/);if(e){let[,t,a]=e;return"".concat(a,"/").concat(t)}return String(s.value)})():""})})}}),(0,n.jsx)(u.h,{stroke:"#6b7280",fontSize:t?10:12,tickLine:!1,axisLine:{stroke:"#d1d5db"},tickFormatter:e=>e>0?"".concat(e," kh\xe1ch"):e,padding:{bottom:10,top:10}}),(0,n.jsx)(g.m,{}),(0,n.jsx)(f.s,{wrapperStyle:{paddingTop:t?"":"20px",fontSize:t?"10px":"14px",color:"#4b5563",display:"flex",flexDirection:t?"column":"row",alignItems:"center",justifyContent:"center",flexWrap:t?"nowrap":"wrap",width:"100%",maxHeight:t?80:void 0,overflowY:t?"auto":void 0},iconType:"circle",iconSize:t?8:10,verticalAlign:t?"bottom":void 0}),r.map((e,t)=>(0,n.jsx)(p.N,{type:"natural",dataKey:e,name:e,stroke:s[t%s.length],strokeWidth:2,dot:!1,activeDot:{r:6,fill:s[t%s.length],stroke:"#fff",strokeWidth:2},animationDuration:1500},e))]})})})]})};var S=a(3401),k=a(56690);let D=e=>{let{isMobile:t,customerSourceTrendData:a,customerSourceKeys:r,COLORS:s}=e;return(0,n.jsxs)("div",{className:"w-full bg-white rounded-xl shadow-lg mt-5",children:[(0,n.jsx)("div",{className:"text-xl font-medium text-gray-700 text-center pt-5",children:"Nguồn của đơn h\xe0ng"}),(0,n.jsx)("div",{className:"w-full bg-white rounded-xl shadow-lg",children:(0,n.jsx)(d.u,{width:"100%",height:t?220:350,minWidth:t?180:320,children:(0,n.jsxs)(S.E,{data:a,margin:{top:t?20:50,right:10,left:10,bottom:t?20:40},children:[(0,n.jsx)(h.d,{strokeDasharray:"3 3"}),(0,n.jsx)(m.W,{dataKey:"date",fontSize:t?9:12,tickFormatter:e=>{let t=e.match(/^\d{4}-(\d{2})-(\d{2})$/);if(t){let[,e,a]=t;return"".concat(a,"/").concat(e)}return e},tick:e=>{let{x:a,y:r,payload:s}=e,l=s.value,i=(()=>{if(!l)return!1;let e=String(l).match(/^(\d{4})-(\d{2})-(\d{2})$/);if(e){let[,t,a,n]=e,r=new Date(parseInt(t),parseInt(a)-1,parseInt(n)).getDay();return 0===r||6===r}return!1})();return(0,n.jsx)("g",{transform:"translate(".concat(a,",").concat(r,")"),children:(0,n.jsx)("text",{x:0,y:0,dy:16,textAnchor:"middle",fill:i?"#dc2626":"#6b7280",fontSize:t?9:12,fontWeight:i?"bold":"normal",children:s.value?(()=>{let e=String(s.value).match(/^\d{4}-(\d{2})-(\d{2})$/);if(e){let[,t,a]=e;return"".concat(a,"/").concat(t)}return String(s.value)})():""})})}}),(0,n.jsx)(u.h,{fontSize:t?9:12}),(0,n.jsx)(g.m,{}),(0,n.jsx)(f.s,{wrapperStyle:{paddingTop:5*!t,paddingBottom:10*!t,display:"flex",justifyContent:"center",flexWrap:"wrap",width:"100%",fontSize:t?9:14}}),r.map((e,l)=>(0,n.jsx)(k.y,{dataKey:e,fill:s[l%s.length],name:e,label:t?void 0:e=>{let{x:t,y:i,width:c,value:o,index:d}=e;if("number"!=typeof d||d<0||"number"!=typeof t||"number"!=typeof i||"number"!=typeof c)return(0,n.jsx)("g",{});let x=a[d];return x&&o===Math.max(...r.map(e=>Number(x[e]||0)))&&o>0?(0,n.jsx)("text",{x:t+c/2,y:i-5,textAnchor:"middle",fill:s[l%s.length],fontSize:14,fontWeight:600,children:o}):(0,n.jsx)("g",{})}},e))]})})})]})},T=e=>{let{isMobile:t,loading:a,error:r,sortedAppDownloadStatusData:s}=e;return(0,n.jsxs)("div",{className:"w-full bg-white rounded-xl shadow-lg mt-4 lg:mt-5",children:[(0,n.jsx)("div",{className:"text-lg lg:text-xl font-medium text-gray-700 text-center pt-6 lg:pt-10",children:"Kh\xe1ch tải app/kh\xf4ng tải"}),(0,n.jsx)("div",{className:"flex justify-center items-center py-4 lg:py-8",children:a?(0,n.jsx)("div",{children:"Đang tải dữ liệu..."}):r?(0,n.jsx)("div",{className:"text-red-500",children:r}):(0,n.jsx)(d.u,{width:"100%",height:t?220:300,minWidth:t?180:320,children:(0,n.jsxs)(S.E,{data:s,children:[(0,n.jsx)(h.d,{strokeDasharray:"3 3"}),(0,n.jsx)(m.W,{dataKey:"date",fontSize:t?9:12,tickFormatter:e=>{if(!e)return"";let t=String(e).match(/^(\d{4})-(\d{2})-(\d{2})/);if(t){let[,,e,a]=t;return"".concat(a,"/").concat(e)}let a=String(e).match(/^(\d{2})\/(\d{2})(?:\/\d{4})?$/);return a?"".concat(a[1],"/").concat(a[2]):"string"==typeof e&&e.length>=10?e.slice(8,10)+"/"+e.slice(5,7):e},tick:e=>{let{x:a,y:r,payload:s}=e,l=s.value,i=(()=>{if(!l)return!1;let e=String(l).match(/^(\d{4})-(\d{2})-(\d{2})/);if(e){let[,t,a,n]=e,r=new Date(parseInt(t),parseInt(a)-1,parseInt(n)).getDay();return 0===r||6===r}if(e=String(l).match(/^(\d{2})\/(\d{2})\/(\d{4})$/)){let[,t,a,n]=e,r=new Date(parseInt(n),parseInt(a)-1,parseInt(t)).getDay();return 0===r||6===r}return!1})();return(0,n.jsx)("g",{transform:"translate(".concat(a,",").concat(r,")"),children:(0,n.jsx)("text",{x:0,y:0,dy:16,textAnchor:"middle",fill:i?"#dc2626":"#6b7280",fontSize:t?9:12,fontWeight:i?"bold":"normal",children:s.value?(()=>{let e=String(s.value).match(/^(\d{4})-(\d{2})-(\d{2})/);if(e){let[,,t,a]=e;return"".concat(a,"/").concat(t)}let t=String(s.value).match(/^(\d{2})\/(\d{2})(?:\/\d{4})?$/);return t?"".concat(t[1],"/").concat(t[2]):"string"==typeof s.value&&s.value.length>=10?s.value.slice(8,10)+"/"+s.value.slice(5,7):String(s.value)})():""})})}}),(0,n.jsx)(u.h,{allowDecimals:!1,fontSize:t?9:12}),(0,n.jsx)(g.m,{}),(0,n.jsx)(f.s,{fontSize:t?9:12}),(0,n.jsx)(k.y,{dataKey:"downloaded",fill:"#9ee347",name:"Đ\xe3 tải app",label:t?void 0:{position:"top",fontSize:14,fontWeight:600,fill:"#9ee347"}}),(0,n.jsx)(k.y,{dataKey:"notDownloaded",fill:"#f0bf4c",name:"Chưa tải app",label:t?void 0:{position:"top",fontSize:14,fontWeight:600,fill:"#f0bf4c"}})]})})})]})},C=["#ff7f7f","#b39ddb","#8d6e63","#c5e1a5","#81d4fa","#f0bf4c","#bccefb","#a9b8c3"],E=e=>{let{appDownloadPieData:t,loadingAppDownload:a,errorAppDownload:s}=e,[l,i]=r.useState(!1);return r.useEffect(()=>{let e=()=>{i(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,n.jsxs)("div",{className:"w-full bg-white rounded-xl shadow-lg mt-5 p-2 sm:p-4",children:[(0,n.jsx)("div",{className:"text-sm sm:text-base md:text-xl font-medium text-gray-700 text-center mb-4",children:"Tỷ lệ tải app"}),(0,n.jsx)("div",{className:"w-full flex justify-center ",children:a?(0,n.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,n.jsx)("div",{className:"text-gray-500",children:"Đang tải dữ liệu..."})}):s?(0,n.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,n.jsx)("div",{className:"text-red-500",children:s})}):(0,n.jsx)(d.u,{width:"100%",height:l?250:400,minWidth:280,children:(0,n.jsxs)(j.r,{children:[(0,n.jsx)(b.F,{data:t,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",innerRadius:l?"25%":"30%",outerRadius:l?"50%":"60%",label:e=>{let{percent:t}=e;return t&&t>.05?"".concat((100*t).toFixed(0),"%"):""},labelLine:!1,children:t.map((e,t)=>(0,n.jsx)(v.f,{fill:C[t%C.length]},e.name))}),(0,n.jsx)(g.m,{formatter:e=>[e.toLocaleString(),"Số lượng"],contentStyle:{fontSize:l?12:14,backgroundColor:"rgba(255, 255, 255, 0.95)",border:"1px solid #ccc",borderRadius:"4px",padding:"8px"}}),(0,n.jsx)(f.s,{wrapperStyle:{fontSize:l?10:12,paddingTop:l?10:20,display:"flex",justifyContent:"center",flexWrap:"wrap",width:"100%"},layout:"horizontal",verticalAlign:"bottom",align:"center"})]})})})]})};var z=a(37945),L=a(6044),R=a(17606);let W="https://cec2cc5ee186.ngrok-free.app";function F(e,t,a){let[n,s]=(0,r.useState)(null),[l,i]=(0,r.useState)(!0),[c,o]=(0,r.useState)(null);return(0,r.useEffect)(()=>{i(!0),fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fromDate:t,toDate:a})}).then(e=>{if(!e.ok)throw Error("API error: "+e.status);return e.json()}).then(e=>{s(e),i(!1)}).catch(e=>{o(e.message),i(!1)})},[e,t,a]),{data:n,loading:l,error:c}}function M(){var e,t;let{notification:a,showSuccess:d,showError:x,hideNotification:h}=(0,z.h)(),m=(0,r.useRef)(!1),u=(0,r.useRef)(!1),{reportPageError:g,reportDataLoadSuccess:f,reportFilterChange:p,reportResetFilters:j,reportPagePerformance:b}=(0,R.n)("customers"),[v,S]=(0,L.V)("customer-selectedType",[]),[k,C]=(0,L.V)("customer-selectedStatus",null),[M,A]=(0,r.useState)(!1),[K,I]=(0,r.useState)(!1),[O,B]=(0,L.V)("customer-startDate",(0,s.Ec)((0,s.Xj)()).subtract({days:7})),[V,P]=(0,L.V)("customer-endDate",(0,s.Ec)((0,s.Xj)())),[$,H]=(0,L.V)("customer-selectedRegions",[]),[_,X]=(0,r.useState)(!1),[G,q]=(0,L.V)("customer-selectedBranches",[]),[J,U]=(0,r.useState)(!1),Y=["#5bd1d7","#eb94cf","#f66035","#00d084","#9b51e0","#0693e3","#ff7f7f","#b39ddb","#8d6e63","#c5e1a5","#81d4fa","#fff176","#d81b60"],Z=O?"".concat(O.year,"-").concat(String(O.month).padStart(2,"0"),"-").concat(String(O.day).padStart(2,"0"),"T00:00:00"):"",Q=V?"".concat(V.year,"-").concat(String(V.month).padStart(2,"0"),"-").concat(String(V.day).padStart(2,"0"),"T23:59:59"):"",{data:ee,loading:et,error:ea}=F("".concat(W,"/api/customer-sale/new-customer-lineChart"),Z,Q),{data:en,loading:er,error:es}=F("".concat(W,"/api/customer-sale/gender-ratio"),Z,Q),{data:el}=F("".concat(W,"/api/customer-sale/customer-type-trend"),Z,Q),{data:ei}=F("".concat(W,"/api/customer-sale/customer-source-trend"),Z,Q),{data:ec,loading:eo,error:ed}=F("".concat(W,"/api/customer-sale/app-download-status"),Z,Q),{data:ex,loading:eh,error:em}=F("".concat(W,"/api/customer-sale/app-download-pieChart"),Z,Q),{data:eu,loading:eg,error:ef}=F("".concat(W,"/api/customer-sale/customer-summary"),Z,Q),{data:ep,loading:ej,error:eb}=F("".concat(W,"/api/customer-sale/gender-revenue"),Z,Q),{data:ev}=F("".concat(W,"/api/customer-sale/unique-customers-comparison"),Z,Q),{data:ey,loading:ew,error:eN}=F("".concat(W,"/api/customer-sale/facility-hour-service"),Z,Q);(0,r.useEffect)(()=>{if(ee&&!et&&!ea){var e;let t=Date.now(),a=(null==(e=ee.currentRange)?void 0:e.reduce((e,t)=>e+(t.count||0),0))||0;b({loadTime:Date.now()-t,dataSize:a}),f("kh\xe1ch h\xe0ng mới",a)}},[ee,et,ea,b,f]),(0,r.useEffect)(()=>{ea&&g("Lỗi tải dữ liệu kh\xe1ch h\xe0ng mới: ".concat(ea))},[ea,g]),(0,r.useEffect)(()=>{v.length>0&&p("loại kh\xe1ch h\xe0ng: ".concat(v.join(", ")))},[v,p]),(0,r.useEffect)(()=>{k&&p("trạng th\xe1i: ".concat(k))},[k,p]),(0,r.useEffect)(()=>{$.length>0&&p("khu vực: ".concat($.join(", ")))},[$,p]),(0,r.useEffect)(()=>{G.length>0&&p("chi nh\xe1nh: ".concat(G.join(", ")))},[G,p]);let eS=[ea,es,ed,em,ef,eb,eN],ek=[et,er,eo,eh,eg,ej,ew].some(e=>e),eD=eS.some(e=>e);(0,r.useEffect)(()=>{ek||eD||!eu||m.current||(d("Dữ liệu kh\xe1ch h\xe0ng đ\xe3 được tải th\xe0nh c\xf4ng!"),m.current=!0)},[ek,eD,eu,d]),(0,r.useEffect)(()=>{eD&&!u.current&&(x("Kh\xf4ng thể kết nối đến API. Vui l\xf2ng thử lại sau."),u.current=!0)},[eD,x]);let eT=r.useMemo(()=>{if(!ee)return[];let e=Array.isArray(ee.currentRange)?ee.currentRange:[],t=Array.isArray(ee.previousRange)?ee.previousRange:[];return e.map((e,a)=>{var n,r;return{date:e.date||"",value:e.count,value2:null!=(r=null==(n=t[a])?void 0:n.count)?r:0}})},[ee]),eC=r.useMemo(()=>en?[{gender:"Nam",count:en.male||0},{gender:"Nữ",count:en.female||0}]:[],[en]),eE=r.useMemo(()=>{if(!el)return[];let e=new Set;Object.values(el).forEach(t=>{t.forEach(t=>{e.add(t.date.slice(0,10))})});let t=Array.from(e).sort(),a=Object.keys(el);return t.map(e=>{let t={date:String(e)};return a.forEach(a=>{let n=el[a].find(t=>t.date.slice(0,10)===e);t[a]=n?n.count:0}),t})},[el]),ez=r.useMemo(()=>{if(!ei)return[];let e=new Set;Object.values(ei).forEach(t=>{t.forEach(t=>{e.add(t.date.slice(0,10))})});let t=Array.from(e).sort(),a=Object.keys(ei);return t.map(e=>{let t={date:String(e)};return a.forEach(a=>{let n=ei[a].find(t=>t.date.slice(0,10)===e);t[a]=n?n.count:0}),t})},[ei]),eL=r.useMemo(()=>ec?Object.values(ec).flat():[],[ec]),eR=r.useMemo(()=>ex?[{name:"Đ\xe3 tải app",value:ex.totalNew||0},{name:"Chưa tải app",value:ex.totalOld||0}]:[],[ex]),eW=640>function(){let[e,t]=(0,r.useState)(1024);return(0,r.useEffect)(()=>{function e(){t(window.innerWidth)}return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),e}(),eF=r.useMemo(()=>{if(!ey)return[];let e=new Set;return ey.forEach(t=>{Object.keys(t.hourlyCounts).forEach(t=>e.add(t))}),Array.from(e).sort((e,t)=>{let a=e=>parseInt(e.split("-")[0],10);return a(e)-a(t)})},[ey]),eM=r.useMemo(()=>ey?ey.map(e=>({facility:e.facility,...e.hourlyCounts,total:e.total})).sort((e,t)=>t.total-e.total):[],[ey]),eA=eE.length>0?Object.keys(eE[0]).filter(e=>"date"!==e):[],eK=r.useMemo(()=>0===ez.length?[]:Object.keys(ez[0]).filter(e=>"date"!==e),[ez]),eI=r.useMemo(()=>eL?[...eL].sort((e,t)=>{let a=e=>{if(!e.date)return 0;let t=String(e.date).match(/^(\d{4})-(\d{2})-(\d{2})/);if(t)return new Date("".concat(t[1],"-").concat(t[2],"-").concat(t[3])).getTime();let a=String(e.date).match(/^(\d{2})\/(\d{2})\/(\d{4})$/);return a?new Date("".concat(a[3],"-").concat(a[2],"-").concat(a[1])).getTime():new Date(e.date).getTime()};return a(e)-a(t)}):[],[eL]);return(0,n.jsxs)("div",{className:"p-2 sm:p-4 md:p-6 max-w-full",children:[(0,n.jsx)(z.E,{type:a.type,message:a.message,isVisible:a.isVisible,onClose:h}),(0,n.jsx)("div",{className:"mb-6",children:(0,n.jsxs)("div",{className:"p-2",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,n.jsx)("h1",{className:"text-xl lg:text-2xl font-semibold text-gray-900",children:"Customer Report"}),(0,n.jsx)("button",{onClick:()=>{(0,L.e)(["customer-selectedType","customer-selectedStatus","customer-startDate","customer-endDate","customer-selectedRegions","customer-selectedBranches"]),S([]),C(null),B((0,s.Ec)((0,s.Xj)()).subtract({days:7})),P((0,s.Ec)((0,s.Xj)())),H([]),q([]),d("Đ\xe3 reset tất cả filter về mặc định!"),j()},className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors text-sm",children:"Reset Filters"})]}),(0,n.jsx)(c.A,{startDate:O,endDate:V,setStartDate:B,setEndDate:P,today:s.Ec,getLocalTimeZone:s.Xj,parseDate:l._U,selectedType:v,setSelectedType:S,showTypeDropdown:M,setShowTypeDropdown:A,customerTypes:["KH trải nghiệm","Kh\xe1ch h\xe0ng Th\xe0nh vi\xean","Kh\xe1ch h\xe0ng Bạc","Kh\xe1ch h\xe0ng V\xe0ng","Kh\xe1ch h\xe0ng Bạch Kim","Kh\xe1ch h\xe0ng Kim cương"],selectedStatus:k,setSelectedStatus:C,showStatusDropdown:K,setShowStatusDropdown:I,customerStatus:["New","Old"],selectedRegions:$,setSelectedRegions:H,showRegionDropdown:_,setShowRegionDropdown:X,allRegions:["Đ\xe3 đ\xf3ng cửa","Đ\xe0 Nẵng","Nha Trang","H\xe0 Nội","HCM"],selectedBranches:G,setSelectedBranches:q,showBranchDropdown:J,setShowBranchDropdown:U,allBranches:["Branch 1","Branch 2","Branch 3"]}),(0,n.jsx)(o,{mainValue:null!=(t=null==ev||null==(e=ev.currentTotal)?void 0:e.toLocaleString())?t:0,mainLabel:"Tổng số lượt kh\xe1ch sử dụng dịch vụ trong khoảng ng\xe0y đ\xe3 chọn",mainPercentChange:null==ev?void 0:ev.changePercentTotal,maleValue:null==ev?void 0:ev.currentMale,malePercentChange:null==ev?void 0:ev.changePercentMale,femaleValue:null==ev?void 0:ev.currentFemale,femalePercentChange:null==ev?void 0:ev.changePercentFemale,avgRevenueMale:null==ep?void 0:ep.avgRevenueMale,avgServiceMale:null==ep?void 0:ep.avgServiceMale,avgRevenueFemale:null==ep?void 0:ep.avgRevenueFemale,avgServiceFemale:null==ep?void 0:ep.avgServiceFemale}),(0,n.jsx)("div",{className:"mt-5 ",children:(0,n.jsx)(y,{isMobile:eW,loadingNewCustomer:et,errorNewCustomer:ea,newCustomerChartData:eT,loadingGenderRatio:er,errorGenderRatio:es,genderRatioData:eC,COLORS:Y})}),(0,n.jsx)(w,{loadingCustomerSummary:eg,errorCustomerSummary:ef,customerSummaryRaw:eu}),(0,n.jsx)(N,{isMobile:eW,customerTypeTrendData:eE,customerTypeKeys:eA,COLORS:Y}),(0,n.jsx)(D,{isMobile:eW,customerSourceTrendData:ez,customerSourceKeys:eK,COLORS:Y}),(0,n.jsx)(E,{loadingAppDownload:eh,errorAppDownload:em,appDownloadPieData:eR}),(0,n.jsx)(T,{isMobile:eW,loading:eo,error:ed,sortedAppDownloadStatusData:eI}),(0,n.jsx)(i,{allHourRanges:eF,facilityHourTableData:eM,getCellBg:function(e){return 0===e?"":e>=50?"bg-[#68B2A0]":e>=35?"bg-[#CDE0C9]":e>=25?"bg-[#E0ECDE]":e<=15?"bg-[#F0F8F0]":""},isMobile:eW,loadingFacilityHour:ew,errorFacilityHour:eN})]})})]})}},93504:(e,t,a)=>{"use strict";a.d(t,{b:()=>i});var n=a(12115),r=a(46641),s=a(82396),l=["axis"],i=(0,n.forwardRef)((e,t)=>n.createElement(s.P,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:l,tooltipPayloadSearcher:r.uN,categoricalChartProps:e,ref:t}))}},e=>{var t=t=>e(e.s=t);e.O(0,[5156,6939,1932,8262,5464,2366,1862,8441,1684,7358],()=>t(50660)),_N_E=e.O()}]);