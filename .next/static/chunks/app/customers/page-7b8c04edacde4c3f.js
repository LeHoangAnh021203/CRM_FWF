(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[812],{6044:(e,t,a)=>{"use strict";a.d(t,{V:()=>r,e:()=>s});var n=a(12115),l=a(90560);function r(e,t){let[a,r]=(0,n.useState)(()=>{try{let t=window.localStorage.getItem(e);if(t){let a=JSON.parse(t);if(e.includes("Date")&&a.year&&a.month&&a.day)return(0,l._U)("".concat(a.year,"-").concat(String(a.month).padStart(2,"0"),"-").concat(String(a.day).padStart(2,"0")));return a}}catch(t){console.warn('Error reading localStorage key "'.concat(e,'":'),t)}return t});return[a,t=>{try{let n="function"==typeof t?t(a):t;r(n),e.includes("Date")&&"object"==typeof n&&null!==n&&"year"in n?window.localStorage.setItem(e,JSON.stringify({year:n.year,month:n.month,day:n.day})):window.localStorage.setItem(e,JSON.stringify(n))}catch(t){console.warn('Error setting localStorage key "'.concat(e,'":'),t)}}]}function s(e){e.forEach(e=>window.localStorage.removeItem(e))}},17606:(e,t,a)=>{"use strict";a.d(t,{n:()=>s,o:()=>r});var n=a(12115);class l{subscribe(e){return this.listeners.add(e),()=>this.listeners.delete(e)}emit(){this.listeners.forEach(e=>e())}constructor(){this.listeners=new Set}}let r=new l;function s(e){let t=(0,n.useCallback)(async t=>{try{await fetch("/api/notifications",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({pageName:e,...t})}),r.emit()}catch(e){console.error("Failed to update page status:",e)}},[e]),a=(0,n.useCallback)(a=>{t({dataLoaded:!0,successCount:1,lastSuccess:a||"Trang ".concat(c(e)," đ\xe3 sẵn s\xe0ng sử dụng")})},[t,e]),l=(0,n.useCallback)(e=>{t({errorCount:1,lastError:e})},[t]),s=(0,n.useCallback)(e=>{t({lastSuccess:e})},[t]),i=(0,n.useCallback)((e,a)=>{t({successCount:1,lastSuccess:a?"Dữ liệu ".concat(e,": ").concat(a.toLocaleString()," bản ghi đ\xe3 sẵn s\xe0ng"):"Dữ liệu ".concat(e," đ\xe3 được tải th\xe0nh c\xf4ng")})},[t]),o=(0,n.useCallback)((e,a)=>{t({errorCount:1,lastError:"Kh\xf4ng thể tải dữ liệu ".concat(e,": ").concat(a)})},[t]),d=(0,n.useCallback)(e=>{t({lastSuccess:"Bộ lọc ".concat(e," đ\xe3 được cập nhật")})},[t]),h=(0,n.useCallback)(()=>{t({lastSuccess:"Tất cả bộ lọc đ\xe3 được đặt lại về mặc định"})},[t]),u=(0,n.useCallback)((e,a)=>{t({lastSuccess:"Biểu đồ ".concat(e,": ").concat(a)})},[t]),x=(0,n.useCallback)(a=>{let n="Trang ".concat(c(e)," đ\xe3 tải xong");a.loadTime&&(n+=" (".concat(a.loadTime,"ms)")),a.dataSize&&(n+=" - ".concat(a.dataSize," bản ghi")),t({dataLoaded:!0,successCount:1,lastSuccess:n})},[t,e]);return(0,n.useEffect)(()=>{t({dataLoaded:!1,errorCount:0,successCount:0})},[t]),{reportPageLoad:a,reportPageError:l,reportPageActivity:s,reportDataLoadSuccess:i,reportDataLoadError:o,reportFilterChange:d,reportResetFilters:h,reportChartInteraction:u,reportPagePerformance:x}}function c(e){return({customers:"Kh\xe1ch h\xe0ng",orders:"Đơn h\xe0ng",services:"Dịch vụ",dashboard:"Tổng quan"})[e]||e}},24660:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>O});var n=a(95155),l=a(12115),r=a(68931),s=a(90560);let c=e=>{let{allHourRanges:t,facilityHourTableData:a,getCellBg:l,isMobile:r,loadingFacilityHour:s,errorFacilityHour:c}=e;return(0,n.jsxs)("div",{className:"w-full bg-white rounded-xl shadow-lg p-4 mt-5",children:[(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mt-5 gap-4",children:[(0,n.jsx)("h2",{className:"text-lg sm:text-xl font-semibold",children:"Thời gian đơn h\xe0ng được tạo"}),(0,n.jsxs)("div",{className:"flex flex-wrap gap-2 text-xs mt-2 sm:mt-0",children:[(0,n.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded bg-[#68B2A0] text-white",children:"Cao điểm (≥90%)"}),(0,n.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded bg-[#CDE0C9]",children:"Bận rộn (≥70%)"}),(0,n.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded bg-[#E0ECDE]",children:"Kh\xe1 bận (≥50%)"}),(0,n.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded bg-[#F0F8F0]",children:"\xcdt bận (≥30%)"}),(0,n.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded bg-[#F8FCF8]",children:"Thưa thớt (≥10%)"})]})]}),s?(0,n.jsx)("div",{children:"Đang tải dữ liệu..."}):c?(0,n.jsx)("div",{className:"text-red-500",children:c}):(0,n.jsx)("div",{className:"overflow-x-auto mt-4 custom-scrollbar",children:(0,n.jsx)("div",{className:"max-h-[320px] overflow-y-auto custom-scrollbar",children:(0,n.jsx)("div",{className:"max-h-[320px] overflow-y-auto",children:(0,n.jsxs)("table",{className:"min-w-[600px] w-full border text-center ".concat(r?"text-xs":""),children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"border px-2 py-1 bg-[#2C6975] text-white text-left font-bold ".concat(r?"text-xs":""," sticky left-0 z-10"),children:"Cơ sở"}),t.map(e=>(0,n.jsx)("th",{className:"border px-2 py-1 font-bold text-sm bg-[#2C6975] text-white ".concat(r?"text-xs px-1 py-0.5":""),children:e},e)),(0,n.jsx)("th",{className:"border px-2 py-1 bg-[#2C6975] text-white font-bold ".concat(r?"text-xs":""," sticky right-0 z-10"),children:"Tổng"})]})}),(0,n.jsx)("tbody",{children:a.map(e=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"border px-2 py-1 text-left font-semibold ".concat(r?"text-xs px-1 py-0.5":""," sticky left-0 z-10 bg-gray-50"),children:e.facility}),t.map(t=>{var a;let s=Number(null!=(a=e[t])?a:0);return(0,n.jsx)("td",{className:"border px-2 py-1 ".concat(l(s,t)," ").concat(r?"text-xs px-1 py-0.5":""),children:s},t)}),(0,n.jsx)("td",{className:"border px-2 py-1 font-bold ".concat(r?"text-xs px-1 py-0.5":""," sticky right-0 z-10 bg-gray-100"),children:e.total})]},e.facility))})]})})})})]})},i=e=>{let{startDate:t,endDate:a,setStartDate:l,setEndDate:r,today:s,getLocalTimeZone:c,parseDate:i,selectedType:o,setSelectedType:d,showTypeDropdown:h,setShowTypeDropdown:u,customerTypes:x,selectedStatus:m,setSelectedStatus:g,showStatusDropdown:f,setShowStatusDropdown:p,customerStatus:b,selectedRegions:j,setSelectedRegions:y,showRegionDropdown:v,setShowRegionDropdown:w,allRegions:N,selectedBranches:S,setSelectedBranches:k,showBranchDropdown:C,setShowBranchDropdown:T,allBranches:E}=e;return(0,n.jsxs)("div",{className:"flex flex-col gap-4 lg:gap-6 mb-4 lg:mb-6",children:[(0,n.jsxs)("div",{className:"w-full flex flex-col sm:flex-row gap-4 bg-white p-4 rounded-lg shadow",children:[(0,n.jsxs)("div",{className:"flex-1 flex flex-col gap-1",children:[(0,n.jsx)("h3",{className:"text-sm font-medium text-gray-700",children:"Start date"}),(0,n.jsx)("input",{type:"date",className:"border border-gray-300 rounded p-2 bg-white focus:outline-none focus:ring-2 focus:ring-[#f66035]",value:t.toString(),onChange:e=>{l(i(e.target.value))},max:s(c()).toString()})]}),(0,n.jsxs)("div",{className:"flex-1 flex flex-col gap-1",children:[(0,n.jsx)("h3",{className:"text-sm font-medium text-gray-700",children:"End date"}),(0,n.jsx)("input",{type:"date",className:"border border-gray-300 rounded p-2 bg-white focus:outline-none focus:ring-2 focus:ring-[#f66035]",value:a.toString(),onChange:e=>{r(i(e.target.value))},min:t?t.add({days:1}).toString():void 0,max:s(c()).toString()})]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsxs)("button",{className:"block border rounded p-2 w-full text-left bg-white shadow border-[orange] hover:bg-gray-50 transition-colors",onClick:()=>u(!h),type:"button",children:[(0,n.jsx)("span",{className:"font-semibold",children:"Loại kh\xe1ch"}),o.length>0&&(0,n.jsxs)("span",{children:[" (",o.length,")"]}),(0,n.jsx)("span",{className:"float-right",children:"▼"})]}),h&&(0,n.jsxs)("div",{className:"absolute z-20 bg-white border rounded shadow w-full mt-1 max-h-60 overflow-auto",children:[(0,n.jsxs)("label",{className:"flex items-center px-3 py-2 cursor-pointer hover:bg-gray-100",children:[(0,n.jsx)("input",{type:"checkbox",checked:0===o.length,onChange:()=>d([]),className:"mr-2"}),"Tất cả"]}),x.map(e=>(0,n.jsxs)("label",{className:"flex items-center px-3 py-2 cursor-pointer hover:bg-gray-100",children:[(0,n.jsx)("input",{type:"checkbox",checked:o.includes(e),onChange:()=>{o.includes(e)?d(o.filter(t=>t!==e)):d([...o,e])},className:"mr-2"}),e]},e)),(0,n.jsx)("button",{className:"w-full text-center py-2 text-orange-600 hover:underline",onClick:()=>u(!1),type:"button",children:"Đ\xf3ng"})]})]}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsxs)("button",{className:"block border rounded p-2 w-full text-left bg-white shadow border-[orange] hover:bg-gray-50 transition-colors",onClick:()=>p(!f),type:"button",children:[(0,n.jsx)("span",{className:"font-semibold",children:"Kh\xe1ch mới/cũ"}),m&&(0,n.jsxs)("span",{children:[": ",m]}),(0,n.jsx)("span",{className:"float-right",children:"▼"})]}),f&&(0,n.jsxs)("div",{className:"absolute z-20 bg-white border rounded shadow w-full mt-1 max-h-60 overflow-auto",children:[(0,n.jsxs)("label",{className:"flex items-center px-3 py-2 cursor-pointer hover:bg-gray-100",children:[(0,n.jsx)("input",{type:"radio",name:"customerStatus",checked:!m,onChange:()=>g(null),className:"mr-2"}),"Tất cả"]}),b.map(e=>(0,n.jsxs)("label",{className:"flex items-center px-3 py-2 cursor-pointer hover:bg-gray-100",children:[(0,n.jsx)("input",{type:"radio",name:"customerStatus",checked:m===e,onChange:()=>g(e),className:"mr-2"}),e]},e)),(0,n.jsx)("button",{className:"w-full text-center py-2 text-orange-600 hover:underline",onClick:()=>p(!1),type:"button",children:"Đ\xf3ng"})]})]}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsxs)("button",{className:"block border rounded p-2 w-full text-left bg-white shadow border-[orange] hover:bg-gray-50 transition-colors",onClick:()=>w(!v),type:"button",children:[(0,n.jsx)("span",{className:"font-semibold",children:"Region"}),j.length>0&&(0,n.jsxs)("span",{children:[" (",j.length,")"]}),(0,n.jsx)("span",{className:"float-right",children:"▼"})]}),v&&(0,n.jsxs)("div",{className:"absolute z-20 bg-white border rounded shadow w-full mt-1 max-h-60 overflow-auto",children:[(0,n.jsxs)("label",{className:"flex items-center px-3 py-2 cursor-pointer hover:bg-gray-100",children:[(0,n.jsx)("input",{type:"checkbox",checked:0===j.length,onChange:()=>y([]),className:"mr-2"}),"Tất cả"]}),N.map(e=>(0,n.jsxs)("label",{className:"flex items-center px-3 py-2 cursor-pointer hover:bg-gray-100",children:[(0,n.jsx)("input",{type:"checkbox",checked:j.includes(e),onChange:()=>{j.includes(e)?y(j.filter(t=>t!==e)):y([...j,e])},className:"mr-2"}),e]},e)),(0,n.jsx)("button",{className:"w-full text-center py-2 text-orange-600 hover:underline",onClick:()=>w(!1),type:"button",children:"Đ\xf3ng"})]})]}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsxs)("button",{className:"block border rounded p-2 w-full text-left bg-white shadow border-[orange]",onClick:()=>T(!C),type:"button",children:[(0,n.jsx)("span",{className:"font-semibold",children:"Branch"}),S.length>0&&(0,n.jsxs)("span",{children:[" (",S.length,")"]}),(0,n.jsx)("span",{className:"float-right",children:"▼"})]}),C&&(0,n.jsxs)("div",{className:"absolute z-20 bg-white border rounded shadow w-64 mt-1 max-h-60 overflow-auto",children:[(0,n.jsxs)("label",{className:"flex items-center px-3 py-2 cursor-pointer hover:bg-gray-100",children:[(0,n.jsx)("input",{type:"checkbox",checked:0===S.length,onChange:()=>k([]),className:"mr-2"}),"Tất cả"]}),E.map(e=>(0,n.jsxs)("label",{className:"flex items-center px-3 py-2 cursor-pointer hover:bg-gray-100",children:[(0,n.jsx)("input",{type:"checkbox",checked:S.includes(e),onChange:()=>{S.includes(e)?k(S.filter(t=>t!==e)):k([...S,e])},className:"mr-2"}),e]},e)),(0,n.jsx)("button",{className:"w-full text-center py-2 text-orange-600 hover:underline",onClick:()=>T(!1),type:"button",children:"Đ\xf3ng"})]})]})]})]})},o=e=>{let{value:t,label:a,percentChange:l,loading:r,error:s}=e;return(0,n.jsxs)("div",{className:"bg-white rounded-xl shadow p-4 lg:p-6 flex flex-col items-center col-span-1 lg:col-span-4",children:[(0,n.jsx)("div",{className:"text-sm lg:text-xl text-gray-700 mb-2 text-center font-semibold",children:a}),(0,n.jsx)("div",{className:"text-3xl lg:text-5xl font-bold text-[#f66035] mb-2",children:r?(0,n.jsx)("span",{children:"Đang tải dữ liệu..."}):s?(0,n.jsx)("span",{className:"text-red-500",children:s}):(0,n.jsxs)(n.Fragment,{children:[t," ",(0,n.jsx)("span",{className:"text-lg lg:text-2xl",children:"kh\xe1ch"})]})}),void 0!==l&&!r&&!s&&(0,n.jsxs)("div",{className:"text-base lg:text-xl font-semibold ".concat(l>0?"text-green-600":l<0?"text-red-500":"text-gray-500"),children:[l>0?"↑":l<0?"↓":""," ",Math.abs(l).toFixed(2),"%"]})]})},d=e=>{let{value:t,label:a,color:l,loading:r,error:s,unit:c="đ"}=e;return(0,n.jsxs)("div",{className:"bg-white rounded-xl shadow p-4 lg:p-6 flex flex-col items-center",children:[(0,n.jsx)("div",{className:"text-sm lg:text-xl text-gray-700 mb-2 text-center",children:a}),(0,n.jsx)("div",{className:"text-2xl font-bold ".concat(l," mb-2"),children:r?(0,n.jsx)("span",{children:"Đang tải..."}):s?(0,n.jsx)("span",{className:"text-red-500",children:s}):(0,n.jsxs)(n.Fragment,{children:[null!=t?t:0,(0,n.jsx)("span",{className:"text-lg lg:text-2xl",children:c})]})})]})},h=e=>{let{loading:t,error:a,avgRevenueMale:l,avgRevenueFemale:r,avgServiceMale:s,avgServiceFemale:c}=e;return(0,n.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 lg:gap-6 mb-4 lg:mb-6 mt-5",children:[(0,n.jsx)(d,{value:l,label:"Trung b\xecnh đơn thực thu (Nam)",color:"text-[#f66035]",loading:t,error:a}),(0,n.jsx)(d,{value:r,label:"Trung b\xecnh đơn thực thu (Nữ)",color:"text-[#0693e3]",loading:t,error:a}),(0,n.jsx)(d,{value:s,label:"Trung b\xecnh đơn dịch vụ (Nam)",color:"text-[#00d082]",loading:t,error:a}),(0,n.jsx)(d,{value:c,label:"Trung b\xecnh đơn dịch vụ (Nữ)",color:"text-[#9b51e0]",loading:t,error:a})]})};var u=a(83540),x=a(93504),m=a(94754),g=a(96025),f=a(52071),p=a(27086),b=a(64683),j=a(42366),y=a(90170),v=a(18357),w=a(54811);let N=e=>{let{isMobile:t,loadingNewCustomer:a,errorNewCustomer:l,newCustomerChartData:r,loadingGenderRatio:s,errorGenderRatio:c,genderRatioData:i,COLORS:o}=e;return(0,n.jsxs)("div",{className:"flex flex-col lg:flex-row w-full gap-4 lg:gap-4",children:[(0,n.jsx)("div",{className:"bg-white rounded-xl shadow p-2 ".concat(t?"w-full flex justify-center items-center mx-auto":"lg:w-1/2"," ").concat(t?"max-w-xs":""),style:{minWidth:t?220:void 0},children:(0,n.jsxs)("div",{className:"w-full",children:[(0,n.jsx)("h2",{className:"text-base lg:text-xl text-center font-semibold text-gray-800 mb-2",children:"Số kh\xe1ch tạo mới"}),a?(0,n.jsx)("div",{children:"Đang tải dữ liệu..."}):l?(0,n.jsx)("div",{className:"text-red-500",children:l}):(0,n.jsx)(u.u,{width:"100%",height:t?220:350,minWidth:220,children:(0,n.jsxs)(x.b,{data:r,margin:{top:t?10:30,right:10,left:10,bottom:t?20:40},children:[(0,n.jsx)(m.d,{stroke:"#e5e7eb",strokeDasharray:"5 5"}),(0,n.jsx)(g.W,{dataKey:"date",stroke:"#6b7280",fontSize:t?10:12,tickLine:!1,axisLine:{stroke:"#d1d5db"},angle:t?-20:0,textAnchor:t?"end":"middle",height:t?40:60,tickFormatter:e=>{if(!e)return"";let t=String(e).match(/^\d{4}-(\d{2})-(\d{2})$/);if(t){let[,e,a]=t;return"".concat(a,"/").concat(e)}return String(e)}}),(0,n.jsx)(f.h,{stroke:"#6b7280",fontSize:t?10:12,tickLine:!1,axisLine:{stroke:"#d1d5db"},tickFormatter:e=>e>0?"".concat(e," "):e,padding:{bottom:10,top:10}}),(0,n.jsx)(p.m,{}),(0,n.jsx)(b.s,{wrapperStyle:{paddingTop:t?0:"20px",fontSize:t?"10px":"14px",color:"#4b5563",display:t?"none":void 0},iconType:"circle",iconSize:t?8:10}),(0,n.jsx)(j.N,{type:"natural",dataKey:"value",name:"Số kh\xe1ch mới trong hệ thống",stroke:"#5bd1d7",strokeWidth:2,dot:!1,activeDot:{r:6,fill:"#5bd1d7",stroke:"#fff",strokeWidth:2},animationDuration:1500}),(0,n.jsx)(j.N,{type:"natural",dataKey:"value2",name:"Số kh\xe1ch mới trong hệ thống (kỳ trước)",stroke:"#eb94cf",strokeWidth:2,dot:!1,activeDot:{r:6,fill:"#eb94cf",stroke:"#fff",strokeWidth:2},animationDuration:1500})]})})]})}),(0,n.jsxs)("div",{className:"bg-white rounded-xl shadow p-2 ".concat(t?"w-full max-w-xs mx-auto flex flex-col items-center":"lg:w-1/2"),style:{minWidth:t?220:void 0},children:[(0,n.jsx)("h2",{className:"text-base lg:text-xl font-semibold text-gray-800 mb-2 text-center",children:"Tỷ lệ nam/nữ kh\xe1ch mới tạo"}),(0,n.jsx)("div",{className:"w-full flex justify-center",children:s?(0,n.jsx)("div",{children:"Loading..."}):c?(0,n.jsx)("div",{className:"text-red-500",children:c}):(0,n.jsx)(u.u,{width:"100%",height:t?180:350,minWidth:220,children:(0,n.jsxs)(y.r,{children:[(0,n.jsx)(v.F,{data:i,cx:"50%",cy:"50%",innerRadius:"0%",outerRadius:t?"40%":"80%",fill:"#f933347",dataKey:"count",nameKey:"gender",labelLine:!1,label:e=>{let{cx:a=0,cy:l=0,midAngle:r=0,innerRadius:s=0,outerRadius:c=0,percent:i=0,gender:d="",index:h=0}=e,u=Math.PI/180,x=(s+c)/.8,m=a+x*Math.cos(-r*u),g=l+x*Math.sin(-r*u);return(0,n.jsx)("text",{x:m,y:g,fill:o[h%o.length],fontSize:t?12:16,textAnchor:m>a?"start":"end",dominantBaseline:"central",fontWeight:600,children:"".concat(d,": ").concat((100*i).toFixed(1),"%")})},children:i.map((e,t)=>(0,n.jsx)(w.f,{fill:o[t%o.length]},e.gender))}),(0,n.jsx)(p.m,{}),(0,n.jsx)(b.s,{wrapperStyle:{paddingTop:t?0:"20px",fontSize:t?"10px":"14px",color:"#4b5563",display:t?"none":void 0},iconType:"circle",iconSize:t?8:10})]})})})]})]})},S=e=>{var t,a,l,r;let{loadingCustomerSummary:s,errorCustomerSummary:c,customerSummaryRaw:i}=e;return(0,n.jsxs)("div",{className:"flex flex-col md:flex-row gap-2 md:gap-4 mt-4",children:[(0,n.jsxs)("div",{className:"flex-1 bg-white rounded-xl shadow-lg p-6 flex flex-col items-center justify-center",children:[(0,n.jsx)("div",{className:"text-xl font-medium text-gray-700 mb-2 text-center",children:"Tổng số kh\xe1ch mới trong hệ thống"}),(0,n.jsx)("div",{className:"text-5xl font-bold text-black mb-2",children:s?(0,n.jsx)("span",{children:"Đang tải dữ liệu..."}):c?(0,n.jsx)("span",{className:"text-red-500",children:c}):null!=(l=null==i||null==(t=i.totalNewCustomers)?void 0:t.toLocaleString())?l:0}),!s&&!c&&(null==i?void 0:i.growthTotal)!==void 0&&(0,n.jsxs)("div",{className:"flex items-center gap-1 text-sm font-medium ".concat(i.growthTotal>=0?"text-green-600":"text-red-600"),children:[(0,n.jsx)("span",{children:i.growthTotal>=0?"↗":"↘"}),(0,n.jsxs)("span",{children:[Math.abs(i.growthTotal).toFixed(1),"%"]}),(0,n.jsx)("span",{className:"text-gray-500",children:"so với kỳ trước"})]})]}),(0,n.jsxs)("div",{className:"flex-1 bg-white rounded-xl shadow-lg p-6 flex flex-col items-center justify-center",children:[(0,n.jsx)("div",{className:"text-xl font-medium text-gray-700 mb-2 text-center",children:"Tổng số kh\xe1ch mới thực đi"}),(0,n.jsx)("div",{className:"text-5xl font-bold text-black mb-2",children:s?(0,n.jsx)("span",{children:"Đang tải dữ liệu..."}):c?(0,n.jsx)("span",{className:"text-red-500",children:c}):null!=(r=null==i||null==(a=i.actualCustomers)?void 0:a.toLocaleString())?r:0}),!s&&!c&&(null==i?void 0:i.growthActual)!==void 0&&(0,n.jsxs)("div",{className:"flex items-center gap-1 text-sm font-medium ".concat(i.growthActual>=0?"text-green-600":"text-red-600"),children:[(0,n.jsx)("span",{children:i.growthActual>=0?"↗":"↘"}),(0,n.jsxs)("span",{children:[Math.abs(i.growthActual).toFixed(1),"%"]}),(0,n.jsx)("span",{className:"text-gray-500",children:"so với kỳ trước"})]})]})]})},k=e=>{let{isMobile:t,customerTypeTrendData:a,customerTypeKeys:l,COLORS:r}=e;return(0,n.jsxs)("div",{className:"bg-white pt-2 mt-5 rounded-xl shadow-lg ".concat(t?"w-full max-w-xs mx-auto flex flex-col items-center":""),style:{minWidth:t?220:void 0},children:[(0,n.jsx)("h2",{className:"text-base lg:text-xl text-center font-semibold text-gray-800 p-3",children:"Số kh\xe1ch tới chia theo loại"}),(0,n.jsx)("div",{className:"w-full flex justify-center",children:(0,n.jsx)(u.u,{width:"100%",height:t?180:350,minWidth:220,children:(0,n.jsxs)(x.b,{data:a,margin:{top:t?10:30,right:10,left:10,bottom:t?20:40},children:[(0,n.jsx)(m.d,{stroke:"#e5e7eb",strokeDasharray:"5 5"}),(0,n.jsx)(g.W,{dataKey:"date",stroke:"#6b7280",fontSize:t?10:12,tickLine:!1,axisLine:{stroke:"#d1d5db"},angle:t?-20:0,textAnchor:t?"end":"middle",height:t?40:60,tickFormatter:e=>{if(!e)return"";let t=String(e).match(/^\d{4}-(\d{2})-(\d{2})$/);if(t){let[,e,a]=t;return"".concat(a,"/").concat(e)}return String(e)}}),(0,n.jsx)(f.h,{stroke:"#6b7280",fontSize:t?10:12,tickLine:!1,axisLine:{stroke:"#d1d5db"},tickFormatter:e=>e>0?"".concat(e," kh\xe1ch"):e,padding:{bottom:10,top:10}}),(0,n.jsx)(p.m,{}),(0,n.jsx)(b.s,{wrapperStyle:{paddingTop:t?"":"20px",fontSize:t?"10px":"14px",color:"#4b5563",display:"flex",flexDirection:t?"column":"row",alignItems:"center",justifyContent:"center",flexWrap:t?"nowrap":"wrap",width:"100%",maxHeight:t?80:void 0,overflowY:t?"auto":void 0},iconType:"circle",iconSize:t?8:10,verticalAlign:t?"bottom":void 0}),l.map((e,t)=>(0,n.jsx)(j.N,{type:"natural",dataKey:e,name:e,stroke:r[t%r.length],strokeWidth:2,dot:!1,activeDot:{r:6,fill:r[t%r.length],stroke:"#fff",strokeWidth:2},animationDuration:1500},e))]})})})]})};var C=a(3401),T=a(56690);let E=e=>{let{isMobile:t,customerSourceTrendData:a,customerSourceKeys:l,COLORS:r}=e;return(0,n.jsxs)("div",{className:"w-full bg-white rounded-xl shadow-lg mt-5",children:[(0,n.jsx)("div",{className:"text-xl font-medium text-gray-700 text-center pt-5",children:"Nguồn của đơn h\xe0ng"}),(0,n.jsx)("div",{className:"w-full bg-white rounded-xl shadow-lg",children:(0,n.jsx)(u.u,{width:"100%",height:t?220:350,minWidth:t?180:320,children:(0,n.jsxs)(C.E,{data:a,margin:{top:t?20:50,right:10,left:10,bottom:t?20:40},children:[(0,n.jsx)(m.d,{strokeDasharray:"3 3"}),(0,n.jsx)(g.W,{dataKey:"date",fontSize:t?9:12,tickFormatter:e=>{let t=e.match(/^\d{4}-(\d{2})-(\d{2})$/);if(t){let[,e,a]=t;return"".concat(a,"/").concat(e)}return e}}),(0,n.jsx)(f.h,{fontSize:t?9:12}),(0,n.jsx)(p.m,{}),(0,n.jsx)(b.s,{wrapperStyle:{paddingTop:5*!t,paddingBottom:10*!t,display:"flex",justifyContent:"center",flexWrap:"wrap",width:"100%",fontSize:t?9:14}}),l.map((e,s)=>(0,n.jsx)(T.y,{dataKey:e,fill:r[s%r.length],name:e,label:t?void 0:e=>{let{x:t,y:c,width:i,value:o,index:d}=e;if("number"!=typeof d||d<0||"number"!=typeof t||"number"!=typeof c||"number"!=typeof i)return(0,n.jsx)("g",{});let h=a[d];return h&&o===Math.max(...l.map(e=>Number(h[e]||0)))&&o>0?(0,n.jsx)("text",{x:t+i/2,y:c-5,textAnchor:"middle",fill:r[s%r.length],fontSize:14,fontWeight:600,children:o}):(0,n.jsx)("g",{})}},e))]})})})]})},D=e=>{let{isMobile:t,loading:a,error:l,sortedAppDownloadStatusData:r}=e;return(0,n.jsxs)("div",{className:"w-full bg-white rounded-xl shadow-lg mt-4 lg:mt-5",children:[(0,n.jsx)("div",{className:"text-lg lg:text-xl font-medium text-gray-700 text-center pt-6 lg:pt-10",children:"Kh\xe1ch tải app/kh\xf4ng tải"}),(0,n.jsx)("div",{className:"flex justify-center items-center py-4 lg:py-8",children:a?(0,n.jsx)("div",{children:"Đang tải dữ liệu..."}):l?(0,n.jsx)("div",{className:"text-red-500",children:l}):(0,n.jsx)(u.u,{width:"100%",height:t?220:300,minWidth:t?180:320,children:(0,n.jsxs)(C.E,{data:r,children:[(0,n.jsx)(m.d,{strokeDasharray:"3 3"}),(0,n.jsx)(g.W,{dataKey:"date",fontSize:t?9:12,tickFormatter:e=>{if(!e)return"";let t=String(e).match(/^(\d{4})-(\d{2})-(\d{2})/);if(t){let[,,e,a]=t;return"".concat(a,"/").concat(e)}let a=String(e).match(/^(\d{2})\/(\d{2})(?:\/\d{4})?$/);return a?"".concat(a[1],"/").concat(a[2]):"string"==typeof e&&e.length>=10?e.slice(8,10)+"/"+e.slice(5,7):e}}),(0,n.jsx)(f.h,{allowDecimals:!1,fontSize:t?9:12}),(0,n.jsx)(p.m,{}),(0,n.jsx)(b.s,{fontSize:t?9:12}),(0,n.jsx)(T.y,{dataKey:"downloaded",fill:"#9ee347",name:"Đ\xe3 tải app",label:t?void 0:{position:"top",fontSize:14,fontWeight:600,fill:"#9ee347"}}),(0,n.jsx)(T.y,{dataKey:"notDownloaded",fill:"#f0bf4c",name:"Chưa tải app",label:t?void 0:{position:"top",fontSize:14,fontWeight:600,fill:"#f0bf4c"}})]})})})]})},z=["#ff7f7f","#b39ddb","#8d6e63","#c5e1a5","#81d4fa","#f0bf4c","#bccefb","#a9b8c3"],F=e=>{let{appDownloadPieData:t,loadingAppDownload:a,errorAppDownload:r}=e,[s,c]=l.useState(!1);return l.useEffect(()=>{let e=()=>{c(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,n.jsxs)("div",{className:"w-full bg-white rounded-xl shadow-lg mt-5 p-2 sm:p-4",children:[(0,n.jsx)("div",{className:"text-sm sm:text-base md:text-xl font-medium text-gray-700 text-center mb-4",children:"Tỷ lệ tải app"}),(0,n.jsx)("div",{className:"w-full overflow-x-auto",children:a?(0,n.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,n.jsx)("div",{className:"text-gray-500",children:"Đang tải dữ liệu..."})}):r?(0,n.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,n.jsx)("div",{className:"text-red-500",children:r})}):(0,n.jsx)(u.u,{width:"100%",height:s?300:400,minWidth:280,children:(0,n.jsxs)(y.r,{children:[(0,n.jsx)(v.F,{data:t,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",innerRadius:s?"25%":"30%",outerRadius:s?"50%":"60%",label:e=>{let{percent:t}=e;return t&&t>.05?"".concat((100*t).toFixed(0),"%"):""},labelLine:!1,children:t.map((e,t)=>(0,n.jsx)(w.f,{fill:z[t%z.length]},e.name))}),(0,n.jsx)(p.m,{formatter:e=>[e.toLocaleString(),"Số lượng"],contentStyle:{fontSize:s?12:14,backgroundColor:"rgba(255, 255, 255, 0.95)",border:"1px solid #ccc",borderRadius:"4px",padding:"8px"}}),(0,n.jsx)(b.s,{wrapperStyle:{fontSize:s?10:12,paddingTop:s?10:20,display:"flex",justifyContent:"center",flexWrap:"wrap",width:"100%"},layout:"horizontal",verticalAlign:"bottom",align:"center"})]})})})]})},K=e=>{let{isMobile:t,paymentPercentNewPieData:a,paymentPercentOldPieData:l}=e;return(0,n.jsxs)("div",{className:"flex flex-col lg:flex-row gap-2",children:[(0,n.jsxs)("div",{className:"w-full bg-white rounded-xl shadow-lg mt-4 lg:mt-5",children:[(0,n.jsx)("div",{className:"text-lg lg:text-xl font-medium text-gray-700 text-center pt-6 lg:pt-10",children:"Tỉ lệ c\xe1c h\xecnh thức thanh to\xe1n ( kh\xe1ch mới )"}),(0,n.jsx)("div",{className:"flex justify-center items-center 18 lg:py-8",children:(0,n.jsx)(u.u,{width:"100%",height:t?220:300,minWidth:t?180:320,children:(0,n.jsxs)(y.r,{children:[(0,n.jsx)(v.F,{data:a,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",innerRadius:"30%",outerRadius:"60%",label:t?e=>{var t;let{percent:l,x:r,y:s,index:c}=e;if(!l||l<=0||"number"!=typeof c||c<0)return null;let i=(null==(t=a[c])?void 0:t.color)||"#333";return(0,n.jsx)("text",{x:r,y:s,textAnchor:"middle",dominantBaseline:"central",fontSize:10,fontWeight:600,fill:i,children:"".concat((100*l).toFixed(1),"%")})}:e=>{var t;let{percent:l,x:r,y:s,index:c}=e;if(!l||l<=0||"number"!=typeof c||c<0)return null;let i=(null==(t=a[c])?void 0:t.color)||"#333";return(0,n.jsx)("text",{x:r,y:s,textAnchor:"middle",dominantBaseline:"central",fontSize:14,fontWeight:600,fill:i,children:"".concat((100*l).toFixed(1),"%")})},labelLine:!1,children:a.map(e=>(0,n.jsx)(w.f,{fill:e.color},e.name))}),(0,n.jsx)(p.m,{formatter:(e,t,a)=>{var n;return"".concat(Number(e).toLocaleString()," (").concat(null==(n=a.payload.percent)?void 0:n.toFixed(2),"%)")}}),(0,n.jsx)(b.s,{wrapperStyle:{paddingTop:10,paddingBottom:10,display:"flex",justifyContent:"center",flexWrap:"wrap",width:"100%",fontSize:t?9:12},layout:"horizontal",verticalAlign:"bottom",align:"center"})]})})})]}),(0,n.jsxs)("div",{className:"w-full bg-white rounded-xl shadow-lg mt-4 lg:mt-5",children:[(0,n.jsx)("div",{className:"text-lg lg:text-xl font-medium text-gray-700 text-center pt-6 lg:pt-10",children:"Tỉ lệ c\xe1c h\xecnh thức thanh to\xe1n ( kh\xe1ch cũ )"}),(0,n.jsx)("div",{className:"flex justify-center items-center py-4 lg:py-8",children:(0,n.jsx)(u.u,{width:"100%",height:300,children:(0,n.jsxs)(y.r,{children:[(0,n.jsx)(v.F,{data:l,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",innerRadius:"30%",outerRadius:"60%",label:t?e=>{var t;let{percent:a,x:r,y:s,index:c}=e;if(!a||a<=0||"number"!=typeof c||c<0)return null;let i=(null==(t=l[c])?void 0:t.color)||"#333";return(0,n.jsx)("text",{x:r,y:s,textAnchor:"middle",dominantBaseline:"central",fontSize:10,fontWeight:600,fill:i,children:"".concat((100*a).toFixed(1),"%")})}:e=>{var t;let{percent:a,x:r,y:s,index:c}=e;if(!a||a<=0||"number"!=typeof c||c<0)return null;let i=(null==(t=l[c])?void 0:t.color)||"#333";return(0,n.jsx)("text",{x:r,y:s,textAnchor:"middle",dominantBaseline:"central",fontSize:14,fontWeight:600,fill:i,children:"".concat((100*a).toFixed(1),"%")})},labelLine:!1,children:l.map(e=>(0,n.jsx)(w.f,{fill:e.color},e.name))}),(0,n.jsx)(p.m,{}),(0,n.jsx)(b.s,{wrapperStyle:{paddingTop:10,paddingBottom:10,display:"flex",justifyContent:"center",flexWrap:"wrap",width:"100%",fontSize:t?9:12},layout:"horizontal",verticalAlign:"bottom",align:"center"})]})})})]})]})};var R=a(37945),M=a(6044),A=a(17606);let L="https://338bc771545b.ngrok-free.app";function W(e,t,a){let[n,r]=(0,l.useState)(null),[s,c]=(0,l.useState)(!0),[i,o]=(0,l.useState)(null);return(0,l.useEffect)(()=>{c(!0),fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fromDate:t,toDate:a})}).then(e=>{if(!e.ok)throw Error("API error: "+e.status);return e.json()}).then(e=>{r(e),c(!1)}).catch(e=>{o(e.message),c(!1)})},[e,t,a]),{data:n,loading:s,error:i}}function O(){var e,t,a,d,u,x,m,g,f,p;let{notification:b,showSuccess:j,showError:y,hideNotification:v}=(0,R.h)(),w=(0,l.useRef)(!1),C=(0,l.useRef)(!1),{reportPageError:T,reportDataLoadSuccess:z,reportFilterChange:O,reportResetFilters:B,reportPagePerformance:H}=(0,A.n)("customers"),[P]=(0,l.useState)([]),[U,V]=(0,M.V)("customer-selectedType",[]),[I,_]=(0,M.V)("customer-selectedStatus",null),[X,$]=(0,l.useState)(!1),[G,J]=(0,l.useState)(!1),[Y,q]=(0,M.V)("customer-startDate",(0,r.Ec)((0,r.Xj)()).subtract({days:7})),[Q,Z]=(0,M.V)("customer-endDate",(0,r.Ec)((0,r.Xj)())),[ee,et]=(0,M.V)("customer-selectedRegions",[]),[ea,en]=(0,l.useState)(!1),[el,er]=(0,M.V)("customer-selectedBranches",[]),[es,ec]=(0,l.useState)(!1),ei=["#5bd1d7","#eb94cf","#f66035","#00d084","#9b51e0","#0693e3","#ff7f7f","#b39ddb","#8d6e63","#c5e1a5","#81d4fa","#fff176","#d81b60"],eo=Y?"".concat(Y.year,"-").concat(String(Y.month).padStart(2,"0"),"-").concat(String(Y.day).padStart(2,"0"),"T00:00:00"):"",ed=Q?"".concat(Q.year,"-").concat(String(Q.month).padStart(2,"0"),"-").concat(String(Q.day).padStart(2,"0"),"T23:59:59"):"",{data:eh,loading:eu,error:ex}=W("".concat(L,"/api/customer-sale/new-customer-lineChart"),eo,ed);(0,l.useEffect)(()=>{if(eh&&!eu&&!ex){var e;let t=Date.now(),a=(null==(e=eh.currentRange)?void 0:e.reduce((e,t)=>e+(t.count||0),0))||0;H({loadTime:Date.now()-t,dataSize:a}),z("kh\xe1ch h\xe0ng mới",a)}},[eh,eu,ex,H,z]),(0,l.useEffect)(()=>{ex&&T("Lỗi tải dữ liệu kh\xe1ch h\xe0ng mới: ".concat(ex))},[ex,T]),(0,l.useEffect)(()=>{U.length>0&&O("loại kh\xe1ch h\xe0ng: ".concat(U.join(", ")))},[U,O]),(0,l.useEffect)(()=>{I&&O("trạng th\xe1i: ".concat(I))},[I,O]),(0,l.useEffect)(()=>{ee.length>0&&O("khu vực: ".concat(ee.join(", ")))},[ee,O]),(0,l.useEffect)(()=>{el.length>0&&O("chi nh\xe1nh: ".concat(el.join(", ")))},[el,O]);let{data:em,loading:eg,error:ef}=W("".concat(L,"/api/customer-sale/gender-ratio"),eo,ed),{data:ep}=W("".concat(L,"/api/customer-sale/customer-type-trend"),eo,ed),{data:eb}=W("".concat(L,"/api/customer-sale/customer-source-trend"),eo,ed),{data:ej,loading:ey,error:ev}=W("".concat(L,"/api/customer-sale/app-download-status"),eo,ed),{data:ew,loading:eN,error:eS}=W("".concat(L,"/api/customer-sale/app-download-pieChart"),eo,ed),{data:ek,loading:eC,error:eT}=W("".concat(L,"/api/customer-sale/customer-summary"),eo,ed),{data:eE,loading:eD,error:ez}=W("".concat(L,"/api/customer-sale/gender-revenue"),eo,ed),{data:eF}=W("".concat(L,"/api/customer-sale/payment-percent-new"),eo,ed),{data:eK}=W("".concat(L,"/api/customer-sale/payment-percent-old"),eo,ed),{data:eR}=W("".concat(L,"/api/customer-sale/unique-customers-comparison"),eo,ed),{data:eM,loading:eA,error:eL}=W("".concat(L,"/api/customer-sale/facility-hour-service"),eo,ed),eW=[ex,ef,ev,eS,eT,ez,eL],eO=[eu,eg,ey,eN,eC,eD,eA].some(e=>e),eB=eW.some(e=>e);(0,l.useEffect)(()=>{eO||eB||!ek||w.current||(j("Dữ liệu kh\xe1ch h\xe0ng đ\xe3 được tải th\xe0nh c\xf4ng!"),w.current=!0)},[eO,eB,ek,j]),(0,l.useEffect)(()=>{eB&&!C.current&&(y("Kh\xf4ng thể kết nối đến API. Vui l\xf2ng thử lại sau."),C.current=!0)},[eB,y]);let eH=l.useMemo(()=>{if(!eh)return[];let e=Array.isArray(eh.currentRange)?eh.currentRange:[],t=Array.isArray(eh.previousRange)?eh.previousRange:[];return e.map((e,a)=>{var n,l;return{date:e.date||"",value:e.count,value2:null!=(l=null==(n=t[a])?void 0:n.count)?l:0}})},[eh]),eP=l.useMemo(()=>em?[{gender:"Nam",count:em.male||0},{gender:"Nữ",count:em.female||0}]:[],[em]),eU=l.useMemo(()=>{if(!ep)return[];let e=new Set;Object.values(ep).forEach(t=>{t.forEach(t=>{e.add(t.date.slice(0,10))})});let t=Array.from(e).sort(),a=Object.keys(ep);return t.map(e=>{let t={date:String(e)};return a.forEach(a=>{let n=ep[a].find(t=>t.date.slice(0,10)===e);t[a]=n?n.count:0}),t})},[ep]),eV=l.useMemo(()=>{if(!eb)return[];let e=new Set;Object.values(eb).forEach(t=>{t.forEach(t=>{e.add(t.date.slice(0,10))})});let t=Array.from(e).sort(),a=Object.keys(eb);return t.map(e=>{let t={date:String(e)};return a.forEach(a=>{let n=eb[a].find(t=>t.date.slice(0,10)===e);t[a]=n?n.count:0}),t})},[eb]),eI=l.useMemo(()=>ej?Object.values(ej).flat():[],[ej]),e_=l.useMemo(()=>ew?[{name:"Đ\xe3 tải app",value:ew.totalNew||0},{name:"Chưa tải app",value:ew.totalOld||0}]:[],[ew]),eX=l.useMemo(()=>eF?[{name:"TM+CK+QT",value:(eF.totalCash||0)+(eF.totalTransfer||0)+(eF.totalPrepaidCard||0),color:"#f66035"},{name:"TIỀN MẶT",value:eF.totalCash||0,color:"#00d084"},{name:"CHUYỂN KHOẢN",value:eF.totalTransfer||0,color:"#5bd1d7"},{name:"C\xd2N NỢ",value:eF.totalDebt||0,color:"#eb94cf"}]:[],[eF]),e$=[...Array.isArray(P)?P:[]],eG=["NG\xc0Y TẠO","M\xc3 ĐƠN H\xc0NG","T\xcaN KH\xc1CH H\xc0NG","SỐ ĐIỆN THOẠI","NH\xd3M KH\xc1CH H\xc0NG"],eJ=e$.filter(e=>{let t=e["Unnamed: 1"]||e["Unnamed: 3"]||"";if(eG.includes(String(t).trim().toUpperCase()))return!1;let a=e1(String(t));return a.compare(Y)>=0&&0>=a.compare(Q)}),eY=new Set;eJ.forEach(e=>{var t;let a=null==(t=e["Unnamed: 4"])?void 0:t.toString().trim();a&&eY.add(a)});let eq=new Set;Array.isArray(P)&&P.forEach(e=>{var t;let a=null==(t=e["Unnamed: 3"])?void 0:t.toString().trim();a&&eY.has(a)&&eq.add(a)});let eQ=new Set;e$.forEach(e=>{var t;let a=e["Unnamed: 1"]||e["Unnamed: 3"]||"";if(eG.includes(String(a).trim().toUpperCase()))return;let n=e1(String(a)),l=null==(t=e["Unnamed: 4"])?void 0:t.toString().trim();l&&0>n.compare(Y)&&eQ.add(l)});let eZ=new Set,e0=new Set;function e1(e){if(!e||"string"!=typeof e)return(0,r.Ec)((0,r.Xj)());let t=e.match(/^\d{1,2}:\d{2} (\d{1,2})\/(\d{1,2})\/(\d{4})$/);if(t||(t=e.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/))){let[,e,a,n]=t;return(0,s._U)("".concat(n,"-").concat(a.padStart(2,"0"),"-").concat(e.padStart(2,"0")))}return(0,r.Ec)((0,r.Xj)())}eJ.forEach(e=>{var t;let a=null==(t=e["Unnamed: 4"])?void 0:t.toString().trim();a&&(eQ.has(a)||eZ.has(a)||(e0.add(a),eZ.add(a)))});let e2=new Set;eJ.forEach(e=>{var t;let a=null==(t=e["Unnamed: 4"])?void 0:t.toString().trim();a&&(eQ.has(a)||e2.has(a)||e2.add(a))});let e5=640>function(){let[e,t]=(0,l.useState)(1024);return(0,l.useEffect)(()=>{function e(){t(window.innerWidth)}return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),e}(),e6=l.useMemo(()=>eK?[{name:"TM+CK+QT",value:(eK.totalCash||0)+(eK.totalTransfer||0)+(eK.totalPrepaidCard||0),color:"#f66035"},{name:"TIỀN MẶT",value:eK.totalCash||0,color:"#00d084"},{name:"CHUYỂN KHOẢN",value:eK.totalTransfer||0,color:"#5bd1d7"},{name:"C\xd2N NỢ",value:eK.totalDebt||0,color:"#eb94cf"}]:[],[eK]),e4=l.useMemo(()=>{if(!eM)return[];let e=new Set;return eM.forEach(t=>{Object.keys(t.hourlyCounts).forEach(t=>e.add(t))}),Array.from(e).sort((e,t)=>{let a=e=>parseInt(e.split("-")[0],10);return a(e)-a(t)})},[eM]),e3=l.useMemo(()=>eM?eM.map(e=>({facility:e.facility,...e.hourlyCounts,total:e.total})).sort((e,t)=>t.total-e.total):[],[eM]),e8=eU.length>0?Object.keys(eU[0]).filter(e=>"date"!==e):[],e9=l.useMemo(()=>0===eV.length?[]:Object.keys(eV[0]).filter(e=>"date"!==e),[eV]),e7=l.useMemo(()=>{let e={};return e4.forEach(t=>{let a=Math.max(...e3.map(e=>{var a;return Number(null!=(a=e[t])?a:0)}));e[t]=a}),e},[e3,e4]),te=l.useMemo(()=>eI?[...eI].sort((e,t)=>{let a=e=>{if(!e.date)return 0;let t=String(e.date).match(/^(\d{4})-(\d{2})-(\d{2})/);if(t)return new Date("".concat(t[1],"-").concat(t[2],"-").concat(t[3])).getTime();let a=String(e.date).match(/^(\d{2})\/(\d{2})\/(\d{4})$/);return a?new Date("".concat(a[3],"-").concat(a[2],"-").concat(a[1])).getTime():new Date(e.date).getTime()};return a(e)-a(t)}):[],[eI]);return(0,n.jsxs)("div",{className:"p-2 sm:p-4 md:p-6 max-w-full",children:[(0,n.jsx)(R.E,{type:b.type,message:b.message,isVisible:b.isVisible,onClose:v}),(0,n.jsx)("div",{className:"mb-6",children:(0,n.jsxs)("div",{className:"p-2",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,n.jsx)("h1",{className:"text-xl lg:text-2xl font-semibold text-gray-900",children:"Customer Report"}),(0,n.jsx)("button",{onClick:()=>{(0,M.e)(["customer-selectedType","customer-selectedStatus","customer-startDate","customer-endDate","customer-selectedRegions","customer-selectedBranches"]),V([]),_(null),q((0,r.Ec)((0,r.Xj)()).subtract({days:7})),Z((0,r.Ec)((0,r.Xj)())),et([]),er([]),j("Đ\xe3 reset tất cả filter về mặc định!"),B()},className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors text-sm",children:"Reset Filters"})]}),(0,n.jsx)(i,{startDate:Y,endDate:Q,setStartDate:q,setEndDate:Z,today:r.Ec,getLocalTimeZone:r.Xj,parseDate:s._U,selectedType:U,setSelectedType:V,showTypeDropdown:X,setShowTypeDropdown:$,customerTypes:["KH trải nghiệm","Kh\xe1ch h\xe0ng Th\xe0nh vi\xean","Kh\xe1ch h\xe0ng Bạc","Kh\xe1ch h\xe0ng V\xe0ng","Kh\xe1ch h\xe0ng Bạch Kim","Kh\xe1ch h\xe0ng Kim cương"],selectedStatus:I,setSelectedStatus:_,showStatusDropdown:G,setShowStatusDropdown:J,customerStatus:["New","Old"],selectedRegions:ee,setSelectedRegions:et,showRegionDropdown:ea,setShowRegionDropdown:en,allRegions:["Đ\xe3 đ\xf3ng cửa","Đ\xe0 Nẵng","Nha Trang","H\xe0 Nội","HCM"],selectedBranches:el,setSelectedBranches:er,showBranchDropdown:es,setShowBranchDropdown:ec,allBranches:["Branch 1","Branch 2","Branch 3"]}),(0,n.jsx)(o,{value:null!=(x=null==eR||null==(e=eR.current)?void 0:e.toLocaleString())?x:0,label:"Tổng số kh\xe1ch trong khoảng ng\xe0y đ\xe3 chọn",percentChange:null==eR?void 0:eR.changePercent}),(0,n.jsx)(h,{loading:eD,error:ez,avgRevenueMale:null!=(m=null==eE||null==(t=eE.avgRevenueMale)?void 0:t.toLocaleString())?m:0,avgRevenueFemale:null!=(g=null==eE||null==(a=eE.avgRevenueFemale)?void 0:a.toLocaleString())?g:0,avgServiceMale:null!=(f=null==eE||null==(d=eE.avgServiceMale)?void 0:d.toLocaleString())?f:0,avgServiceFemale:null!=(p=null==eE||null==(u=eE.avgServiceFemale)?void 0:u.toLocaleString())?p:0}),(0,n.jsx)(N,{isMobile:e5,loadingNewCustomer:eu,errorNewCustomer:ex,newCustomerChartData:eH,loadingGenderRatio:eg,errorGenderRatio:ef,genderRatioData:eP,COLORS:ei}),(0,n.jsx)(S,{loadingCustomerSummary:eC,errorCustomerSummary:eT,customerSummaryRaw:ek}),(0,n.jsx)(k,{isMobile:e5,customerTypeTrendData:eU,customerTypeKeys:e8,COLORS:ei}),(0,n.jsx)(E,{isMobile:e5,customerSourceTrendData:eV,customerSourceKeys:e9,COLORS:ei}),(0,n.jsx)(D,{isMobile:e5,loading:ey,error:ev,sortedAppDownloadStatusData:te}),(0,n.jsx)(F,{loadingAppDownload:eN,errorAppDownload:eS,appDownloadPieData:e_}),(0,n.jsx)(K,{isMobile:e5,paymentPercentNewPieData:eX,paymentPercentOldPieData:e6}),(0,n.jsx)(c,{allHourRanges:e4,facilityHourTableData:e3,getCellBg:function(e,t){let a=e7[t]||0;if(!a||0===a||0===e)return"";let n=e/a;return n>=.9?"bg-[#68B2A0]":n>=.7?"bg-[#CDE0C9]":n>=.5?"bg-[#E0ECDE]":n>=.3?"bg-[#F0F8F0]":n>=.1?"bg-[#F8FCF8]":""},isMobile:e5,loadingFacilityHour:eA,errorFacilityHour:eL})]})})]})}},37945:(e,t,a)=>{"use strict";a.d(t,{E:()=>i,h:()=>o});var n=a(95155),l=a(12115),r=a(40646),s=a(54861),c=a(54416);let i=e=>{let{type:t,message:a,isVisible:i,onClose:o,duration:d=5e3}=e,[h,u]=(0,l.useState)(!1);if((0,l.useEffect)(()=>{if(i){u(!0);let e=setTimeout(()=>{u(!1),setTimeout(o,300)},d);return()=>clearTimeout(e)}},[i,d,o]),!i)return null;let x="success"===t?"text-green-800":"text-red-800",m="success"===t?r.A:s.A;return(0,n.jsx)("div",{className:"fixed top-4 right-4 z-50 max-w-sm w-full transition-all duration-300 ease-in-out ".concat(h?"opacity-100 translate-y-0":"opacity-0 -translate-y-2"),children:(0,n.jsx)("div",{className:"".concat("success"===t?"bg-green-50":"bg-red-50"," border ").concat("success"===t?"border-green-200":"border-red-200"," rounded-lg shadow-lg p-4"),children:(0,n.jsxs)("div",{className:"flex items-start",children:[(0,n.jsx)("div",{className:"flex-shrink-0",children:(0,n.jsx)(m,{className:"h-5 w-5 ".concat("success"===t?"text-green-400":"text-red-400")})}),(0,n.jsx)("div",{className:"ml-3 flex-1",children:(0,n.jsx)("p",{className:"text-sm font-medium ".concat(x),children:a})}),(0,n.jsx)("div",{className:"ml-4 flex-shrink-0",children:(0,n.jsx)("button",{onClick:()=>{u(!1),setTimeout(o,300)},className:"inline-flex ".concat(x," hover:").concat(x," focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-").concat("success"===t?"green":"red","-500"),children:(0,n.jsx)(c.A,{className:"h-4 w-4"})})})]})})})},o=()=>{let[e,t]=(0,l.useState)({type:"success",message:"",isVisible:!1});return{notification:e,showSuccess:e=>{t({type:"success",message:e,isVisible:!0})},showError:e=>{t({type:"error",message:e,isVisible:!0})},hideNotification:()=>{t(e=>({...e,isVisible:!1}))}}}},50660:(e,t,a)=>{Promise.resolve().then(a.bind(a,24660))},93504:(e,t,a)=>{"use strict";a.d(t,{b:()=>c});var n=a(12115),l=a(46641),r=a(82396),s=["axis"],c=(0,n.forwardRef)((e,t)=>n.createElement(r.P,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:s,tooltipPayloadSearcher:l.uN,categoricalChartProps:e,ref:t}))}},e=>{var t=t=>e(e.s=t);e.O(0,[156,939,932,464,262,366,441,684,358],()=>t(50660)),_N_E=e.O()}]);