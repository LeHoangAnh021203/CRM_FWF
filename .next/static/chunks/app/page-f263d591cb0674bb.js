(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8974],{17606:(e,s,a)=>{"use strict";a.d(s,{n:()=>r,o:()=>n});var t=a(12115);class l{subscribe(e){return this.listeners.add(e),()=>this.listeners.delete(e)}emit(){this.listeners.forEach(e=>e())}constructor(){this.listeners=new Set}}let n=new l;function r(e){let s=(0,t.useCallback)(async s=>{try{await fetch("/api/notifications",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({pageName:e,...s})}),n.emit()}catch(e){console.error("Failed to update page status:",e)}},[e]),a=(0,t.useCallback)(a=>{s({dataLoaded:!0,successCount:1,lastSuccess:a||"Trang ".concat(o(e)," đ\xe3 sẵn s\xe0ng sử dụng")})},[s,e]),l=(0,t.useCallback)(e=>{s({errorCount:1,lastError:e})},[s]),r=(0,t.useCallback)(e=>{s({lastSuccess:e})},[s]),c=(0,t.useCallback)((e,a)=>{s({successCount:1,lastSuccess:a?"Dữ liệu ".concat(e,": ").concat(a.toLocaleString()," bản ghi đ\xe3 sẵn s\xe0ng"):"Dữ liệu ".concat(e," đ\xe3 được tải th\xe0nh c\xf4ng")})},[s]),d=(0,t.useCallback)((e,a)=>{s({errorCount:1,lastError:"Kh\xf4ng thể tải dữ liệu ".concat(e,": ").concat(a)})},[s]),i=(0,t.useCallback)(e=>{s({lastSuccess:"Bộ lọc ".concat(e," đ\xe3 được cập nhật")})},[s]),u=(0,t.useCallback)(()=>{s({lastSuccess:"Tất cả bộ lọc đ\xe3 được đặt lại về mặc định"})},[s]),h=(0,t.useCallback)((e,a)=>{s({lastSuccess:"Biểu đồ ".concat(e,": ").concat(a)})},[s]),m=(0,t.useCallback)(a=>{let t="Trang ".concat(o(e)," đ\xe3 tải xong");a.loadTime&&(t+=" (".concat(a.loadTime,"ms)")),a.dataSize&&(t+=" - ".concat(a.dataSize," bản ghi")),s({dataLoaded:!0,successCount:1,lastSuccess:t})},[s,e]);return(0,t.useEffect)(()=>{s({dataLoaded:!1,errorCount:0,successCount:0})},[s]),{reportPageLoad:a,reportPageError:l,reportPageActivity:r,reportDataLoadSuccess:c,reportDataLoadError:d,reportFilterChange:i,reportResetFilters:u,reportChartInteraction:h,reportPagePerformance:m}}function o(e){return({customers:"Kh\xe1ch h\xe0ng",orders:"Đơn h\xe0ng",services:"Dịch vụ",dashboard:"Tổng quan"})[e]||e}},37327:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>g});var t=a(95155),l=a(12115);let n=(0,l.lazy)(()=>Promise.all([a.e(4277),a.e(550)]).then(a.bind(a,30550)).then(e=>({default:e.StatsCards}))),r=(0,l.lazy)(()=>Promise.all([a.e(4277),a.e(8759)]).then(a.bind(a,28759)).then(e=>({default:e.RevenueChart}))),o=(0,l.lazy)(()=>Promise.all([a.e(4277),a.e(4697)]).then(a.bind(a,24697)).then(e=>({default:e.RecentActivity}))),c=(0,l.lazy)(()=>Promise.all([a.e(4277),a.e(1625),a.e(4223)]).then(a.bind(a,34223)).then(e=>({default:e.TasksWidget}))),d=(0,l.lazy)(()=>Promise.all([a.e(4277),a.e(5386)]).then(a.bind(a,75386)).then(e=>({default:e.CustomerInsights}))),i=(0,l.lazy)(()=>Promise.all([a.e(4277),a.e(71)]).then(a.bind(a,80071)).then(e=>({default:e.QuickActions})));var u=a(37945),h=a(17606),m=a(49049);function g(){let{notification:e,showSuccess:s,showError:a,hideNotification:g}=(0,u.h)(),v=(0,l.useRef)(!1),p=(0,l.useRef)(!1),{reportPageError:x,reportDataLoadSuccess:f,reportPagePerformance:b,reportDataLoadError:y}=(0,h.n)("dashboard"),{loading:j,error:C,apiErrors:N,apiSuccesses:w}=(0,m.e)();return(0,l.useEffect)(()=>{w.length>0&&!v.current&&(s(1===w.length?w[0]:"".concat(w.length," data sources loaded successfully")),v.current=!0,f("dashboard",w.length))},[w,s,f]),(0,l.useEffect)(()=>{if(N.length>0&&!p.current){let e=1===N.length?N[0]:"".concat(N.length," data sources failed to load");a(e),p.current=!0,y("dashboard",e)}},[N,a,y]),(0,l.useEffect)(()=>{C&&!p.current&&(a(C),p.current=!0,x(C))},[C,a,x]),(0,l.useEffect)(()=>{j||b({loadTime:2e3})},[j,b]),(0,t.jsxs)("div",{className:"p-3 sm:p-6",children:[(0,t.jsx)(u.E,{type:e.type,message:e.message,isVisible:e.isVisible,onClose:g}),(0,t.jsxs)("div",{className:"mb-3 sm:mb-6",children:[(0,t.jsx)("h1",{className:"text-lg sm:text-2xl font-semibold text-gray-900 mb-2",children:"Dashboard"}),(0,t.jsxs)("p",{className:"text-gray-600 flex flex-wrap items-center gap-[3px] text-sm sm:text-base",children:["Welcome back! Here's what's happening with"," ",(0,t.jsx)("span",{className:"text-orange-500 flex",children:"Face Wash Fox"})," today."]})]}),(0,t.jsx)(l.Suspense,{fallback:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[(0,t.jsx)("div",{className:"h-6 bg-gray-200 rounded animate-pulse mb-4 w-32"}),(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[void 0,void 0,void 0,void 0].map((e,s)=>(0,t.jsx)("div",{className:"h-20 bg-gray-200 rounded animate-pulse"},s))})]}),children:(0,t.jsx)(i,{})}),(0,t.jsx)(l.Suspense,{fallback:(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[void 0,void 0,void 0,void 0].map((e,s)=>(0,t.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-24"}),(0,t.jsx)("div",{className:"h-8 bg-gray-200 rounded animate-pulse w-20"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-16"}),(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-20"})]})]}),(0,t.jsx)("div",{className:"h-12 w-12 bg-gray-200 rounded-full animate-pulse"})]})},s))}),children:(0,t.jsx)(n,{})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-3 sm:gap-6 mt-6",children:[(0,t.jsx)("div",{className:"lg:col-span-2",children:(0,t.jsx)(l.Suspense,{fallback:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,t.jsx)("div",{className:"h-6 bg-gray-200 rounded animate-pulse mb-4 w-32"}),(0,t.jsx)("div",{className:"h-64 bg-gray-200 rounded animate-pulse"})]}),children:(0,t.jsx)(r,{})})}),(0,t.jsx)(l.Suspense,{fallback:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,t.jsx)("div",{className:"h-6 bg-gray-200 rounded animate-pulse mb-4 w-36"}),(0,t.jsx)("div",{className:"space-y-3",children:[void 0,void 0,void 0,void 0].map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"h-10 w-10 bg-gray-200 rounded-full animate-pulse"}),(0,t.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-24"}),(0,t.jsx)("div",{className:"h-3 bg-gray-200 rounded animate-pulse w-16"})]})]},s))})]}),children:(0,t.jsx)(d,{})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3 sm:gap-6 mt-6",children:[(0,t.jsx)(l.Suspense,{fallback:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,t.jsx)("div",{className:"h-6 bg-gray-200 rounded animate-pulse mb-4 w-24"}),(0,t.jsx)("div",{className:"space-y-3",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"h-4 w-4 bg-gray-200 rounded animate-pulse"}),(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-32"})}),(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-12"})]},s))})]}),children:(0,t.jsx)(c,{})}),(0,t.jsx)(l.Suspense,{fallback:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,t.jsx)("div",{className:"h-6 bg-gray-200 rounded animate-pulse mb-4 w-32"}),(0,t.jsx)("div",{className:"space-y-3",children:[void 0,void 0,void 0,void 0].map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"h-10 w-10 bg-gray-200 rounded-full animate-pulse"}),(0,t.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-28"}),(0,t.jsx)("div",{className:"h-3 bg-gray-200 rounded animate-pulse w-20"})]}),(0,t.jsx)("div",{className:"h-3 bg-gray-200 rounded animate-pulse w-12"})]},s))})]}),children:(0,t.jsx)(o,{})})]})]})}},37945:(e,s,a)=>{"use strict";a.d(s,{E:()=>c,h:()=>d});var t=a(95155),l=a(12115),n=a(40646),r=a(54861),o=a(54416);let c=e=>{let{type:s,message:a,isVisible:c,onClose:d,duration:i=5e3}=e,[u,h]=(0,l.useState)(!1);if((0,l.useEffect)(()=>{if(c){h(!0);let e=setTimeout(()=>{h(!1),setTimeout(d,300)},i);return()=>clearTimeout(e)}},[c,i,d]),!c)return null;let m="success"===s?"text-green-800":"text-red-800",g="success"===s?n.A:r.A;return(0,t.jsx)("div",{className:"fixed top-4 right-4 z-50 max-w-sm w-full transition-all duration-300 ease-in-out ".concat(u?"opacity-100 translate-y-0":"opacity-0 -translate-y-2"),children:(0,t.jsx)("div",{className:"".concat("success"===s?"bg-green-50":"bg-red-50"," border ").concat("success"===s?"border-green-200":"border-red-200"," rounded-lg shadow-lg p-4"),children:(0,t.jsxs)("div",{className:"flex items-start",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)(g,{className:"h-5 w-5 ".concat("success"===s?"text-green-400":"text-red-400")})}),(0,t.jsx)("div",{className:"ml-3 flex-1",children:(0,t.jsx)("p",{className:"text-sm font-medium ".concat(m),children:a})}),(0,t.jsx)("div",{className:"ml-4 flex-shrink-0",children:(0,t.jsx)("button",{onClick:()=>{h(!1),setTimeout(d,300)},className:"inline-flex ".concat(m," hover:").concat(m," focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-").concat("success"===s?"green":"red","-500"),children:(0,t.jsx)(o.A,{className:"h-4 w-4"})})})]})})})},d=()=>{let[e,s]=(0,l.useState)({type:"success",message:"",isVisible:!1});return{notification:e,showSuccess:e=>{s({type:"success",message:e,isVisible:!0})},showError:e=>{s({type:"error",message:e,isVisible:!0})},hideNotification:()=>{s(e=>({...e,isVisible:!1}))}}}},49049:(e,s,a)=>{"use strict";a.d(s,{e:()=>r});var t=a(12115),l=a(68931);let n="localhost"===window.location.hostname?"http://localhost:3000":"https://fb-network-demo.vercel.app";function r(){let[e,s]=(0,t.useState)(null),[a,r]=(0,t.useState)([]),[o]=(0,t.useState)([]),[c]=(0,t.useState)([]),[d,i]=(0,t.useState)(!0),[u,h]=(0,t.useState)(null),[m,g]=(0,t.useState)([]),[v,p]=(0,t.useState)([]),x=(0,t.useRef)(!1);return(0,t.useEffect)(()=>{(async()=>{try{i(!0),h(null),g([]),p([]);let e=(0,l.Ec)((0,l.Xj)()),t=e.subtract({days:30}).toString(),o=e.toString(),c=[{name:"Orders Summary",url:"".concat(n,"/api/sales/overall-order-summary"),handler:e=>{let a={totalOrders:e.totalOrders||0,ordersChange:e.deltaTotalOrders||0};s(e=>({totalRevenue:(null==e?void 0:e.totalRevenue)||0,totalOrders:a.totalOrders,totalCustomers:(null==e?void 0:e.totalCustomers)||0,totalProducts:(null==e?void 0:e.totalProducts)||0,revenueChange:(null==e?void 0:e.revenueChange)||0,ordersChange:a.ordersChange,customersChange:(null==e?void 0:e.customersChange)||0,productsChange:(null==e?void 0:e.productsChange)||0}))}},{name:"Revenue Summary",url:"".concat(n,"/api/sales/revenue-summary"),handler:e=>{let a={totalRevenue:e.totalRevenue||0,revenueChange:e.revenueGrowth||0};s(e=>({totalRevenue:a.totalRevenue,totalOrders:(null==e?void 0:e.totalOrders)||0,totalCustomers:(null==e?void 0:e.totalCustomers)||0,totalProducts:(null==e?void 0:e.totalProducts)||0,revenueChange:a.revenueChange,ordersChange:(null==e?void 0:e.ordersChange)||0,customersChange:(null==e?void 0:e.customersChange)||0,productsChange:(null==e?void 0:e.productsChange)||0}))}},{name:"Customer Summary",url:"".concat(n,"/api/customer-sale/customer-summary"),handler:e=>{let a={totalCustomers:e.totalCustomers||0,customersChange:e.deltaTotalCustomers||0};s(e=>({totalRevenue:(null==e?void 0:e.totalRevenue)||0,totalOrders:(null==e?void 0:e.totalOrders)||0,totalCustomers:a.totalCustomers,totalProducts:(null==e?void 0:e.totalProducts)||0,revenueChange:(null==e?void 0:e.revenueChange)||0,ordersChange:(null==e?void 0:e.ordersChange)||0,customersChange:a.customersChange,productsChange:(null==e?void 0:e.productsChange)||0}))}},{name:"Service Summary",url:"".concat(n,"/api/service-record/service-summary"),handler:e=>{let a={totalProducts:e.totalServices||0,productsChange:e.deltaTotalServices||0};s(e=>({totalRevenue:(null==e?void 0:e.totalRevenue)||0,totalOrders:(null==e?void 0:e.totalOrders)||0,totalCustomers:(null==e?void 0:e.totalCustomers)||0,totalProducts:a.totalProducts,revenueChange:(null==e?void 0:e.revenueChange)||0,ordersChange:(null==e?void 0:e.ordersChange)||0,customersChange:(null==e?void 0:e.customersChange)||0,productsChange:a.productsChange}))}},{name:"Daily Region Revenue",url:"".concat(n,"/api/sales/daily-region-revenue"),handler:e=>{if(console.log("Daily Region Revenue API response:",e),e&&e.currentRange&&Array.isArray(e.currentRange)){let s=e.currentRange.map(e=>({date:e.date||new Date().toISOString().split("T")[0],revenue:e.totalRevenue||0}));console.log("Chart data from daily region revenue:",s),r(s)}else console.log("No valid data from daily region revenue API")}},{name:"Region Revenue",url:"".concat(n,"/api/sales/region-revenue"),handler:e=>{if(console.log("Region Revenue API response:",e),e&&e.currentRange&&Array.isArray(e.currentRange)){let s=e.currentRange.map(e=>({date:e.date||new Date().toISOString().split("T")[0],revenue:e.totalRevenue||0}));console.log("Chart data from region revenue:",s),r(s)}else console.log("No valid data from region revenue API")}},{name:"Shop Type Revenue",url:"".concat(n,"/api/sales/shop-type-revenue"),handler:e=>{if(console.log("Shop Type Revenue API response:",e),e&&e.currentRange&&Array.isArray(e.currentRange)){let s=e.currentRange.map(e=>({date:e.date||new Date().toISOString().split("T")[0],revenue:e.actualRevenue||e.totalRevenue||0}));console.log("Chart data from shop type revenue:",s),r(s)}else console.log("No valid data from shop type revenue API")}}],d=(await Promise.allSettled(c.map(async e=>{try{let s=await fetch(e.url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fromDate:t,toDate:o})});if(!s.ok)throw Error("HTTP ".concat(s.status,": ").concat(s.statusText));let a=await s.json();return e.handler(a),p(s=>[...s,"".concat(e.name," data loaded successfully")]),{name:e.name,success:!0,data:a}}catch(a){let s=a instanceof Error?a.message:"Failed to fetch ".concat(e.name," data");throw g(e=>[...e,s]),a}}))).filter(e=>"rejected"===e.status);if(d.length>0){let e=d.map(e=>"rejected"===e.status?e.reason.message:"Unknown error");h("Some data failed to load: ".concat(e.join(", ")))}if(0===d.length&&h(null),0===a.length&&!x.current){console.log("Creating fallback revenue data");let e=[],s=new Date;for(let a=29;a>=0;a--){let t=new Date(s);t.setDate(t.getDate()-a),e.push({date:t.toISOString().split("T")[0],revenue:Math.floor(5e7*Math.random())+1e7})}console.log("Fallback revenue data:",e),r(e),x.current=!0}}catch(e){h(e instanceof Error?e.message:"Failed to fetch dashboard data"),console.error("Dashboard data fetch error:",e)}finally{i(!1)}})()},[]),{stats:e,revenueData:a,recentActivity:o,customerInsights:c,loading:d,error:u,apiErrors:m,apiSuccesses:v}}},59752:(e,s,a)=>{Promise.resolve().then(a.bind(a,37327))}},e=>{var s=s=>e(e.s=s);e.O(0,[8262,8441,1684,7358],()=>s(59752)),_N_E=e.O()}]);