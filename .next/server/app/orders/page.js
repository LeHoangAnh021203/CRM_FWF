(()=>{var e={};e.id=1778,e.ids=[1778],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},8186:(e,r,a)=>{Promise.resolve().then(a.bind(a,41636))},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11965:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>t});let t=(0,a(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/lehoanganh/Documents/FB Network/FE/src/app/orders/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/lehoanganh/Documents/FB Network/FE/src/app/orders/page.tsx","default")},13193:(e,r,a)=>{"use strict";a.d(r,{E:()=>i,h:()=>d});var t=a(60687),n=a(43210),s=a(5336),l=a(35071),o=a(11860);let i=({type:e,message:r,isVisible:a,onClose:i,duration:d=5e3})=>{let[c,u]=(0,n.useState)(!1);if((0,n.useEffect)(()=>{if(a){u(!0);let e=setTimeout(()=>{u(!1),setTimeout(i,300)},d);return()=>clearTimeout(e)}},[a,d,i]),!a)return null;let h="success"===e?"text-green-800":"text-red-800",m="success"===e?s.A:l.A;return(0,t.jsx)("div",{className:`fixed top-4 right-4 z-50 max-w-sm w-full transition-all duration-300 ease-in-out ${c?"opacity-100 translate-y-0":"opacity-0 -translate-y-2"}`,children:(0,t.jsx)("div",{className:`${"success"===e?"bg-green-50":"bg-red-50"} border ${"success"===e?"border-green-200":"border-red-200"} rounded-lg shadow-lg p-4`,children:(0,t.jsxs)("div",{className:"flex items-start",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)(m,{className:`h-5 w-5 ${"success"===e?"text-green-400":"text-red-400"}`})}),(0,t.jsx)("div",{className:"ml-3 flex-1",children:(0,t.jsx)("p",{className:`text-sm font-medium ${h}`,children:r})}),(0,t.jsx)("div",{className:"ml-4 flex-shrink-0",children:(0,t.jsx)("button",{onClick:()=>{u(!1),setTimeout(i,300)},className:`inline-flex ${h} hover:${h} focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-${"success"===e?"green":"red"}-500`,children:(0,t.jsx)(o.A,{className:"h-4 w-4"})})})]})})})},d=()=>{let[e,r]=(0,n.useState)({type:"success",message:"",isVisible:!1});return{notification:e,showSuccess:e=>{r({type:"success",message:e,isVisible:!0})},showError:e=>{r({type:"error",message:e,isVisible:!0})},hideNotification:()=>{r(e=>({...e,isVisible:!1}))}}}},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},41636:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>C});var t=a(60687),n=a(43210),s=a.n(n),l=a(67763),o=a(7562);let i=(0,n.lazy)(()=>a.e(7983).then(a.bind(a,77983))),d=(0,n.lazy)(()=>Promise.all([a.e(2383),a.e(3397),a.e(7203),a.e(6109)]).then(a.bind(a,46109))),c=(0,n.lazy)(()=>Promise.all([a.e(2383),a.e(3397),a.e(7203),a.e(7053)]).then(a.bind(a,17053))),u=(0,n.lazy)(()=>a.e(4623).then(a.bind(a,74623))),h=(0,n.lazy)(()=>Promise.all([a.e(2383),a.e(3650),a.e(2167)]).then(a.bind(a,9179))),m=(0,n.lazy)(()=>Promise.all([a.e(2383),a.e(3397),a.e(7203),a.e(1340)]).then(a.bind(a,61340))),g=(0,n.lazy)(()=>Promise.all([a.e(2383),a.e(3397),a.e(3446),a.e(4157)]).then(a.bind(a,4157))),p=(0,n.lazy)(()=>Promise.all([a.e(2383),a.e(3397),a.e(7203),a.e(920)]).then(a.bind(a,40920))),v=(0,n.lazy)(()=>Promise.all([a.e(2383),a.e(3397),a.e(7203),a.e(6720)]).then(a.bind(a,26720))),x=(0,n.lazy)(()=>a.e(9769).then(a.bind(a,79769))),b=(0,n.lazy)(()=>Promise.all([a.e(2383),a.e(3397),a.e(7203),a.e(3446),a.e(4344)]).then(a.bind(a,64344))),f=(0,n.lazy)(()=>Promise.all([a.e(2383),a.e(3397),a.e(7203),a.e(6555)]).then(a.bind(a,56555))),y=(0,n.lazy)(()=>a.e(8927).then(a.bind(a,18927))),N=(0,n.lazy)(()=>a.e(6456).then(a.bind(a,66456)));var j=a(13193),T=a(70212),w=a(34276);let S=["NG\xc0Y TẠO","M\xc3 ĐƠN H\xc0NG","T\xcaN KH\xc1CH H\xc0NG","SỐ ĐIỆN THOẠI"],O="https://c68783755745.ngrok-free.app";function D(e,r,a){let[t,s]=(0,n.useState)(null),[l,o]=(0,n.useState)(!0),[i,d]=(0,n.useState)(null);return{data:t,loading:l,error:i}}let M={"Crescent Mall Q7":"HCM","Vincom Thảo Điền":"HCM","Vista Verde":"HCM","Aeon Mall T\xe2n Ph\xfa Celadon":"HCM","Westpoint Phạm H\xf9ng":"HCM","Aeon Mall B\xecnh T\xe2n":"HCM","Vincom Phan Văn Trị":"HCM","Vincom Landmark 81":"HCM","TTTM Estella Place":"HCM","V\xf5 Thị S\xe1u Q.1":"HCM","The Sun Avenue":"HCM","Trương Định Q.3":"HCM","Hoa Lan Q.PN":"HCM","Nowzone Q.1":"HCM","Everrich Infinity Q.5":"HCM","SC VivoCity":"HCM","Vincom L\xea Văn Việt":"HCM","The Bonatica Q.TB":"HCM","Midtown Q.7":"HCM","Riviera Point Q7":"HCM","Saigon Ofice":"HCM","Millenium Apartment Q.4":"HCM","Parc Mall Q.8":"HCM","Saigon Mia Trung Sơn":"HCM","Đảo Ngọc Ngũ X\xe3 HN":"H\xe0 Nội","Imperia Sky Garden HN":"H\xe0 Nội","Vincom B\xe0 Triệu":"H\xe0 Nội","Gold Coast Nha Trang":"Nha Trang","Trần Ph\xfa Đ\xe0 Nẵng":"Đ\xe0 Nẵng","Vincom Quang Trung":"HCM"};function C(){let{notification:e,showSuccess:r,showError:a,hideNotification:C}=(0,j.h)();(0,n.useRef)(!1),(0,n.useRef)(!1);let{reportPageError:P,reportDataLoadSuccess:R,reportFilterChange:k,reportResetFilters:H,reportPagePerformance:$}=(0,w.n)("orders"),[A,K]=(0,T.V)("orders-startDate",(0,l.Ec)((0,l.Xj)()).subtract({days:7})),[V,E]=(0,T.V)("orders-endDate",(0,l.Ec)((0,l.Xj)())),[B,F]=(0,T.V)("orders-selectedBranches",[]),[z,W]=(0,T.V)("orders-selectedRegions",[]),[U,Q]=(0,n.useState)(!1),[_,L]=(0,n.useState)(!1),[G,q]=(0,n.useState)(""),[I,X]=(0,n.useState)(""),Y=(0,n.useRef)(null),J=(0,n.useRef)(null),Z=s().useMemo(()=>["Crescent Mall Q7","Vincom Thảo Điền","Vista Verde","Aeon Mall T\xe2n Ph\xfa Celadon","Westpoint Phạm H\xf9ng","Aeon Mall B\xecnh T\xe2n","Vincom Phan Văn Trị","Vincom Landmark 81","TTTM Estella Place","V\xf5 Thị S\xe1u Q.1","The Sun Avenue","Trương Định Q.3","Hoa Lan Q.PN","Nowzone Q.1","Everrich Infinity Q.5","SC VivoCity","Đảo Ngọc Ngũ X\xe3 HN","Vincom L\xea Văn Việt","The Bonatica Q.TB","Midtown Q.7","Trần Ph\xfa Đ\xe0 Nẵng","Vincom Quang Trung","Vincom B\xe0 Triệu","Imperia Sky Garden HN","Gold Coast Nha Trang","Riviera Point Q7","Saigon Ofice","Millenium Apartment Q.4","Parc Mall Q.8","Saigon Mia Trung Sơn"],[]),ee=A?`${A.year}-${String(A.month).padStart(2,"0")}-${String(A.day).padStart(2,"0")}T00:00:00`:"",er=V?`${V.year}-${String(V.month).padStart(2,"0")}-${String(V.day).padStart(2,"0")}T23:59:59`:"",{data:ea,loading:et,error:en}=D(`${O}/api/sales/region-revenue`,ee,er),{data:es,loading:el,error:eo}=D(`${O}/api/sales/shop-type-revenue`,ee,er),{data:ei,loading:ed,error:ec}=D(`${O}/api/sales/revenue-summary`,ee,er),{data:eu,loading:eh,error:em}=D(`${O}/api/sales/region-stat`,ee,er),{data:eg}=D(`${O}/api/sales/overall-summary`,ee,er),{data:ep,loading:ev,error:ex}=D(`${O}/api/sales/region-actual-pie`,ee,er),{data:eb,loading:ef,error:ey}=D(`${O}/api/sales/daily-region-revenue`,ee,er),{data:eN,loading:ej,error:eT}=D(`${O}/api/sales/daily-by-customer-type`,ee,er),{data:ew,loading:eS,error:eO}=D(`${O}/api/sales/daily-order-stats`,ee,er),{data:eD,loading:eM,error:eC}=D(`${O}/api/sales/full-store-revenue`,ee,er),{data:eP,loading:eR,error:ek}=D(`${O}/api/sales/region-order-breakdown-table`,ee,er),{data:eH,loading:e$,error:eA}=D(`${O}/api/sales/region-order-breakdown`,ee,er),{data:eK,loading:eV,error:eE}=D(`${O}/api/sales/overall-order-summary`,ee,er),eB=[en,eo,ec,em,ex,ey,eT,eO,eC,ek,eA,eE];function eF(e){let r;if(!e||"string"!=typeof e)return null;if(r=(e=e.trim()).match(/^([0-9]{1,2}):[0-9]{2}\s([0-9]{1,2})\/([0-9]{1,2})\/([0-9]{4})$/))try{return(0,o._U)(`${r[4]}-${r[3].padStart(2,"0")}-${r[2].padStart(2,"0")}`)}catch{return null}if((r=e.match(/^([0-9]{1,2}) thg ([0-9]{1,2}), ([0-9]{4})$/))||(r=e.match(/^([0-9]{1,2})\/([0-9]{1,2})\/([0-9]{4})$/)))try{return(0,o._U)(`${r[3]}-${r[2].padStart(2,"0")}-${r[1].padStart(2,"0")}`)}catch{return null}if(r=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})$/))try{return(0,o._U)(e)}catch{return null}if(r=e.match(/^([0-9]{2})-([0-9]{2})-([0-9]{2})$/)){let e=Number(r[1]),a=Number(r[2]),t=Number(r[3]);if(e<1||e>12||a<1||a>31)return null;let n=`${t<50?2e3+t:1900+t}-${String(e).padStart(2,"0")}-${String(a).padStart(2,"0")}`;try{return(0,o._U)(n)}catch{}}return null}[et,el,ed,eh,ev,ef,ej,eS,eM,eR,e$,eV].some(e=>e),eB.some(e=>e);let ez=(0,n.useCallback)(e=>{if(M[e])return M[e];let r=(e||"").toLowerCase();return["q1","q3","q5","q7","q8","t\xe2n ph\xfa","b\xecnh t\xe2n","thảo điền","landmark","crescent mall","vincom","vista verde","aeon","estella","nowzone","sc vivocity","sun avenue","saigon mia","parc mall","millenium","riviera point","midtown","the bonatica","hoa lan","trương định","v\xf5 thị s\xe1u"].some(e=>r.includes(e))?"HCM":["h\xe0 nội","t\xe2y hồ","b\xe0 triệu","imperia sky garden","đảo ngọc ngũ x\xe3"].some(e=>r.includes(e))?"H\xe0 Nội":r.includes("đ\xe0 nẵng")?"Đ\xe0 Nẵng":r.includes("nha trang")?"Nha Trang":r.includes("đ\xe3 đ\xf3ng cửa")?"Đ\xe3 Đ\xf3ng Cửa":"Kh\xe1c"},[]),eW=s().useMemo(()=>[],[]),eU=s().useMemo(()=>eW.map(e=>{let r=String(e["Unnamed: 1"]||e["Unnamed: 3"]||"");if(!r||S.includes(r.trim().toUpperCase()))return null;let a=eF(r);if(!a)return null;let t=e["Unnamed: 7"];"Nam"!==t&&"Nữ"!==t&&(t="#N/A");let n=String(e["Unnamed: 11"]||"");return{date:r,calendarDate:a,value:Number(e["Unnamed: 18"]??e["Unnamed: 16"]??e["Unnamed: 9"])||0,value2:Number(e["Unnamed: 19"]??e["Unnamed: 10"])||0,type:String(e["Unnamed: 12"]||"N/A"),status:String(e["Unnamed: 13"]||"N/A"),gender:t,branch:n,region:ez(n)}}).filter(e=>!!e&&!!e.date),[eW,ez]);function eQ(e,r,a){return e.calendarDate.compare(r)>=0&&0>=e.calendarDate.compare(a)}let e_=s().useMemo(()=>{let e=eb||ea?.currentRange||ea;if(!e)return[];let r=Array.isArray(e)?e:[],a=ee.split("T")[0],t=er.split("T")[0],n=r.filter(e=>{let r=e.date;return r>=a&&r<=t}),s={};return n.forEach(e=>{let r=e.date;s[r]||(s[r]={date:r,HCM:0,HaNoi:0,DaNang:0,NhaTrang:0,DaDongCua:0,VungTau:0});let a=e.region||e.shopType||"";"H\xe0 Nội"===a&&(a="HaNoi"),"Đ\xe0 Nẵng"===a&&(a="DaNang"),"Nha Trang"===a&&(a="NhaTrang"),"Vũng T\xe0u"===a&&(a="VungTau"),"Đ\xe3 Đ\xf3ng Cửa"===a&&(a="DaDongCua");let t=e.actualRevenue||e.totalRevenue||0;a&&a in s[r]&&(s[r][a]=t)}),Object.values(s).forEach(e=>{let r=e.HCM||0,a=e.HaNoi||0,t=e.DaNang||0,n=e.NhaTrang||0,s=e.DaDongCua||0,l=e.VungTau||0;e.total=r+a+t+n+s+l}),Object.values(s).sort((e,r)=>e.date.localeCompare(r.date))},[eb,ea,ee,er]),eL=A.subtract({days:7}),eG=A.subtract({days:1}),eq=s().useMemo(()=>Array.isArray(eu)?eu.map(e=>({region:e.region,ordersThisWeek:e.orders,deltaOrders:e.delta,revenueThisWeek:e.revenue,percentDelta:e.growthPercent,percentage:e.percentage})):[],[eu]),eI=s().useMemo(()=>{if(!Array.isArray(eu)||0===eu.length)return console.log("regionStatRaw is empty or not array:",eu),0;let e=eu.reduce((e,r)=>e+r.revenue,0),r=eu.reduce((e,r)=>e+(r.previousRevenue||0),0),a=e-r,t=r>0?a/r*100:0;return console.log("Total Percent Change Calculation:",{totalCurrentRevenue:e,totalPreviousRevenue:r,totalRevenueChange:a,percentChange:t,regionStatRaw:eu.map(e=>({region:e.region,revenue:e.revenue,previousRevenue:e.previousRevenue}))}),console.log("Final percentChange:",t,"Test value:",1.56),0!==t?t:1.56},[eu]),eX=eU.filter(e=>eQ(e,A,V)).reduce((e,r)=>e+r.value,0),eY=eU.filter(e=>eQ(e,eL,eG)).reduce((e,r)=>e+r.value,0),eJ=0===eY?null:(eX-eY)/eY*100,eZ=eU.filter(e=>"KH trải nghiệm"===e.type&&eQ(e,A,V)).reduce((e,r)=>e+r.value2,0),e0=eU.filter(e=>"KH trải nghiệm"===e.type&&eQ(e,eL,eG)).reduce((e,r)=>e+r.value2,0),e1=0===e0?null:(eZ-e0)/e0*100,e2=eU.filter(e=>"Kh\xe1ch h\xe0ng Th\xe0nh vi\xean"===e.type&&eQ(e,A,V)).reduce((e,r)=>e+r.value2,0),e4=eU.filter(e=>"Kh\xe1ch h\xe0ng Th\xe0nh vi\xean"===e.type&&eQ(e,eL,eG)).reduce((e,r)=>e+r.value2,0),e3=0===e4?null:(e2-e4)/e4*100,e6=eU.filter(e=>"Kh\xe1ch h\xe0ng Th\xe0nh vi\xean"===e.type&&eQ(e,A,V)).reduce((e,r)=>e+r.value,0),e7=eU.filter(e=>"Kh\xe1ch h\xe0ng Th\xe0nh vi\xean"===e.type&&eQ(e,eL,eG)).reduce((e,r)=>e+r.value,0),e9=0===e7?null:(e6-e7)/e7*100,e5=Math.round(.45*eX),e8=Math.round(.45*eY),re=0===e8?null:(e5-e8)/e8*100,rr=function(e,r){let a=1,t=e;for(;0>t.compare(r);)t=t.add({days:1}),a++;return a}(A,V),ra=Math.round(eX/rr),rt=Math.round(eY/rr),rn=0===rt?null:(ra-rt)/rt*100,rs=s().useMemo(()=>{if(!eg)return{totalRevenueThisWeek:eX,percentRevenue:eJ,retailThisWeek:eZ,percentRetail:e1,productThisWeek:e2,percentProduct:e3,cardThisWeek:e6,percentCard:e9,foxieThisWeek:e5,percentFoxie:re,avgRevenueThisWeek:ra,percentAvg:rn};let e=ra,r=rn;if(eK){e=Math.round(5e5*eK.totalOrders/7);let a=eK.totalOrders-eK.deltaTotalOrders;a>0&&(r=Math.round(eK.deltaTotalOrders/a*1e4)/100),console.log("Overall Order Summary API Data:",eK),console.log("Calculated Average Revenue:",e),console.log("Calculated Percent Change:",r)}return{totalRevenueThisWeek:eg.totalRevenue,percentRevenue:eg.percentTotalRevenue,retailThisWeek:eg.serviceRevenue,percentRetail:eg.percentServiceRevenue,productThisWeek:eg.productRevenue,percentProduct:eg.percentProductRevenue,cardThisWeek:eg.cardPurchaseRevenue,percentCard:eg.percentCardPurchaseRevenue,foxieThisWeek:eg.foxieCardRevenue,percentFoxie:eg.percentFoxieCardRevenue,avgRevenueThisWeek:e,percentAvg:r}},[eg,eK,eX,eJ,eZ,e1,e2,e3,e6,e9,e5,re,ra,rn]),rl=s().useMemo(()=>Z.filter(e=>e.toLowerCase().includes(I.toLowerCase())),[I,Z]),ro=s().useMemo(()=>eq.map(e=>({name:e.region,total:Object.values(M).filter(r=>r===e.region).length})),[eq]),ri=s().useMemo(()=>ro.filter(e=>e.name.toLowerCase().includes(G.toLowerCase())),[ro,G]),rd=s().useMemo(()=>{if(!eD){let e={};return Z.forEach(r=>{e[r]=eU.filter(e=>e.branch===r&&eQ(e,A,V)).reduce((e,r)=>e+r.value,0)}),Object.entries(e).sort((e,r)=>r[1]-e[1]).slice(0,10).map(([e,r],a)=>({name:e,revenue:Number(r),foxie:Math.round(.45*Number(r)),rank:a+1}))}let e=[...eD].sort((e,r)=>r.actualRevenue-e.actualRevenue).slice(0,10);return console.log("Full Store Revenue API Data:",eD),console.log("Top 10 Stores:",e),e.map((e,r)=>({name:e.storeName,revenue:e.actualRevenue,foxie:e.foxieRevenue,rank:r+1}))},[eD,eU,A,V,Z]),rc=s().useMemo(()=>{if(!ep?.currentRange)return eq.map(e=>({name:e.region,value:e.revenueThisWeek}));let e={};return ep.currentRange.forEach(r=>{let a=r.shopType;a&&(e[a]=(e[a]||0)+r.totalRevenue)}),Object.entries(e).map(([e,r])=>({name:e,value:r}))},[ep,eq]),ru=s().useMemo(()=>eD?eD.map(e=>({location:e.storeName,revenue:e.actualRevenue,revenueDelta:e.revenueGrowth,foxie:e.foxieRevenue,foxieDelta:null,orders:e.currentOrders,ordersDelta:e.deltaOrders,revenuePercent:e.revenuePercent,foxiePercent:e.foxiePercent,orderPercent:e.orderPercent})):Z.map(e=>{let r=eU.filter(r=>r.branch===e&&eQ(r,A,V)),a=eU.filter(r=>r.branch===e&&eQ(r,eL,eG)),t=r.reduce((e,r)=>e+r.value,0),n=a.reduce((e,r)=>e+r.value,0),s=Math.round(.45*t),l=Math.round(.45*n),o=r.length,i=a.length;return{location:e,revenue:t,revenueDelta:0===n?null:(t-n)/n*100,foxie:s,foxieDelta:0===l?null:(s-l)/l*100,orders:o,ordersDelta:0===i?null:(o-i)/i*100,revenuePercent:null,foxiePercent:null,orderPercent:null}}),[eD,eU,A,V,eL,eG,Z]),rh={};eU.forEach(e=>{"Kh\xe1ch h\xe0ng Th\xe0nh vi\xean"!==e.type&&(rh[e.date]||(rh[e.date]={count:0,avgPerShop:0,calendarDate:e.calendarDate}),rh[e.date].count++)}),Object.keys(rh).forEach(e=>{let r=new Set(eU.filter(r=>r.date===e&&"Kh\xe1ch h\xe0ng Th\xe0nh vi\xean"!==r.type).map(e=>e.branch));rh[e].avgPerShop=r.size>0?Math.round(rh[e].count/r.size):0});let rm=Object.entries(rh).sort((e,r)=>{let a=e[1].calendarDate,t=r[1].calendarDate;return a.compare(t)}),rg=s().useMemo(()=>Array.isArray(ew)&&ew.length>0?ew.map(e=>({date:e.date,orders:e.totalOrders,avgPerShop:e.avgOrdersPerShop})):[],[ew]),rp=[240,173,201,281,269,167,166,131,228,247,380,403,217,193,210,236,244,367,411,271,256,288,291,358,398,309,191,49,17,31,67];rm.forEach(([,e],r)=>{e.count=rp[r%rp.length],e.avgPerShop=5+Math.floor(11*Math.random())});let rv=s().useMemo(()=>{if(console.log("regionOrderBreakdown data:",eH),eH&&eH.length>0){let e=[...eH].sort((e,r)=>r.totalOrders-e.totalOrders).slice(0,10).map(e=>({name:e.region,totalOrders:e.totalOrders,retailOrders:e.serviceOrders,cardOrders:e.cardPurchaseOrders,foxieOrders:e.foxieCardOrders}));return console.log("chartOrderData result:",e),e}return console.log("No regionOrderBreakdown data available"),[]},[eH]),rx=s().useMemo(()=>eP&&eP.length>0?eP.map(e=>({location:e.shopName,totalOrders:e.totalOrders,totalOrdersDelta:e.deltaTotalOrders,cardOrders:e.cardPurchaseOrders,cardOrdersDelta:e.deltaCardPurchaseOrders,retailOrders:e.serviceOrders,retailOrdersDelta:e.deltaServiceOrders,foxieOrders:e.prepaidCard,foxieOrdersDelta:e.deltaPrepaidCard,comboOrders:e.comboOrders,comboOrdersDelta:e.deltaComboOrders})):[],[eP]),rb=rx.reduce((e,r)=>(e.totalOrders+=r.totalOrders,e.totalOrdersDelta+=r.totalOrdersDelta??0,e.cardOrders+=r.cardOrders,e.cardOrdersDelta+=r.cardOrdersDelta??0,e.retailOrders+=r.retailOrders,e.retailOrdersDelta+=r.retailOrdersDelta??0,e.foxieOrders+=r.foxieOrders,e.foxieOrdersDelta+=r.foxieOrdersDelta??0,e.comboOrders+=r.comboOrders,e.comboOrdersDelta+=r.comboOrdersDelta??0,e),{totalOrders:0,totalOrdersDelta:0,cardOrders:0,cardOrdersDelta:0,retailOrders:0,retailOrdersDelta:0,foxieOrders:0,foxieOrdersDelta:0,comboOrders:0,comboOrdersDelta:0}),rf=ru.filter(e=>"number"==typeof e.revenuePercent),ry=ru.filter(e=>"number"==typeof e.orderPercent),rN=rf.length>0?rf.reduce((e,r)=>e+(r.revenuePercent??0),0)/rf.length:0,rj=ry.length>0?ry.reduce((e,r)=>e+(r.orderPercent??0),0)/ry.length:0,rT=640>function(){let[e,r]=(0,n.useState)(1024);return e}(),rw=e=>{if(!e||"string"!=typeof e)return e;if(e.includes("T")){let r=new Date(e);if(!isNaN(r.getTime()))return`${String(r.getDate()).padStart(2,"0")}/${String(r.getMonth()+1).padStart(2,"0")}`}let r=eF(e);return r?`${String(r.day).padStart(2,"0")}/${String(r.month).padStart(2,"0")}`:e},rS=s().useMemo(()=>{if(!es)return[];let e=Array.isArray(es.currentRange)?es.currentRange:Array.isArray(es)?es:[],r={};return e.forEach(e=>{var a;let t=e.date;r[t]||(r[t]={date:t,Mall:0,Shophouse:0,NhaPho:0,DaDongCua:0,Khac:0});let n="Trong Mall"===(a=e.shopType)?"Mall":"Shophouse"===a?"Shophouse":"Nh\xe0 phố"===a?"NhaPho":"Đ\xe3 Đ\xf3ng Cửa"===a?"DaDongCua":"Khac",s=e.actualRevenue||e.totalRevenue||0;r[t][n]=s}),Object.values(r).forEach(e=>{e.total=(e.Mall||0)+(e.Shophouse||0)+(e.NhaPho||0)+(e.DaDongCua||0)+(e.Khac||0)}),Object.values(r).sort((e,r)=>e.date.localeCompare(r.date))},[es]),rO=s().useMemo(()=>{if(!eN)return[];let e=Array.isArray(eN)?eN:[],r=ee.split("T")[0],a=er.split("T")[0],t=e.filter(e=>{let t=e.date;return t>=r&&t<=a}),n={};return t.forEach(e=>{let r=e.date;n[r]||(n[r]={date:r,KHTraiNghiem:0,KHIron:0,KHSilver:0,KHBronze:0,KHDiamond:0,Khac:0});let a=e.customerType;"KH trải nghiệm"===a&&(a="KHTraiNghiem"),"Kh\xe1ch h\xe0ng Iron"===a&&(a="KHIron"),"Kh\xe1ch h\xe0ng Silver"===a&&(a="KHSilver"),"Kh\xe1ch h\xe0ng Bronze"===a&&(a="KHBronze"),"Kh\xe1ch h\xe0ng Diamond"===a&&(a="KHDiamond"),(""===a||"Kh\xf4ng x\xe1c định"===a||"Kh\xe1c"===a)&&(a="Khac");let t=e.revenue||0;a&&a in n[r]&&(n[r][a]=t),("Kh\xf4ng x\xe1c định"===e.customerType||""===e.customerType||"Kh\xe1c"===e.customerType)&&console.log(`Date: ${r}, CustomerType: "${e.customerType}", Revenue: ${t}, Mapped to: ${a}`)}),Object.values(n).forEach(e=>{e.total=(e.KHTraiNghiem||0)+(e.KHIron||0)+(e.KHSilver||0)+(e.KHBronze||0)+(e.KHDiamond||0)+(e.Khac||0)}),Object.values(n).sort((e,r)=>e.date.localeCompare(r.date))},[eN,ee,er]);return(0,t.jsxs)("div",{className:"p-2 sm:p-4 md:p-6 max-w-full",children:[(0,t.jsx)(j.E,{type:e.type,message:e.message,isVisible:e.isVisible,onClose:C}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)("div",{className:"p-2",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,t.jsx)("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-900",children:"Order Report"}),(0,t.jsx)("button",{onClick:()=>{(0,T.e)(["orders-startDate","orders-endDate","orders-selectedBranches","orders-selectedRegions"]),K((0,l.Ec)((0,l.Xj)()).subtract({days:7})),E((0,l.Ec)((0,l.Xj)())),F([]),W([]),r("Đ\xe3 reset tất cả filter về mặc định!"),H()},className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors text-sm",children:"Reset Filters"})]}),(0,t.jsx)(n.Suspense,{fallback:(0,t.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-4 mb-4 animate-pulse",children:(0,t.jsx)("div",{className:"h-10 bg-gray-200 rounded"})}),children:(0,t.jsx)(i,{startDate:A,setStartDate:K,endDate:V,setEndDate:E,today:()=>(0,l.Ec)((0,l.Xj)()),parseDate:o._U,selectedRegions:z,setSelectedRegions:W,regionOptions:ro,regionSearch:G,setRegionSearch:q,filteredRegionOptions:ri,showRegionDropdown:U,setShowRegionDropdown:Q,regionDropdownRef:Y,selectedBranches:B,setSelectedBranches:F,locationOptions:Z,locationSearch:I,setLocationSearch:X,filteredLocationOptions:rl,showLocationDropdown:_,setShowLocationDropdown:L,locationDropdownRef:J})})]}),(0,t.jsx)(n.Suspense,{fallback:(0,t.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-4 mb-4 animate-pulse",children:(0,t.jsx)("div",{className:"h-64 bg-gray-200 rounded"})}),children:(0,t.jsx)(d,{regionalSalesByDay:e_,formatAxisDate:rw})}),(0,t.jsx)(n.Suspense,{fallback:(0,t.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-4 mb-4 animate-pulse",children:(0,t.jsx)("div",{className:"h-64 bg-gray-200 rounded"})}),children:(0,t.jsx)(c,{storeTypeSalesByDay:rS,formatAxisDate:rw})}),(0,t.jsx)(n.Suspense,{fallback:(0,t.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-4 mb-4 animate-pulse",children:(0,t.jsx)("div",{className:"h-32 bg-gray-200 rounded"})}),children:(0,t.jsx)(u,{totalWeekSales:ei?.totalRevenue??0,weekSalesChange:ei?.revenueGrowth??0,totalRevenueThisWeek:ei?.actualRevenue??0,weekRevenueChange:ei?.actualGrowth??0,foxieDebtChange:0})}),(0,t.jsx)(n.Suspense,{fallback:(0,t.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-4 mb-4 animate-pulse",children:(0,t.jsx)("div",{className:"h-64 bg-gray-200 rounded"})}),children:(0,t.jsx)(h,{regionStats:eq,totalRevenueThisWeek:ep?.actualRevenue||(Array.isArray(eu)?eu.reduce((e,r)=>e+r.revenue,0):0),totalPercentChange:eI,pieRegionRevenueData:rc,isMobile:rT})}),(0,t.jsx)(n.Suspense,{fallback:(0,t.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-4 mb-4 animate-pulse",children:(0,t.jsx)("div",{className:"h-64 bg-gray-200 rounded"})}),children:(0,t.jsx)(m,{data:e_,isMobile:rT,formatAxisDate:rw},`regional-chart-${ee}-${er}`)}),(0,t.jsx)(n.Suspense,{fallback:(0,t.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-4 mb-4 animate-pulse",children:(0,t.jsx)("div",{className:"h-64 bg-gray-200 rounded"})}),children:(0,t.jsx)(g,{data:rS,formatAxisDate:rw})}),(0,t.jsx)(n.Suspense,{fallback:(0,t.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-4 mb-4 animate-pulse",children:(0,t.jsx)("div",{className:"h-64 bg-gray-200 rounded"})}),children:(0,t.jsx)(p,{isMobile:rT,customerTypeSalesByDay:rO})}),(0,t.jsx)(n.Suspense,{fallback:(0,t.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-4 mb-4 animate-pulse",children:(0,t.jsx)("div",{className:"h-64 bg-gray-200 rounded"})}),children:(0,t.jsx)(v,{isMobile:rT,top10LocationChartData:rd,fullStoreRevenueData:eD||void 0,formatMoneyShort:function(e){return e>=1e12?(e/1e12).toFixed(1)+"T":e>=1e9?(e/1e9).toFixed(1)+"B":e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e.toLocaleString()},totalRevenueThisWeek:rs.totalRevenueThisWeek,percentRevenue:rs.percentRevenue,retailThisWeek:rs.retailThisWeek,percentRetail:rs.percentRetail,productThisWeek:rs.productThisWeek,percentProduct:rs.percentProduct,cardThisWeek:rs.cardThisWeek,percentCard:rs.percentCard,foxieThisWeek:rs.foxieThisWeek,percentFoxie:rs.percentFoxie,avgRevenueThisWeek:rs.avgRevenueThisWeek,percentAvg:rs.percentAvg})}),(0,t.jsx)(n.Suspense,{fallback:(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-4 mb-4 animate-pulse",children:[(0,t.jsx)("div",{className:"h-5 bg-gray-200 rounded w-1/4 mb-4"}),(0,t.jsx)("div",{className:"space-y-2",children:[1,2,3,4,5,6,7,8,9,10].map(e=>(0,t.jsx)("div",{className:"h-8 bg-gray-200 rounded"},e))})]}),children:(0,t.jsx)(x,{storeTableData:ru,avgRevenuePercent:rN,avgFoxiePercent:0,avgOrderPercent:rj})}),(0,t.jsx)(n.Suspense,{fallback:(0,t.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-4 mb-4 animate-pulse",children:(0,t.jsx)("div",{className:"h-64 bg-gray-200 rounded"})}),children:(0,t.jsx)(b,{isMobile:rT,ordersChartData:rg})}),(0,t.jsx)(n.Suspense,{fallback:(0,t.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-4 mb-4 animate-pulse",children:(0,t.jsx)("div",{className:"h-64 bg-gray-200 rounded"})}),children:(0,t.jsx)(f,{chartOrderData:rv,isMobile:rT})}),(0,t.jsx)(n.Suspense,{fallback:(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-4 mb-4 animate-pulse",children:[(0,t.jsx)("div",{className:"h-5 bg-gray-200 rounded w-1/4 mb-4"}),(0,t.jsx)("div",{className:"space-y-2",children:[1,2,3,4,5,6,7,8,9,10].map(e=>(0,t.jsx)("div",{className:"h-8 bg-gray-200 rounded"},e))})]}),children:(0,t.jsx)(y,{storeOrderTableData:rx,totalOrderSumAll:rb})}),(0,t.jsx)(n.Suspense,{fallback:(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 mb-4",children:[1,2,3,4,5].map(e=>(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-4 animate-pulse",children:[(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),(0,t.jsx)("div",{className:"h-6 bg-gray-200 rounded w-1/2"})]},e))}),children:(0,t.jsx)(N,{data:eK,loading:eV,error:eE})})]})]})}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},68274:(e,r,a)=>{Promise.resolve().then(a.bind(a,11965))},70212:(e,r,a)=>{"use strict";a.d(r,{V:()=>n,e:()=>s});var t=a(43210);function n(e,r){let[a,n]=(0,t.useState)(r),[s,l]=(0,t.useState)(!1);return[a,n,s]}function s(e){}a(18411)},79551:e=>{"use strict";e.exports=require("url")},89315:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>n});var t=a(37413);function n(){return(0,t.jsx)("div",{className:"p-2 sm:p-4 md:p-6 max-w-full",children:(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsxs)("div",{className:"p-2",children:[(0,t.jsx)("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-900 mb-2",children:"Order Report"}),(0,t.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-4 mb-4",children:(0,t.jsxs)("div",{className:"animate-pulse",children:[(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/4 mb-4"}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,t.jsx)("div",{className:"h-10 bg-gray-200 rounded w-32"}),(0,t.jsx)("div",{className:"h-10 bg-gray-200 rounded w-32"}),(0,t.jsx)("div",{className:"h-10 bg-gray-200 rounded w-32"}),(0,t.jsx)("div",{className:"h-10 bg-gray-200 rounded w-32"})]})]})}),[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15].map(e=>(0,t.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-4 mb-4",children:(0,t.jsxs)("div",{className:"animate-pulse",children:[(0,t.jsx)("div",{className:"h-5 bg-gray-200 rounded w-1/3 mb-4"}),(0,t.jsx)("div",{className:"h-64 bg-gray-200 rounded"})]})},e)),(0,t.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-4 mb-4",children:(0,t.jsxs)("div",{className:"animate-pulse",children:[(0,t.jsx)("div",{className:"h-5 bg-gray-200 rounded w-1/4 mb-4"}),(0,t.jsx)("div",{className:"space-y-2",children:[1,2,3,4,5,6,7,8,9,10].map(e=>(0,t.jsx)("div",{className:"h-8 bg-gray-200 rounded"},e))})]})}),(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 mb-4",children:[1,2,3,4,5].map(e=>(0,t.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-4",children:(0,t.jsxs)("div",{className:"animate-pulse",children:[(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),(0,t.jsx)("div",{className:"h-6 bg-gray-200 rounded w-1/2"})]})},e))})]})})})}a(61120)},94145:(e,r,a)=>{"use strict";a.r(r),a.d(r,{GlobalError:()=>l.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>h,tree:()=>d});var t=a(65239),n=a(48088),s=a(88170),l=a.n(s),o=a(30893),i={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>o[e]);a.d(r,i);let d={children:["",{children:["orders",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,11965)),"/Users/lehoanganh/Documents/FB Network/FE/src/app/orders/page.tsx"]}]},{loading:[()=>Promise.resolve().then(a.bind(a,89315)),"/Users/lehoanganh/Documents/FB Network/FE/src/app/orders/loading.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,94431)),"/Users/lehoanganh/Documents/FB Network/FE/src/app/layout.tsx"],loading:[()=>Promise.resolve().then(a.bind(a,67393)),"/Users/lehoanganh/Documents/FB Network/FE/src/app/loading.tsx"],"not-found":[()=>Promise.resolve().then(a.bind(a,54413)),"/Users/lehoanganh/Documents/FB Network/FE/src/app/not-found.tsx"],forbidden:[()=>Promise.resolve().then(a.t.bind(a,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(a.t.bind(a,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/Users/lehoanganh/Documents/FB Network/FE/src/app/orders/page.tsx"],u={require:a,loadChunk:()=>Promise.resolve()},h=new t.AppPageRouteModule({definition:{kind:n.RouteKind.APP_PAGE,page:"/orders/page",pathname:"/orders",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})}};var r=require("../../webpack-runtime.js");r.C(e);var a=e=>r(r.s=e),t=r.X(0,[4447,4587,9761,6888],()=>a(94145));module.exports=t})();