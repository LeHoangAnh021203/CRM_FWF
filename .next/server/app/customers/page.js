(()=>{var e={};e.id=5812,e.ids=[5812],e.modules={506:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/lehoanganh/Documents/FB Network/FE/src/app/customers/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/lehoanganh/Documents/FB Network/FE/src/app/customers/page.tsx","default")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},51436:(e,t,s)=>{Promise.resolve().then(s.bind(s,88890))},61678:(e,t,s)=>{"use strict";s.d(t,{b:()=>i});var r=s(43210),a=s(49605),n=s(54024),l=["axis"],i=(0,r.forwardRef)((e,t)=>r.createElement(n.P,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:l,tooltipPayloadSearcher:a.uN,categoricalChartProps:e,ref:t}))},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},64588:(e,t,s)=>{Promise.resolve().then(s.bind(s,506))},79551:e=>{"use strict";e.exports=require("url")},88890:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>P});var r=s(60687),a=s(43210),n=s.n(a),l=s(18411),i=s(67763),d=s(7562);let o=({allHourRanges:e,facilityHourTableData:t,getCellBg:s,isMobile:a,loadingFacilityHour:n,errorFacilityHour:l})=>(0,r.jsxs)("div",{className:"w-full bg-white rounded-xl shadow-lg p-4 mt-5",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mt-5 gap-4",children:[(0,r.jsx)("h2",{className:"text-lg sm:text-xl font-semibold",children:"Thời gian đơn h\xe0ng được tạo"}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2 text-xs mt-2 sm:mt-0",children:[(0,r.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded bg-[#68B2A0] text-white",children:"Cao điểm (≥50 đơn)"}),(0,r.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded bg-[#CDE0C9]",children:"Bận rộn (≥35 đơn)"}),(0,r.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded bg-[#E0ECDE]",children:"Kh\xe1 bận (≥25 đơn)"}),(0,r.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded bg-[#F0F8F0]",children:"\xcdt bận (≤15 đơn)"})]})]}),n?(0,r.jsx)("div",{children:"Đang tải dữ liệu..."}):l?(0,r.jsx)("div",{className:"text-red-500",children:l}):(0,r.jsx)("div",{className:"overflow-x-auto mt-4 custom-scrollbar",children:(0,r.jsx)("div",{className:"max-h-[420px] overflow-y-auto custom-scrollbar",children:(0,r.jsx)("div",{className:"max-h-[420px] overflow-y-auto",children:(0,r.jsxs)("table",{className:`min-w-[600px] w-full border text-center ${a?"text-xs":""}`,children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:`border px-2 py-1 bg-[#2C6975] text-white text-left font-bold 
        ${a?"text-xs":""} sticky left-0 top-0 z-20`,children:"Cơ sở"}),e.map(e=>(0,r.jsx)("th",{className:`border px-2 py-1 font-bold text-sm bg-[#2C6975] text-white 
          ${a?"text-xs px-1 py-0.5":""} sticky top-0 z-10`,children:e},e)),(0,r.jsx)("th",{className:`border px-2 py-1 bg-[#2C6975] text-white font-bold 
        ${a?"text-xs":""} sticky right-0 top-0 z-20`,children:"Tổng"})]})}),(0,r.jsxs)("tbody",{children:[t.map(t=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:`border px-2 py-1 text-left font-semibold ${a?"text-xs px-1 py-0.5":""} sticky left-0 z-10 bg-gray-50`,children:t.facility}),e.map(e=>{let n=Number(t[e]??0);return(0,r.jsx)("td",{className:`border px-2 py-1 ${s(n)} ${a?"text-xs px-1 py-0.5":""}`,children:n},e)}),(0,r.jsx)("td",{className:`border px-2 py-1 font-bold ${a?"text-xs px-1 py-0.5":""} sticky right-0 z-10 bg-gray-100`,children:t.total})]},t.facility)),(0,r.jsxs)("tr",{className:"bg-gray-200 font-bold sticky bottom-0 z-10",children:[(0,r.jsx)("td",{className:`border px-2 py-1 text-left ${a?"text-xs px-1 py-0.5":""} 
      sticky left-0 bottom-0 bg-gray-200 z-20`,children:"TỔNG CỘNG"}),e.map(e=>{let n=t.reduce((t,s)=>t+Number(s[e]??0),0);return(0,r.jsx)("td",{className:`border px-2 py-1 ${s(n)} 
          ${a?"text-xs px-1 py-0.5":""} sticky bottom-0 bg-gray-200`,children:n},e)}),(0,r.jsx)("td",{className:`border px-2 py-1 ${a?"text-xs px-1 py-0.5":""} 
      sticky right-0 bottom-0 bg-gray-200`,children:t.reduce((e,t)=>e+Number(t.total??0),0)})]})]})]})})})})]});var c=s(11763);let x=({mainValue:e,mainLabel:t,mainPercentChange:s,maleValue:n,malePercentChange:l,femaleValue:i,femalePercentChange:d,avgRevenueMale:o,avgServiceMale:c,avgRevenueFemale:x,avgServiceFemale:m,loading:h,error:u})=>{let[g,p]=(0,a.useState)(!1),[f,b]=(0,a.useState)(!1),[j,v]=(0,a.useState)(!1);return(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[(0,r.jsxs)("div",{className:"p-4 lg:p-6 flex flex-col items-center cursor-pointer hover:bg-gray-50 transition-colors mb-5",onClick:()=>p(!g),children:[(0,r.jsx)("div",{className:"text-sm lg:text-xl text-gray-700 mb-2 text-center font-semibold",children:t}),(0,r.jsx)("div",{className:"text-3xl lg:text-5xl font-bold text-[#f66035] mb-2",children:h?(0,r.jsx)("span",{children:"Đang tải dữ liệu..."}):u?(0,r.jsx)("span",{className:"text-red-500",children:u}):(0,r.jsxs)(r.Fragment,{children:[e," ",(0,r.jsx)("span",{className:"text-lg lg:text-2xl",children:"kh\xe1ch"})]})}),void 0!==s&&!h&&!u&&(0,r.jsxs)("div",{className:`text-base lg:text-xl font-semibold ${s>0?"text-green-600":s<0?"text-red-500":"text-gray-500"}`,children:[s>0?"↑":s<0?"↓":""," ",Math.abs(s).toFixed(2),"%"]}),(0,r.jsx)("div",{className:"mt-2 text-xl text-green-600 transition-transform duration-200",children:g?"⌃":"⌄"})]}),g&&(0,r.jsxs)("div",{className:"flex justify-center items-center border-t border-gray-200",children:[(0,r.jsxs)("div",{className:"w-1/2 p-4 border-r border-gray-100",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center cursor-pointer hover:bg-gray-50 p-2 rounded transition-colors",onClick:()=>b(!f),children:[(0,r.jsxs)("div",{className:"flex gap-2 justify-center items-center",children:[(0,r.jsx)("div",{className:"text-lg font-semibold text-gray-800",children:"Lượt kh\xe1ch nam thực đi"}),(0,r.jsxs)("div",{className:"text-2xl font-bold text-blue-600",children:[n?.toLocaleString()??0," ",(0,r.jsx)("span",{className:"text-sm",children:"kh\xe1ch"})]}),void 0!==l&&(0,r.jsxs)("div",{className:`text-sm font-semibold ${l>0?"text-green-600":l<0?"text-red-500":"text-gray-500"}`,children:[l>0?"↑":l<0?"↓":""," ",Math.abs(l).toFixed(2),"%"]})]}),(0,r.jsx)("div",{className:"flex items-center justify-center text-lg text-blue-600 transition-transform duration-200",children:f?"⌃":"⌄"})]}),f&&(0,r.jsx)("div",{className:"mt-4 pl-4 border-l-2 border-blue-200",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg",children:[(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Trung b\xecnh đơn thực thu nam"}),(0,r.jsxs)("div",{className:"text-lg font-bold text-blue-700",children:[o?.toLocaleString()??0," ",(0,r.jsx)("span",{className:"text-sm",children:"VNĐ"})]})]}),(0,r.jsxs)("div",{className:"bg-green-50 p-3 rounded-lg",children:[(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Trung b\xecnh đơn dịch vụ nam"}),(0,r.jsxs)("div",{className:"text-lg font-bold text-green-700",children:[c?.toLocaleString()??0," ",(0,r.jsx)("span",{className:"text-sm",children:"VNĐ"})]})]})]})})]}),(0,r.jsxs)("div",{className:"w-1/2 p-4 border-l border-gray-100",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center cursor-pointer hover:bg-gray-50 p-2 rounded transition-colors",onClick:()=>v(!j),children:[(0,r.jsxs)("div",{className:"flex gap-2 justify-center items-center",children:[(0,r.jsx)("div",{className:"text-lg font-semibold text-gray-800",children:"Lượt kh\xe1ch nữ thực đi"}),(0,r.jsxs)("div",{className:"text-2xl font-bold text-pink-600",children:[i?.toLocaleString()??0," ",(0,r.jsx)("span",{className:"text-sm",children:"kh\xe1ch"})]}),void 0!==d&&(0,r.jsxs)("div",{className:`text-sm font-semibold ${d>0?"text-green-600":d<0?"text-red-500":"text-gray-500"}`,children:[d>0?"↑":d<0?"↓":""," ",Math.abs(d).toFixed(2),"%"]})]}),(0,r.jsx)("div",{className:"flex items-center justify-center text-lg text-pink-600 transition-transform duration-200",children:j?"⌃":"⌄"})]}),j&&(0,r.jsx)("div",{className:"mt-4 pl-4 border-l-2 border-pink-200",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"bg-pink-50 p-3 rounded-lg",children:[(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Trung b\xecnh đơn thực thu nữ"}),(0,r.jsxs)("div",{className:"text-lg font-bold text-pink-700",children:[x?.toLocaleString()??0," ",(0,r.jsx)("span",{className:"text-sm",children:"VNĐ"})]})]}),(0,r.jsxs)("div",{className:"bg-purple-50 p-3 rounded-lg",children:[(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Trung b\xecnh đơn dịch vụ nữ"}),(0,r.jsxs)("div",{className:"text-lg font-bold text-purple-700",children:[m?.toLocaleString()??0," ",(0,r.jsx)("span",{className:"text-sm",children:"VNĐ"})]})]})]})})]})]})]})};var m=s(48482),h=s(61678),u=s(85168),g=s(27747),p=s(19598),f=s(23812),b=s(15202),j=s(83446),v=s(56651),y=s(56988),w=s(25679);let N=({isMobile:e,loadingNewCustomer:t,errorNewCustomer:s,newCustomerChartData:a,loadingGenderRatio:n,errorGenderRatio:l,genderRatioData:i,COLORS:d})=>(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row w-full gap-4 lg:gap-4",children:[(0,r.jsx)("div",{className:`bg-white rounded-xl shadow p-2 ${e?"w-full flex justify-center items-center mx-auto":"lg:w-1/2"} ${e?"max-w-xs":""}`,style:{minWidth:e?220:void 0},children:(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsx)("h2",{className:"text-base lg:text-xl text-center font-semibold text-gray-800 mb-2",children:"Số kh\xe1ch tạo mới"}),t?(0,r.jsx)("div",{children:"Đang tải dữ liệu..."}):s?(0,r.jsx)("div",{className:"text-red-500",children:s}):(0,r.jsx)(m.u,{width:"100%",height:e?220:350,minWidth:220,children:(0,r.jsxs)(h.b,{data:a,margin:{top:e?10:30,right:10,left:10,bottom:e?20:40},children:[(0,r.jsx)(u.d,{stroke:"#e5e7eb",strokeDasharray:"5 5"}),(0,r.jsx)(g.W,{dataKey:"date",stroke:"#6b7280",fontSize:e?10:12,tickLine:!1,axisLine:{stroke:"#d1d5db"},angle:e?-20:0,textAnchor:e?"end":"middle",height:e?40:60,tickFormatter:e=>{if(!e)return"";let t=String(e).match(/^\d{4}-(\d{2})-(\d{2})$/);if(t){let[,e,s]=t;return`${s}/${e}`}return String(e)},tick:t=>{let{x:s,y:a,payload:n}=t,l=n.value,i=(()=>{if(!l)return!1;let e=String(l).match(/^(\d{4})-(\d{2})-(\d{2})$/);if(e){let[,t,s,r]=e,a=new Date(parseInt(t),parseInt(s)-1,parseInt(r)).getDay();return 0===a||6===a}return!1})();return(0,r.jsx)("g",{transform:`translate(${s},${a})`,children:(0,r.jsx)("text",{x:0,y:0,dy:16,textAnchor:"middle",fill:i?"#dc2626":"#6b7280",fontSize:e?10:12,fontWeight:i?"bold":"normal",children:n.value?(()=>{let e=String(n.value).match(/^\d{4}-(\d{2})-(\d{2})$/);if(e){let[,t,s]=e;return`${s}/${t}`}return String(n.value)})():""})})}}),(0,r.jsx)(p.h,{stroke:"#6b7280",fontSize:e?10:12,tickLine:!1,axisLine:{stroke:"#d1d5db"},tickFormatter:e=>e>0?`${e} `:e,padding:{bottom:10,top:10}}),(0,r.jsx)(f.m,{}),(0,r.jsx)(b.s,{wrapperStyle:{paddingTop:e?0:"20px",fontSize:e?"10px":"14px",color:"#4b5563",display:e?"none":void 0},iconType:"circle",iconSize:e?8:10}),(0,r.jsx)(j.N,{type:"natural",dataKey:"value",name:"Số kh\xe1ch mới trong hệ thống",stroke:"#5bd1d7",strokeWidth:2,dot:!1,activeDot:{r:6,fill:"#5bd1d7",stroke:"#fff",strokeWidth:2},animationDuration:1500}),(0,r.jsx)(j.N,{type:"natural",dataKey:"value2",name:"Số kh\xe1ch mới trong hệ thống (kỳ trước)",stroke:"#eb94cf",strokeWidth:2,dot:!1,activeDot:{r:6,fill:"#eb94cf",stroke:"#fff",strokeWidth:2},animationDuration:1500})]})})]})}),(0,r.jsxs)("div",{className:`bg-white rounded-xl shadow p-2 ${e?"w-full max-w-xs mx-auto flex flex-col items-center":"lg:w-1/2"}`,style:{minWidth:e?220:void 0},children:[(0,r.jsx)("h2",{className:"text-base lg:text-xl font-semibold text-gray-800 mb-2 text-center",children:"Tỷ lệ nam/nữ kh\xe1ch mới tạo"}),(0,r.jsx)("div",{className:"w-full flex justify-center",children:n?(0,r.jsx)("div",{children:"Loading..."}):l?(0,r.jsx)("div",{className:"text-red-500",children:l}):(0,r.jsx)(m.u,{width:"100%",height:e?180:350,minWidth:220,children:(0,r.jsxs)(v.r,{children:[(0,r.jsx)(y.F,{data:i,cx:"50%",cy:"50%",innerRadius:"0%",outerRadius:e?"40%":"80%",fill:"#f933347",dataKey:"count",nameKey:"gender",labelLine:!1,label:({cx:t=0,cy:s=0,midAngle:a=0,innerRadius:n=0,outerRadius:l=0,percent:i=0,gender:o="",index:c=0})=>{let x=Math.PI/180,m=(n+l)/.8,h=t+m*Math.cos(-a*x),u=s+m*Math.sin(-a*x);return(0,r.jsx)("text",{x:h,y:u,fill:d[c%d.length],fontSize:e?12:16,textAnchor:h>t?"start":"end",dominantBaseline:"central",fontWeight:600,children:`${o}: ${(100*i).toFixed(1)}%`})},children:i.map((e,t)=>(0,r.jsx)(w.f,{fill:d[t%d.length]},e.gender))}),(0,r.jsx)(f.m,{}),(0,r.jsx)(b.s,{wrapperStyle:{paddingTop:e?0:"20px",fontSize:e?"10px":"14px",color:"#4b5563",display:e?"none":void 0},iconType:"circle",iconSize:e?8:10})]})})})]})]}),S=({loadingCustomerSummary:e,errorCustomerSummary:t,customerSummaryRaw:s})=>(0,r.jsxs)("div",{className:"flex flex-col md:flex-row gap-2 md:gap-4 mt-4",children:[(0,r.jsxs)("div",{className:"flex-1 bg-white rounded-xl shadow-lg p-6 flex flex-col items-center justify-center",children:[(0,r.jsx)("div",{className:"text-xl font-medium text-gray-700 mb-2 text-center",children:"Tổng số kh\xe1ch mới trong hệ thống"}),(0,r.jsx)("div",{className:"text-5xl font-bold text-black mb-2",children:e?(0,r.jsx)("span",{children:"Đang tải dữ liệu..."}):t?(0,r.jsx)("span",{className:"text-red-500",children:t}):s?.totalNewCustomers?.toLocaleString()??0}),!e&&!t&&s?.growthTotal!==void 0&&(0,r.jsxs)("div",{className:`flex items-center gap-1 text-sm font-medium ${s.growthTotal>=0?"text-green-600":"text-red-600"}`,children:[(0,r.jsx)("span",{children:s.growthTotal>=0?"↗":"↘"}),(0,r.jsxs)("span",{children:[Math.abs(s.growthTotal).toFixed(1),"%"]}),(0,r.jsx)("span",{className:"text-gray-500",children:"so với kỳ trước"})]})]}),(0,r.jsxs)("div",{className:"flex-1 bg-white rounded-xl shadow-lg p-6 flex flex-col items-center justify-center",children:[(0,r.jsx)("div",{className:"text-xl font-medium text-gray-700 mb-2 text-center",children:"Tổng số kh\xe1ch mới thực đi"}),(0,r.jsx)("div",{className:"text-5xl font-bold text-black mb-2",children:e?(0,r.jsx)("span",{children:"Đang tải dữ liệu..."}):t?(0,r.jsx)("span",{className:"text-red-500",children:t}):s?.actualCustomers?.toLocaleString()??0}),!e&&!t&&s?.growthActual!==void 0&&(0,r.jsxs)("div",{className:`flex items-center gap-1 text-sm font-medium ${s.growthActual>=0?"text-green-600":"text-red-600"}`,children:[(0,r.jsx)("span",{children:s.growthActual>=0?"↗":"↘"}),(0,r.jsxs)("span",{children:[Math.abs(s.growthActual).toFixed(1),"%"]}),(0,r.jsx)("span",{className:"text-gray-500",children:"so với kỳ trước"})]})]})]}),k=({isMobile:e,customerTypeTrendData:t,customerTypeKeys:s,COLORS:a})=>(0,r.jsxs)("div",{className:`bg-white pt-2 mt-5 rounded-xl shadow-lg ${e?"w-full max-w-xs mx-auto flex flex-col items-center":""}`,style:{minWidth:e?220:void 0},children:[(0,r.jsx)("h2",{className:"text-base lg:text-xl text-center font-semibold text-gray-800 p-3",children:"Số kh\xe1ch tới chia theo loại"}),(0,r.jsx)("div",{className:"w-full flex justify-center",children:(0,r.jsx)(m.u,{width:"100%",height:e?180:350,minWidth:220,children:(0,r.jsxs)(h.b,{data:t,margin:{top:e?10:30,right:10,left:10,bottom:e?20:40},children:[(0,r.jsx)(u.d,{stroke:"#e5e7eb",strokeDasharray:"5 5"}),(0,r.jsx)(g.W,{dataKey:"date",stroke:"#6b7280",fontSize:e?10:12,tickLine:!1,axisLine:{stroke:"#d1d5db"},angle:e?-20:0,textAnchor:e?"end":"middle",height:e?40:60,tickFormatter:e=>{if(!e)return"";let t=String(e).match(/^\d{4}-(\d{2})-(\d{2})$/);if(t){let[,e,s]=t;return`${s}/${e}`}return String(e)},tick:t=>{let{x:s,y:a,payload:n}=t,l=n.value,i=(()=>{if(!l)return!1;let e=String(l).match(/^(\d{4})-(\d{2})-(\d{2})$/);if(e){let[,t,s,r]=e,a=new Date(parseInt(t),parseInt(s)-1,parseInt(r)).getDay();return 0===a||6===a}return!1})();return(0,r.jsx)("g",{transform:`translate(${s},${a})`,children:(0,r.jsx)("text",{x:0,y:0,dy:16,textAnchor:"middle",fill:i?"#dc2626":"#6b7280",fontSize:e?10:12,fontWeight:i?"bold":"normal",children:n.value?(()=>{let e=String(n.value).match(/^\d{4}-(\d{2})-(\d{2})$/);if(e){let[,t,s]=e;return`${s}/${t}`}return String(n.value)})():""})})}}),(0,r.jsx)(p.h,{stroke:"#6b7280",fontSize:e?10:12,tickLine:!1,axisLine:{stroke:"#d1d5db"},tickFormatter:e=>e>0?`${e} kh\xe1ch`:e,padding:{bottom:10,top:10}}),(0,r.jsx)(f.m,{}),(0,r.jsx)(b.s,{wrapperStyle:{paddingTop:e?"":"20px",fontSize:e?"10px":"14px",color:"#4b5563",display:"flex",flexDirection:e?"column":"row",alignItems:"center",justifyContent:"center",flexWrap:e?"nowrap":"wrap",width:"100%",maxHeight:e?80:void 0,overflowY:e?"auto":void 0},iconType:"circle",iconSize:e?8:10,verticalAlign:e?"bottom":void 0}),s.map((e,t)=>(0,r.jsx)(j.N,{type:"natural",dataKey:e,name:e,stroke:a[t%a.length],strokeWidth:2,dot:!1,activeDot:{r:6,fill:a[t%a.length],stroke:"#fff",strokeWidth:2},animationDuration:1500},e))]})})})]});var $=s(2041),D=s(515);let C=({isMobile:e,customerSourceTrendData:t,customerSourceKeys:s,COLORS:a})=>(0,r.jsxs)("div",{className:"w-full bg-white rounded-xl shadow-lg mt-5",children:[(0,r.jsx)("div",{className:"text-xl font-medium text-gray-700 text-center pt-5",children:"Nguồn của đơn h\xe0ng"}),(0,r.jsx)("div",{className:"w-full bg-white rounded-xl shadow-lg",children:(0,r.jsx)(m.u,{width:"100%",height:e?220:350,minWidth:e?180:320,children:(0,r.jsxs)($.E,{data:t,margin:{top:e?20:50,right:10,left:10,bottom:e?20:40},children:[(0,r.jsx)(u.d,{strokeDasharray:"3 3"}),(0,r.jsx)(g.W,{dataKey:"date",fontSize:e?9:12,tickFormatter:e=>{let t=e.match(/^\d{4}-(\d{2})-(\d{2})$/);if(t){let[,e,s]=t;return`${s}/${e}`}return e},tick:t=>{let{x:s,y:a,payload:n}=t,l=n.value,i=(()=>{if(!l)return!1;let e=String(l).match(/^(\d{4})-(\d{2})-(\d{2})$/);if(e){let[,t,s,r]=e,a=new Date(parseInt(t),parseInt(s)-1,parseInt(r)).getDay();return 0===a||6===a}return!1})();return(0,r.jsx)("g",{transform:`translate(${s},${a})`,children:(0,r.jsx)("text",{x:0,y:0,dy:16,textAnchor:"middle",fill:i?"#dc2626":"#6b7280",fontSize:e?9:12,fontWeight:i?"bold":"normal",children:n.value?(()=>{let e=String(n.value).match(/^\d{4}-(\d{2})-(\d{2})$/);if(e){let[,t,s]=e;return`${s}/${t}`}return String(n.value)})():""})})}}),(0,r.jsx)(p.h,{fontSize:e?9:12}),(0,r.jsx)(f.m,{}),(0,r.jsx)(b.s,{wrapperStyle:{paddingTop:5*!e,paddingBottom:10*!e,display:"flex",justifyContent:"center",flexWrap:"wrap",width:"100%",fontSize:e?9:14}}),s.map((n,l)=>(0,r.jsx)(D.y,{dataKey:n,fill:a[l%a.length],name:n,label:e?void 0:e=>{let{x:n,y:i,width:d,value:o,index:c}=e;if("number"!=typeof c||c<0||"number"!=typeof n||"number"!=typeof i||"number"!=typeof d)return(0,r.jsx)("g",{});let x=t[c];return x&&o===Math.max(...s.map(e=>Number(x[e]||0)))&&o>0?(0,r.jsx)("text",{x:n+d/2,y:i-5,textAnchor:"middle",fill:a[l%a.length],fontSize:14,fontWeight:600,children:o}):(0,r.jsx)("g",{})}},n))]})})})]}),T=({isMobile:e,loading:t,error:s,sortedAppDownloadStatusData:a})=>(0,r.jsxs)("div",{className:"w-full bg-white rounded-xl shadow-lg mt-4 lg:mt-5",children:[(0,r.jsx)("div",{className:"text-lg lg:text-xl font-medium text-gray-700 text-center pt-6 lg:pt-10",children:"Kh\xe1ch tải app/kh\xf4ng tải"}),(0,r.jsx)("div",{className:"flex justify-center items-center py-4 lg:py-8",children:t?(0,r.jsx)("div",{children:"Đang tải dữ liệu..."}):s?(0,r.jsx)("div",{className:"text-red-500",children:s}):(0,r.jsx)(m.u,{width:"100%",height:e?220:300,minWidth:e?180:320,children:(0,r.jsxs)($.E,{data:a,children:[(0,r.jsx)(u.d,{strokeDasharray:"3 3"}),(0,r.jsx)(g.W,{dataKey:"date",fontSize:e?9:12,tickFormatter:e=>{if(!e)return"";let t=String(e).match(/^(\d{4})-(\d{2})-(\d{2})/);if(t){let[,,e,s]=t;return`${s}/${e}`}let s=String(e).match(/^(\d{2})\/(\d{2})(?:\/\d{4})?$/);return s?`${s[1]}/${s[2]}`:"string"==typeof e&&e.length>=10?e.slice(8,10)+"/"+e.slice(5,7):e},tick:t=>{let{x:s,y:a,payload:n}=t,l=n.value,i=(()=>{if(!l)return!1;let e=String(l).match(/^(\d{4})-(\d{2})-(\d{2})/);if(e){let[,t,s,r]=e,a=new Date(parseInt(t),parseInt(s)-1,parseInt(r)).getDay();return 0===a||6===a}if(e=String(l).match(/^(\d{2})\/(\d{2})\/(\d{4})$/)){let[,t,s,r]=e,a=new Date(parseInt(r),parseInt(s)-1,parseInt(t)).getDay();return 0===a||6===a}return!1})();return(0,r.jsx)("g",{transform:`translate(${s},${a})`,children:(0,r.jsx)("text",{x:0,y:0,dy:16,textAnchor:"middle",fill:i?"#dc2626":"#6b7280",fontSize:e?9:12,fontWeight:i?"bold":"normal",children:n.value?(()=>{let e=String(n.value).match(/^(\d{4})-(\d{2})-(\d{2})/);if(e){let[,,t,s]=e;return`${s}/${t}`}let t=String(n.value).match(/^(\d{2})\/(\d{2})(?:\/\d{4})?$/);return t?`${t[1]}/${t[2]}`:"string"==typeof n.value&&n.value.length>=10?n.value.slice(8,10)+"/"+n.value.slice(5,7):String(n.value)})():""})})}}),(0,r.jsx)(p.h,{allowDecimals:!1,fontSize:e?9:12}),(0,r.jsx)(f.m,{}),(0,r.jsx)(b.s,{fontSize:e?9:12}),(0,r.jsx)(D.y,{dataKey:"downloaded",fill:"#9ee347",name:"Đ\xe3 tải app",label:e?void 0:{position:"top",fontSize:14,fontWeight:600,fill:"#9ee347"}}),(0,r.jsx)(D.y,{dataKey:"notDownloaded",fill:"#f0bf4c",name:"Chưa tải app",label:e?void 0:{position:"top",fontSize:14,fontWeight:600,fill:"#f0bf4c"}})]})})})]}),F=["#ff7f7f","#b39ddb","#8d6e63","#c5e1a5","#81d4fa","#f0bf4c","#bccefb","#a9b8c3"],E=({appDownloadPieData:e,loadingAppDownload:t,errorAppDownload:s})=>{let[a,l]=n().useState(!1);return n().useEffect(()=>{let e=()=>{l(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,r.jsxs)("div",{className:"w-full bg-white rounded-xl shadow-lg mt-5 p-2 sm:p-4",children:[(0,r.jsx)("div",{className:"text-sm sm:text-base md:text-xl font-medium text-gray-700 text-center mb-4",children:"Tỷ lệ tải app"}),(0,r.jsx)("div",{className:"w-full flex justify-center ",children:t?(0,r.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,r.jsx)("div",{className:"text-gray-500",children:"Đang tải dữ liệu..."})}):s?(0,r.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,r.jsx)("div",{className:"text-red-500",children:s})}):(0,r.jsx)(m.u,{width:"100%",height:a?250:400,minWidth:280,children:(0,r.jsxs)(v.r,{children:[(0,r.jsx)(y.F,{data:e,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",innerRadius:a?"25%":"30%",outerRadius:a?"50%":"60%",label:({percent:e})=>e&&e>.05?`${(100*e).toFixed(0)}%`:"",labelLine:!1,children:e.map((e,t)=>(0,r.jsx)(w.f,{fill:F[t%F.length]},e.name))}),(0,r.jsx)(f.m,{formatter:e=>[e.toLocaleString(),"Số lượng"],contentStyle:{fontSize:a?12:14,backgroundColor:"rgba(255, 255, 255, 0.95)",border:"1px solid #ccc",borderRadius:"4px",padding:"8px"}}),(0,r.jsx)(b.s,{wrapperStyle:{fontSize:a?10:12,paddingTop:a?10:20,display:"flex",justifyContent:"center",flexWrap:"wrap",width:"100%"},layout:"horizontal",verticalAlign:"bottom",align:"center"})]})})})]})};var z=s(13193),R=s(70212),M=s(34276);let A="https://c68783755745.ngrok-free.app";function L(e){return e instanceof l.ng?e:e&&"object"==typeof e&&"year"in e&&"month"in e&&"day"in e?new l.ng(e.year,e.month,e.day):(0,i.Ec)((0,i.Xj)())}function W(e,t,s){let[r,n]=(0,a.useState)(null),[l,i]=(0,a.useState)(!0),[d,o]=(0,a.useState)(null);return{data:r,loading:l,error:d}}function P(){let{notification:e,showSuccess:t,showError:s,hideNotification:l}=(0,z.h)();(0,a.useRef)(!1),(0,a.useRef)(!1);let{reportPageError:m,reportDataLoadSuccess:h,reportFilterChange:u,reportResetFilters:g,reportPagePerformance:p}=(0,M.n)("customers"),[f,b]=(0,R.V)("customer-selectedType",[]),[j,v]=(0,R.V)("customer-selectedStatus",null),[y,w]=(0,a.useState)(!1),[$,D]=(0,a.useState)(!1),[F,P]=(0,R.V)("customer-startDate",(0,i.Ec)((0,i.Xj)()).subtract({days:7})),[K,B]=(0,R.V)("customer-endDate",(0,i.Ec)((0,i.Xj)())),[I,O]=(0,R.V)("customer-selectedRegions",[]),[V,_]=(0,a.useState)(!1),[q,G]=(0,R.V)("customer-selectedBranches",[]),[U,H]=(0,a.useState)(!1),X=["#5bd1d7","#eb94cf","#f66035","#00d084","#9b51e0","#0693e3","#ff7f7f","#b39ddb","#8d6e63","#c5e1a5","#81d4fa","#fff176","#d81b60"],Y=L(F),Z=L(K),J=`${Y.year}-${String(Y.month).padStart(2,"0")}-${String(Y.day).padStart(2,"0")}T00:00:00`,Q=`${Z.year}-${String(Z.month).padStart(2,"0")}-${String(Z.day).padStart(2,"0")}T23:59:59`,{data:ee,loading:et,error:es}=W(`${A}/api/customer-sale/new-customer-lineChart`,J,Q),{data:er,loading:ea,error:en}=W(`${A}/api/customer-sale/gender-ratio`,J,Q),{data:el}=W(`${A}/api/customer-sale/customer-type-trend`,J,Q),{data:ei}=W(`${A}/api/customer-sale/customer-source-trend`,J,Q),{data:ed,loading:eo,error:ec}=W(`${A}/api/customer-sale/app-download-status`,J,Q),{data:ex,loading:em,error:eh}=W(`${A}/api/customer-sale/app-download-pieChart`,J,Q),{data:eu,loading:eg,error:ep}=W(`${A}/api/customer-sale/customer-summary`,J,Q),{data:ef,loading:eb,error:ej}=W(`${A}/api/customer-sale/gender-revenue`,J,Q),{data:ev}=W(`${A}/api/customer-sale/unique-customers-comparison`,J,Q),{data:ey,loading:ew,error:eN}=W(`${A}/api/customer-sale/facility-hour-service`,J,Q),eS=[es,en,ec,eh,ep,ej,eN];[et,ea,eo,em,eg,eb,ew].some(e=>e),eS.some(e=>e);let ek=n().useMemo(()=>{if(!ee)return[];let e=Array.isArray(ee.currentRange)?ee.currentRange:[],t=Array.isArray(ee.previousRange)?ee.previousRange:[];return e.map((e,s)=>({date:e.date||"",value:e.count,value2:t[s]?.count??0}))},[ee]),e$=n().useMemo(()=>er?[{gender:"Nam",count:er.male||0},{gender:"Nữ",count:er.female||0}]:[],[er]),eD=n().useMemo(()=>{if(!el)return[];let e=new Set;Object.values(el).forEach(t=>{t.forEach(t=>{e.add(t.date.slice(0,10))})});let t=Array.from(e).sort(),s=Object.keys(el);return t.map(e=>{let t={date:String(e)};return s.forEach(s=>{let r=el[s].find(t=>t.date.slice(0,10)===e);t[s]=r?r.count:0}),t})},[el]),eC=n().useMemo(()=>{if(!ei)return[];let e=new Set;Object.values(ei).forEach(t=>{t.forEach(t=>{e.add(t.date.slice(0,10))})});let t=Array.from(e).sort(),s=Object.keys(ei);return t.map(e=>{let t={date:String(e)};return s.forEach(s=>{let r=ei[s].find(t=>t.date.slice(0,10)===e);t[s]=r?r.count:0}),t})},[ei]),eT=n().useMemo(()=>ed?Object.values(ed).flat():[],[ed]),eF=n().useMemo(()=>ex?[{name:"Đ\xe3 tải app",value:ex.totalNew||0},{name:"Chưa tải app",value:ex.totalOld||0}]:[],[ex]),eE=640>function(){let[e,t]=(0,a.useState)(1024);return e}(),ez=n().useMemo(()=>{if(!ey)return[];let e=new Set;return ey.forEach(t=>{Object.keys(t.hourlyCounts).forEach(t=>e.add(t))}),Array.from(e).sort((e,t)=>{let s=e=>parseInt(e.split("-")[0],10);return s(e)-s(t)})},[ey]),eR=n().useMemo(()=>ey?ey.map(e=>({facility:e.facility,...e.hourlyCounts,total:e.total})).sort((e,t)=>t.total-e.total):[],[ey]),eM=eD.length>0?Object.keys(eD[0]).filter(e=>"date"!==e):[],eA=n().useMemo(()=>0===eC.length?[]:Object.keys(eC[0]).filter(e=>"date"!==e),[eC]),eL=n().useMemo(()=>eT?[...eT].sort((e,t)=>{let s=e=>{if(!e.date)return 0;let t=String(e.date).match(/^(\d{4})-(\d{2})-(\d{2})/);if(t)return new Date(`${t[1]}-${t[2]}-${t[3]}`).getTime();let s=String(e.date).match(/^(\d{2})\/(\d{2})\/(\d{4})$/);return s?new Date(`${s[3]}-${s[2]}-${s[1]}`).getTime():new Date(e.date).getTime()};return s(e)-s(t)}):[],[eT]);return(0,r.jsxs)("div",{className:"p-2 sm:p-4 md:p-6 max-w-full",children:[(0,r.jsx)(z.E,{type:e.type,message:e.message,isVisible:e.isVisible,onClose:l}),(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsxs)("div",{className:"p-2",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsx)("h1",{className:"text-xl lg:text-2xl font-semibold text-gray-900",children:"Customer Report"}),(0,r.jsx)("button",{onClick:()=>{(0,R.e)(["customer-selectedType","customer-selectedStatus","customer-startDate","customer-endDate","customer-selectedRegions","customer-selectedBranches"]),b([]),v(null),P((0,i.Ec)((0,i.Xj)()).subtract({days:7})),B((0,i.Ec)((0,i.Xj)())),O([]),G([]),t("Đ\xe3 reset tất cả filter về mặc định!"),g()},className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors text-sm",children:"Reset Filters"})]}),(0,r.jsx)(c.A,{startDate:Y,endDate:Z,setStartDate:P,setEndDate:B,today:i.Ec,getLocalTimeZone:i.Xj,parseDate:d._U,selectedType:f,setSelectedType:b,showTypeDropdown:y,setShowTypeDropdown:w,customerTypes:["KH trải nghiệm","Kh\xe1ch h\xe0ng Th\xe0nh vi\xean","Kh\xe1ch h\xe0ng Bạc","Kh\xe1ch h\xe0ng V\xe0ng","Kh\xe1ch h\xe0ng Bạch Kim","Kh\xe1ch h\xe0ng Kim cương"],selectedStatus:j,setSelectedStatus:v,showStatusDropdown:$,setShowStatusDropdown:D,customerStatus:["New","Old"],selectedRegions:I,setSelectedRegions:O,showRegionDropdown:V,setShowRegionDropdown:_,allRegions:["Đ\xe3 đ\xf3ng cửa","Đ\xe0 Nẵng","Nha Trang","H\xe0 Nội","HCM"],selectedBranches:q,setSelectedBranches:G,showBranchDropdown:U,setShowBranchDropdown:H,allBranches:["Branch 1","Branch 2","Branch 3"]}),(0,r.jsx)(x,{mainValue:ev?.currentTotal?.toLocaleString()??0,mainLabel:"Tổng số lượt kh\xe1ch sử dụng dịch vụ trong khoảng ng\xe0y đ\xe3 chọn",mainPercentChange:ev?.changePercentTotal,maleValue:ev?.currentMale,malePercentChange:ev?.changePercentMale,femaleValue:ev?.currentFemale,femalePercentChange:ev?.changePercentFemale,avgRevenueMale:ef?.avgRevenueMale,avgServiceMale:ef?.avgServiceMale,avgRevenueFemale:ef?.avgRevenueFemale,avgServiceFemale:ef?.avgServiceFemale}),(0,r.jsx)("div",{className:"mt-5 ",children:(0,r.jsx)(N,{isMobile:eE,loadingNewCustomer:et,errorNewCustomer:es,newCustomerChartData:ek,loadingGenderRatio:ea,errorGenderRatio:en,genderRatioData:e$,COLORS:X})}),(0,r.jsx)(S,{loadingCustomerSummary:eg,errorCustomerSummary:ep,customerSummaryRaw:eu}),(0,r.jsx)(k,{isMobile:eE,customerTypeTrendData:eD,customerTypeKeys:eM,COLORS:X}),(0,r.jsx)(C,{isMobile:eE,customerSourceTrendData:eC,customerSourceKeys:eA,COLORS:X}),(0,r.jsx)(E,{loadingAppDownload:em,errorAppDownload:eh,appDownloadPieData:eF}),(0,r.jsx)(T,{isMobile:eE,loading:eo,error:ec,sortedAppDownloadStatusData:eL}),(0,r.jsx)(o,{allHourRanges:ez,facilityHourTableData:eR,getCellBg:function(e){return 0===e?"":e>=50?"bg-[#68B2A0]":e>=35?"bg-[#CDE0C9]":e>=25?"bg-[#E0ECDE]":e<=15?"bg-[#F0F8F0]":""},isMobile:eE,loadingFacilityHour:ew,errorFacilityHour:eN})]})})]})}},89153:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>x,pages:()=>c,routeModule:()=>m,tree:()=>o});var r=s(65239),a=s(48088),n=s(88170),l=s.n(n),i=s(30893),d={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);s.d(t,d);let o={children:["",{children:["customers",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,506)),"/Users/lehoanganh/Documents/FB Network/FE/src/app/customers/page.tsx"]}]},{loading:[()=>Promise.resolve().then(s.bind(s,89715)),"/Users/lehoanganh/Documents/FB Network/FE/src/app/customers/loading.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,94431)),"/Users/lehoanganh/Documents/FB Network/FE/src/app/layout.tsx"],loading:[()=>Promise.resolve().then(s.bind(s,67393)),"/Users/lehoanganh/Documents/FB Network/FE/src/app/loading.tsx"],"not-found":[()=>Promise.resolve().then(s.bind(s,54413)),"/Users/lehoanganh/Documents/FB Network/FE/src/app/not-found.tsx"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/Users/lehoanganh/Documents/FB Network/FE/src/app/customers/page.tsx"],x={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/customers/page",pathname:"/customers",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},89715:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var r=s(37413);function a(){return(0,r.jsx)("div",{className:"p-4 lg:p-6",children:(0,r.jsx)("div",{className:"mb-4 lg:mb-6",children:(0,r.jsxs)("div",{className:"p-2",children:[(0,r.jsx)("h1",{className:"text-xl lg:text-2xl font-semibold text-gray-900 mb-2",children:"Customer Report"}),(0,r.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-4 mb-4",children:(0,r.jsxs)("div",{className:"animate-pulse",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/4 mb-4"}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,r.jsx)("div",{className:"h-10 bg-gray-200 rounded w-32"}),(0,r.jsx)("div",{className:"h-10 bg-gray-200 rounded w-32"}),(0,r.jsx)("div",{className:"h-10 bg-gray-200 rounded w-32"}),(0,r.jsx)("div",{className:"h-10 bg-gray-200 rounded w-32"})]})]})}),(0,r.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-4",children:(0,r.jsxs)("div",{className:"animate-pulse",children:[(0,r.jsx)("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-2"}),(0,r.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/2"})]})}),(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[1,2,3,4].map(e=>(0,r.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-4",children:(0,r.jsxs)("div",{className:"animate-pulse",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),(0,r.jsx)("div",{className:"h-6 bg-gray-200 rounded w-1/2"})]})},e))}),[1,2,3,4,5,6].map(e=>(0,r.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-4 mb-4",children:(0,r.jsxs)("div",{className:"animate-pulse",children:[(0,r.jsx)("div",{className:"h-5 bg-gray-200 rounded w-1/3 mb-4"}),(0,r.jsx)("div",{className:"h-64 bg-gray-200 rounded"})]})},e)),(0,r.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-4",children:(0,r.jsxs)("div",{className:"animate-pulse",children:[(0,r.jsx)("div",{className:"h-5 bg-gray-200 rounded w-1/4 mb-4"}),(0,r.jsx)("div",{className:"space-y-2",children:[1,2,3,4,5].map(e=>(0,r.jsx)("div",{className:"h-8 bg-gray-200 rounded"},e))})]})})]})})})}s(61120)}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[4447,2383,3397,7203,4587,9761,3650,3446,6888,8829],()=>s(89153));module.exports=r})();