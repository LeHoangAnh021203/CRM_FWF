(()=>{var e={};e.id=6898,e.ids=[6898],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},34953:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>m,routeModule:()=>c,serverHooks:()=>g,workAsyncStorage:()=>h,workUnitAsyncStorage:()=>f});var a={};r.r(a),r.d(a,{POST:()=>p});var o=r(96559),i=r(48088),n=r(37719),s=r(32190);async function p(e){try{let t,{imageBlob:r,prompt:a,strength:o}=await e.json();console.log("AI Generation Request:",{prompt:a,strength:o});let i=process.env.STABILITY_API_KEY,n=process.env.REPLICATE_API_KEY,p=process.env.OPENAI_API_KEY,c="demo",h="",f="";if(i?(c="stability",h=i,f="https://api.stability.ai/v1/generation/stable-diffusion-xl-1024-v1-0/image-to-image"):n?(c="replicate",h=n,f="https://api.replicate.com/v1/predictions"):p&&(c="openai",h=p,f="https://api.openai.com/v1/images/generations"),"demo"===c)return console.log("Using demo mode - returning fox.png"),s.NextResponse.json({result:"/fox.png"});switch(c){case"stability":t=await d(r,a,o,h,f);break;case"replicate":t=await u(r,a,o,h,f);break;case"openai":t=await l(r,a,o,h,f);break;default:throw Error("Unsupported service")}return s.NextResponse.json({result:t})}catch(e){return console.error("AI generation error:",e),s.NextResponse.json({error:e instanceof Error?e.message:"AI generation failed"},{status:500})}}async function d(e,t,r,a,o){let i=await fetch(e),n=await i.blob(),s=new FormData;s.append("init_image",n,"input.jpg");let p=`Transform this person into a beautiful fox person with ${r>=.8?"high transformation":r>=.5?"medium transformation":"subtle transformation"}: ${t}, anthropomorphic fox, detailed orange fur, pointy fox ears, bushy fox tail, human-like body, high quality, detailed, professional photography`;s.append("text_prompts[0][text]",p),s.append("text_prompts[0][weight]","1"),s.append("text_prompts[1][text]","low quality, blurry, distorted, bad anatomy, deformed, ugly, bad proportions"),s.append("text_prompts[1][weight]","-1"),s.append("cfg_scale","7.5"),s.append("steps","30"),s.append("samples","1"),s.append("style_preset","photographic");let d=await fetch(o,{method:"POST",headers:{Authorization:`Bearer ${a}`,Accept:"application/json"},body:s});if(!d.ok){let e=await d.text();throw Error(`Stability AI failed: ${d.status} - ${e}`)}let u=await d.json();if(u.artifacts&&u.artifacts.length>0)return`data:image/png;base64,${u.artifacts[0].base64}`;throw Error("No image generated")}async function u(e,t,r,a,o){let i=await fetch(o,{method:"POST",headers:{Authorization:`Token ${a}`,"Content-Type":"application/json"},body:JSON.stringify({version:"39ed52f2a78e934b3ba6e2a89f5b1c712de7dfea535525255b1aa35c5565e08b",input:{image:e,prompt:`fox person: ${t}`,strength:r}})});if(!i.ok)throw Error(`Replicate failed: ${i.status}`);return(await i.json()).output[0]}async function l(e,t,r,a,o){let i=await fetch(o,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({model:"dall-e-3",prompt:`Transform this person into a fox person with strength ${r}: ${t}`,n:1,size:"1024x1024"})});if(!i.ok)throw Error(`OpenAI failed: ${i.status}`);return(await i.json()).data[0].url}let c=new o.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/ai/generate/route",pathname:"/api/ai/generate",filename:"route",bundlePath:"app/api/ai/generate/route"},resolvedPagePath:"/Users/lehoanganh/Documents/FB Netwwork +/FE/CRM_FWF/src/app/api/ai/generate/route.ts",nextConfigOutput:"",userland:a}),{workAsyncStorage:h,workUnitAsyncStorage:f,serverHooks:g}=c;function m(){return(0,n.patchFetch)({workAsyncStorage:h,workUnitAsyncStorage:f})}},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},96487:()=>{}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[4447,580],()=>r(34953));module.exports=a})();