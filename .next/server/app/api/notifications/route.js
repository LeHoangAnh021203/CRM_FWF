(()=>{var e={};e.id=2170,e.ids=[2170],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27836:(e,t,s)=>{"use strict";s.r(t),s.d(t,{patchFetch:()=>w,routeModule:()=>f,serverHooks:()=>_,workAsyncStorage:()=>y,workUnitAsyncStorage:()=>x});var r={};s.r(r),s.d(r,{GET:()=>m,POST:()=>g});var a=s(96559),n=s(48088),i=s(37719),o=s(32190);let u=[],c=new Map;async function p(){let e=[],t=process.env.NEXT_PUBLIC_BASE_URL||"http://localhost:3000";for(let s of u){let r=Date.now();try{let a=await fetch(`${t}${s.url}`,{method:"GET",headers:{"Content-Type":"application/json"},signal:AbortSignal.timeout(5e3)});e.push({name:s.name,url:s.url,status:a.status,responseTime:Date.now()-r,isHealthy:a.status===s.expectedStatus,error:null})}catch(t){e.push({name:s.name,url:s.url,status:"ERROR",responseTime:Date.now()-r,isHealthy:!1,error:t instanceof Error?t.message:"Unknown error"})}}return e}async function l(){try{let e=await Promise.resolve().then(s.t.bind(s,29021,23)).then(e=>e.promises),t=await Promise.resolve().then(s.t.bind(s,33873,23)),r=await Promise.all(["src/data/danh_sach_ban_hang.json","src/data/khach_hang_su_dung_app.json","src/data/dich_vu_ban_hang.json","src/data/ban_hang_doanh_so.json"].map(async s=>{try{let r=t.join(process.cwd(),s);await e.access(r);let a=await e.stat(r);return{name:t.basename(s),exists:!0,size:a.size,lastModified:a.mtime}}catch(e){return{name:t.basename(s),exists:!1,error:e instanceof Error?e.message:"File not found"}}}));return{timestamp:new Date,fileStatus:r,memoryUsage:process.memoryUsage(),uptime:process.uptime()}}catch(e){return{timestamp:new Date,error:e instanceof Error?e.message:"System health check failed"}}}function h(e){let t=new Date().getTime()-e.getTime(),s=Math.floor(t/6e4),r=Math.floor(t/36e5);return s<1?"Vừa xong":s<60?`${s} ph\xfat trước`:r<24?`${r} giờ trước`:`${Math.floor(r/24)} ng\xe0y trước`}function d(e){return({customers:"Kh\xe1ch h\xe0ng",orders:"Đơn h\xe0ng",services:"Dịch vụ",dashboard:"Tổng quan"})[e]||e}async function m(){try{let e=await p(),t=await l(),s=[];if(e.forEach((e,t)=>{e.isHealthy||s.push({id:`api_error_${t}`,title:`${e.name} - Error`,message:`Error: ${e.error||`Status ${e.status}`}, Response time: ${e.responseTime}ms`,time:"Vừa xong",read:!1,type:"api_error"})}),s.push(...function(){let e=[],t=new Date;return c.forEach((s,r)=>{let a=Math.floor((t.getTime()-s.lastActivity.getTime())/6e4);s.errorCount>0&&s.lastError&&e.push({id:`${r}_error_${Date.now()}`,title:`${d(r)} - Lỗi`,message:s.lastError,time:h(s.lastActivity),read:!1,type:"api_error"}),s.successCount>0&&s.lastSuccess&&e.push({id:`${r}_success_${Date.now()}`,title:`${d(r)} - Th\xe0nh c\xf4ng`,message:s.lastSuccess,time:h(s.lastActivity),read:!1,type:"api_status"}),a>30&&s.dataLoaded&&e.push({id:`${r}_inactive_${Date.now()}`,title:`${d(r)} - Kh\xf4ng hoạt động`,message:`Trang kh\xf4ng c\xf3 hoạt động trong ${Math.floor(a/60)} giờ`,time:h(s.lastActivity),read:!1,type:"system_health"})}),e}()),c.size>0){let e=Array.from(c.values()).filter(e=>e.dataLoaded).length;s.push({id:"system_status",title:"Trạng th\xe1i hệ thống",message:`${e}/${c.size} trang đ\xe3 sẵn s\xe0ng sử dụng`,time:"Vừa xong",read:!0,type:"system_health"})}if(t.fileStatus){let e=t.fileStatus?.filter(e=>e.exists).length??0;e<t.fileStatus.length&&s.push({id:"system_files",title:"Data Files Status",message:`${e}/${t.fileStatus.length} data files accessible`,time:"Vừa xong",read:!1,type:"system_health"})}if(t.memoryUsage){let e=Math.round(t.memoryUsage.heapUsed/1024/1024);e>512&&s.push({id:"memory_usage",title:"Memory Usage",message:`Heap used: ${e}MB, Uptime: ${Math.round(t.uptime/60)} minutes`,time:"Vừa xong",read:!0,type:"api_performance"})}let r=s.filter(e=>!e.read).length;return o.NextResponse.json({notifications:s,count:r,apiStatus:e,systemHealth:t,pageStatuses:Object.fromEntries(c),lastUpdated:new Date().toISOString()})}catch(e){return console.error("Error fetching API status:",e),o.NextResponse.json({notifications:[{id:"api_error",title:"API Status Check Failed",message:"Kh\xf4ng thể kiểm tra trạng th\xe1i API",time:"Vừa xong",read:!1,type:"api_error"}],count:1,error:"Failed to check API status"},{status:500})}}async function g(e){try{let{pageName:t,...s}=await e.json();if(!t)return o.NextResponse.json({error:"Page name is required"},{status:400});let r=new Date,a=c.get(t)||{page:t,lastActivity:r,dataLoaded:!1,errorCount:0,successCount:0};return c.set(t,{...a,...s,lastActivity:r}),o.NextResponse.json({success:!0,message:`Page status updated for ${t}`})}catch(e){return console.error("Error updating page status:",e),o.NextResponse.json({error:"Failed to update page status"},{status:500})}}let f=new a.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/notifications/route",pathname:"/api/notifications",filename:"route",bundlePath:"app/api/notifications/route"},resolvedPagePath:"/Users/lehoanganh/Documents/FB Netwwork +/FE/CRM_FWF/src/app/api/notifications/route.ts",nextConfigOutput:"",userland:r}),{workAsyncStorage:y,workUnitAsyncStorage:x,serverHooks:_}=f;function w(){return(0,i.patchFetch)({workAsyncStorage:y,workUnitAsyncStorage:x})}},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},96487:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[4447,580],()=>s(27836));module.exports=r})();