(()=>{var e={};e.id=763,e.ids=[763],e.modules={1103:(e,t,a)=>{Promise.resolve().then(a.bind(a,34346))},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},13193:(e,t,a)=>{"use strict";a.d(t,{E:()=>o,h:()=>d});var r=a(60687),s=a(43210),l=a(5336),n=a(35071),i=a(11860);let o=({type:e,message:t,isVisible:a,onClose:o,duration:d=5e3})=>{let[c,h]=(0,s.useState)(!1);if((0,s.useEffect)(()=>{if(a){h(!0);let e=setTimeout(()=>{h(!1),setTimeout(o,300)},d);return()=>clearTimeout(e)}},[a,d,o]),!a)return null;let u="success"===e?"text-green-800":"text-red-800",m="success"===e?l.A:n.A;return(0,r.jsx)("div",{className:`fixed top-4 right-4 z-50 max-w-sm w-full transition-all duration-300 ease-in-out ${c?"opacity-100 translate-y-0":"opacity-0 -translate-y-2"}`,children:(0,r.jsx)("div",{className:`${"success"===e?"bg-green-50":"bg-red-50"} border ${"success"===e?"border-green-200":"border-red-200"} rounded-lg shadow-lg p-4`,children:(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)(m,{className:`h-5 w-5 ${"success"===e?"text-green-400":"text-red-400"}`})}),(0,r.jsx)("div",{className:"ml-3 flex-1",children:(0,r.jsx)("p",{className:`text-sm font-medium ${u}`,children:t})}),(0,r.jsx)("div",{className:"ml-4 flex-shrink-0",children:(0,r.jsx)("button",{onClick:()=>{h(!1),setTimeout(o,300)},className:`inline-flex ${u} hover:${u} focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-${"success"===e?"green":"red"}-500`,children:(0,r.jsx)(i.A,{className:"h-4 w-4"})})})]})})})},d=()=>{let[e,t]=(0,s.useState)({type:"success",message:"",isVisible:!1});return{notification:e,showSuccess:e=>{t({type:"success",message:e,isVisible:!0})},showError:e=>{t({type:"error",message:e,isVisible:!0})},hideNotification:()=>{t(e=>({...e,isVisible:!1}))}}}},18873:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>n.a,__next_app__:()=>h,pages:()=>c,routeModule:()=>u,tree:()=>d});var r=a(65239),s=a(48088),l=a(88170),n=a.n(l),i=a(30893),o={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);a.d(t,o);let d={children:["",{children:["services",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,31331)),"/Users/lehoanganh/Documents/FB Network/FE/src/app/services/page.tsx"]}]},{loading:[()=>Promise.resolve().then(a.bind(a,20184)),"/Users/lehoanganh/Documents/FB Network/FE/src/app/services/loading.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,94431)),"/Users/lehoanganh/Documents/FB Network/FE/src/app/layout.tsx"],loading:[()=>Promise.resolve().then(a.bind(a,67393)),"/Users/lehoanganh/Documents/FB Network/FE/src/app/loading.tsx"],"not-found":[()=>Promise.resolve().then(a.bind(a,54413)),"/Users/lehoanganh/Documents/FB Network/FE/src/app/not-found.tsx"],forbidden:[()=>Promise.resolve().then(a.t.bind(a,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(a.t.bind(a,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/Users/lehoanganh/Documents/FB Network/FE/src/app/services/page.tsx"],h={require:a,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/services/page",pathname:"/services",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},20184:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});var r=a(37413);function s(){return(0,r.jsx)("div",{className:"p-2 sm:p-4 md:p-6",children:(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("div",{className:"p-2",children:[(0,r.jsx)("div",{className:"h-8 bg-gray-200 rounded animate-pulse mb-2 w-48"}),(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-64"})]}),(0,r.jsx)("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[void 0,void 0,void 0,void 0].map((e,t)=>(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-20"}),(0,r.jsx)("div",{className:"h-10 bg-gray-200 rounded animate-pulse"})]},t))})}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[(0,r.jsx)("div",{className:"h-6 bg-gray-200 rounded animate-pulse mb-4 w-48"}),(0,r.jsx)("div",{className:"h-64 bg-gray-200 rounded animate-pulse"})]}),(0,r.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6",children:[void 0,void 0,void 0].map((e,t)=>(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,r.jsx)("div",{className:"h-6 bg-gray-200 rounded animate-pulse mb-4 w-32"}),(0,r.jsx)("div",{className:"h-48 bg-gray-200 rounded animate-pulse"})]},t))}),(0,r.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[void 0,void 0].map((e,t)=>(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,r.jsx)("div",{className:"h-6 bg-gray-200 rounded animate-pulse mb-4 w-40"}),(0,r.jsx)("div",{className:"h-48 bg-gray-200 rounded animate-pulse"})]},t))}),(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 mb-6",children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded animate-pulse mb-2 w-20"}),(0,r.jsx)("div",{className:"h-8 bg-gray-200 rounded animate-pulse mb-2 w-16"}),(0,r.jsx)("div",{className:"h-3 bg-gray-200 rounded animate-pulse w-12"})]},t))}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[(0,r.jsx)("div",{className:"h-6 bg-gray-200 rounded animate-pulse mb-4 w-48"}),(0,r.jsx)("div",{className:"h-64 bg-gray-200 rounded animate-pulse"})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[(0,r.jsx)("div",{className:"h-6 bg-gray-200 rounded animate-pulse mb-4 w-40"}),(0,r.jsx)("div",{className:"h-64 bg-gray-200 rounded animate-pulse"})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,r.jsx)("div",{className:"h-6 bg-gray-200 rounded animate-pulse mb-4 w-32"}),(0,r.jsx)("div",{className:"space-y-2",children:[...Array(8)].map((e,t)=>(0,r.jsx)("div",{className:"h-12 bg-gray-200 rounded animate-pulse"},t))})]})]})})}},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},31331:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>r});let r=(0,a(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/lehoanganh/Documents/FB Network/FE/src/app/services/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/lehoanganh/Documents/FB Network/FE/src/app/services/page.tsx","default")},33873:e=>{"use strict";e.exports=require("path")},34346:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>E});var r=a(60687),s=a(43210),l=a.n(s),n=a(67763),i=a(7562);function o({startDate:e,endDate:t,setStartDate:a,setEndDate:n,today:o,getLocalTimeZone:d,selectedRegions:c,setSelectedRegions:h,selectedBranches:u,setSelectedBranches:m,selectedServiceTypes:x,setSelectedServiceTypes:g,selectedGenders:p,setSelectedGenders:b,regionOptions:f,locationOptions:v,filteredRegionOptions:y,ALL_SERVICE_TYPES:j,ALL_GENDERS:N,filteredServiceTypes:w,filteredGenders:S,genderActualPrice:k,formatMoneyShort:C}){let[T,D]=l().useState(""),[M,_]=l().useState(""),[A,P]=(0,s.useState)(!1),[H,F]=(0,s.useState)(!1),[L,R]=(0,s.useState)(!1),[$,E]=(0,s.useState)(!1),[V,z]=(0,s.useState)(""),[K,Q]=(0,s.useState)(""),[G,W]=(0,s.useState)(""),[B,I]=(0,s.useState)(""),O=(0,s.useRef)(null),U=(0,s.useRef)(null),q=(0,s.useRef)(null),X=(0,s.useRef)(null);return(0,r.jsxs)("div",{className:"w-full flex flex-col gap-4 md:flex-row md:gap-10",children:[(0,r.jsxs)("div",{className:"w-full max-w-xl flex flex-col gap-4 md:flex-row md:gap-4 bg-white p-2 rounded",children:[(0,r.jsxs)("div",{className:"w-full flex flex-col gap-1",children:[(0,r.jsx)("h3",{children:"Start date"}),(0,r.jsx)("input",{type:"date",className:"border rounded p-2 bg-white",value:e.toString(),onChange:e=>{a((0,i._U)(e.target.value))},max:o(d()).toString()})]}),(0,r.jsxs)("div",{className:"w-full flex flex-col gap-1",children:[(0,r.jsx)("h3",{children:"End date"}),(0,r.jsx)("input",{type:"date",className:"border rounded p-2 bg-white",value:t.toString(),onChange:e=>{n((0,i._U)(e.target.value))},min:M,max:T})]})]}),(0,r.jsx)("div",{className:"w-full flex flex-col gap-2",children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:flex-wrap gap-2 w-full",children:[(0,r.jsxs)("div",{className:"relative w-full sm:w-auto",ref:O,children:[(0,r.jsxs)("button",{className:"bg-yellow-300 px-3 py-2 rounded-lg font-bold flex items-center gap-2 w-full sm:w-auto border-b-2 border-yellow-400",onClick:()=>P(e=>!e),type:"button",children:[(0,r.jsx)("span",{className:"material-icons"})," Region"]}),A&&(0,r.jsxs)("div",{className:"absolute z-20 bg-white shadow-xl rounded-b-lg w-full min-w-[250px] border border-yellow-200",children:[(0,r.jsxs)("div",{className:"bg-yellow-200 px-4 py-2 font-bold flex items-center gap-2 border-b border-yellow-300",children:[(0,r.jsx)("input",{type:"checkbox",checked:c.length===f.length,onChange:()=>h(c.length===f.length?[]:f.map(e=>e.name)),className:"accent-yellow-400"}),"Region",(0,r.jsx)("span",{className:"ml-auto",children:"Branches "})]}),(0,r.jsx)("div",{className:"px-2 py-2 border-b",children:(0,r.jsx)("input",{className:"w-full border rounded px-2 py-1",placeholder:"Nhập để t\xecm kiếm",value:V,onChange:e=>z(e.target.value)})}),(0,r.jsx)("div",{className:"max-h-60 overflow-y-auto",children:y.map(e=>(0,r.jsxs)("label",{className:"flex items-center gap-2 px-4 py-2 hover:bg-yellow-50 cursor-pointer border-b last:border-b-0",children:[(0,r.jsx)("input",{type:"checkbox",checked:c.includes(e.name),onChange:()=>{h(t=>t.includes(e.name)?t.filter(t=>t!==e.name):[...t,e.name])},className:"accent-yellow-400"}),(0,r.jsx)("span",{className:"font-medium",children:e.name}),(0,r.jsx)("span",{className:"ml-auto text-right min-w-[70px] font-semibold",children:e.total})]},e.name))})]})]}),(0,r.jsxs)("div",{className:"relative w-full sm:w-auto",ref:U,children:[(0,r.jsxs)("button",{className:"bg-yellow-300 px-3 py-2 rounded-lg font-bold flex items-center gap-2 w-full sm:w-auto border-b-2 border-yellow-400",onClick:()=>F(e=>!e),type:"button",children:[(0,r.jsx)("span",{className:"material-icons"})," Locations"]}),H&&(0,r.jsxs)("div",{className:"absolute z-20 bg-white shadow-xl rounded-b-lg w-full min-w-[220px] border border-yellow-200",children:[(0,r.jsxs)("div",{className:"bg-yellow-100 px-4 py-2 font-bold flex items-center gap-2 border-b border-yellow-200",children:[(0,r.jsx)("input",{type:"checkbox",checked:u.length===v.length,onChange:()=>m(u.length===v.length?[]:[...v]),className:"accent-yellow-400"}),"Locations"]}),(0,r.jsx)("div",{className:"px-2 py-2 border-b",children:(0,r.jsx)("input",{className:"w-full border rounded px-2 py-1",placeholder:"Nhập để t\xecm kiếm",value:K,onChange:e=>Q(e.target.value)})}),(0,r.jsx)("div",{className:"max-h-60 overflow-y-auto",children:v.filter(e=>e.toLowerCase().includes(K.toLowerCase())).map(e=>(0,r.jsxs)("label",{className:"flex items-center gap-2 px-4 py-2 hover:bg-yellow-50 cursor-pointer border-b last:border-b-0",children:[(0,r.jsx)("input",{type:"checkbox",checked:u.includes(e),onChange:()=>{m(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},className:"accent-yellow-400"}),(0,r.jsx)("span",{className:"font-medium",children:e})]},e))})]})]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2 mb-4",children:[(0,r.jsxs)("div",{className:"relative w-full sm:w-auto",ref:q,children:[(0,r.jsxs)("button",{className:"bg-yellow-300 px-3 py-2 rounded-lg font-bold flex items-center gap-2 w-full sm:w-auto border-b-2 border-yellow-400",onClick:()=>R(e=>!e),type:"button",children:[(0,r.jsx)("span",{className:"material-icons"})," Services"]}),L&&(0,r.jsxs)("div",{className:"absolute z-20 bg-white shadow-xl rounded-b-lg w-full min-w-[180px] border border-yellow-200",children:[(0,r.jsxs)("div",{className:"bg-yellow-200 px-4 py-2 font-bold flex items-center gap-2 border-b border-yellow-300",children:[(0,r.jsx)("input",{type:"checkbox",checked:x.length===j.length,onChange:()=>g(x.length===j.length?[]:j.map(e=>e.key)),className:"accent-yellow-400"}),"Services"]}),(0,r.jsx)("div",{className:"px-2 py-2 border-b",children:(0,r.jsx)("input",{className:"w-full border rounded px-2 py-1",placeholder:"Nhập để t\xecm kiếm",value:G,onChange:e=>W(e.target.value)})}),(0,r.jsx)("div",{className:"max-h-60 overflow-y-auto",children:w.map(e=>(0,r.jsxs)("label",{className:"flex items-center gap-2 px-4 py-2 hover:bg-yellow-50 cursor-pointer border-b last:border-b-0",children:[(0,r.jsx)("input",{type:"checkbox",checked:x.includes(e.key),onChange:()=>{g(t=>t.includes(e.key)?t.filter(t=>t!==e.key):[...t,e.key])},className:"accent-yellow-400"}),(0,r.jsx)("span",{className:"font-medium",children:e.label})]},e.key))})]})]}),(0,r.jsxs)("div",{className:"relative w-full sm:w-auto",ref:X,children:[(0,r.jsxs)("button",{className:"bg-yellow-300 px-3 py-2 rounded-lg font-bold flex items-center gap-2 w-full sm:w-auto border-b-2 border-yellow-400",onClick:()=>E(e=>!e),type:"button",children:[(0,r.jsx)("span",{className:"material-icons"})," Gender"]}),$&&(0,r.jsxs)("div",{className:"absolute z-20 bg-white shadow-xl rounded-b-lg w-full min-w-[220px] border border-yellow-200",children:[(0,r.jsxs)("div",{className:"bg-yellow-200 px-4 py-2 font-bold flex items-center gap-2 border-b border-yellow-300",children:[(0,r.jsx)("input",{type:"checkbox",checked:p.length===N.length,onChange:()=>b(p.length===N.length?[]:[...N]),className:"accent-yellow-400"}),"Gender",(0,r.jsx)("span",{className:"ml-auto",children:"Actual price "})]}),(0,r.jsx)("div",{className:"px-2 py-2 border-b",children:(0,r.jsx)("input",{className:"w-full border rounded px-2 py-1",placeholder:"Nhập để t\xecm kiếm",value:B,onChange:e=>I(e.target.value)})}),(0,r.jsx)("div",{className:"max-h-60 overflow-y-auto",children:S.map(e=>{let t=k.find(t=>t.gender===e)?.total||0;return(0,r.jsxs)("label",{className:"flex items-center gap-2 px-4 py-2 hover:bg-yellow-50 cursor-pointer border-b last:border-b-0 justify-between",children:[(0,r.jsxs)("span",{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{type:"checkbox",checked:p.includes(e),onChange:()=>{b(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},className:"accent-yellow-400"}),(0,r.jsx)("span",{className:"font-medium",children:e})]}),(0,r.jsx)("span",{className:"text-xs text-gray-500 min-w-[60px] text-right",children:C(t)})]},e)})})]})]})]})]})})]})}var d=a(48482),c=a(2041),h=a(85168),u=a(27747),m=a(19598),x=a(23812),g=a(15202),p=a(515),b=a(98845);function f({weeklyServiceChartData:e,isMobile:t}){let a=l().useMemo(()=>{let t=new Map;return e.forEach(e=>{let a=[e.combo||0,e.service||0,e.addedon||0,e.foxcard||0];t.set(e.date,Math.max(...a))}),t},[e]),s=l().useMemo(()=>{let t={combo:{date:"",value:0},service:{date:"",value:0},addedon:{date:"",value:0},foxcard:{date:"",value:0}};return e.forEach(e=>{(e.combo||0)>t.combo.value&&(t.combo={date:e.date,value:e.combo||0}),(e.service||0)>t.service.value&&(t.service={date:e.date,value:e.service||0}),(e.addedon||0)>t.addedon.value&&(t.addedon={date:e.date,value:e.addedon||0}),(e.foxcard||0)>t.foxcard.value&&(t.foxcard={date:e.date,value:e.foxcard||0})}),t},[e]),n=l().useMemo(()=>{let t=0;return e.forEach(e=>{let a=Math.max(e.combo||0,e.service||0,e.addedon||0,e.foxcard||0);a>t&&(t=a)}),t},[e]);return(0,r.jsxs)("div",{className:"w-full bg-white rounded-xl shadow-lg mt-5 p-2 sm:p-4",children:[(0,r.jsx)("div",{className:"text-sm sm:text-base md:text-xl font-medium text-gray-700 text-center mb-4",children:"Tổng dịch vụ thực hiện trong tuần"}),(0,r.jsx)("div",{className:"w-full overflow-x-auto",children:(0,r.jsx)(d.u,{width:"100%",height:t?300:400,minWidth:280,children:(0,r.jsxs)(c.E,{data:e,margin:{top:t?30:50,right:t?10:30,left:t?10:20,bottom:t?20:5},barCategoryGap:t?2:4,barGap:t?1:2,children:[(0,r.jsx)(h.d,{strokeDasharray:"3 3"}),(0,r.jsx)(u.W,{dataKey:"date",fontSize:t?10:12,angle:t?-45:0,textAnchor:t?"end":"middle",height:t?60:30}),(0,r.jsx)(m.h,{fontSize:t?10:12,width:t?60:80,domain:[0,n]}),(0,r.jsx)(x.m,{contentStyle:{fontSize:t?12:14,backgroundColor:"rgba(255, 255, 255, 0.95)",border:"1px solid #ccc",borderRadius:"4px",padding:"8px"}}),(0,r.jsx)(g.s,{wrapperStyle:{fontSize:t?10:12,paddingTop:t?10:20}}),(0,r.jsx)(p.y,{dataKey:"combo",name:"Combo",fill:"#795548",maxBarSize:t?80:120,children:(0,r.jsx)(b.Z,{dataKey:"combo",position:"top",fontSize:t?10:12,fill:"#795548",formatter:r=>{if("number"==typeof r&&0===r)return"";if(t){let t=e.find(e=>e.combo===r);return t&&t.date===s.combo.date&&r===s.combo.value?r.toString():""}{let t=e.find(e=>e.combo===r);if(!t)return"";let s=a.get(t.date)||0;return"number"==typeof r&&r===s&&r>0?r.toString():""}}})}),(0,r.jsx)(p.y,{dataKey:"service",name:"Dịch vụ",fill:"#c5e1a5",maxBarSize:t?80:120,children:(0,r.jsx)(b.Z,{dataKey:"service",position:"top",fontSize:t?10:12,fill:"#c5e1a5",formatter:r=>{if("number"==typeof r&&0===r)return"";if(t){let t=e.find(e=>e.service===r);return t&&t.date===s.service.date&&r===s.service.value?r.toString():""}{let t=e.find(e=>e.service===r);if(!t)return"";let s=a.get(t.date)||0;return"number"==typeof r&&r===s&&r>0?r.toString():""}}})}),(0,r.jsx)(p.y,{dataKey:"addedon",name:"Added on",fill:"#f16a3f",maxBarSize:t?80:120,children:(0,r.jsx)(b.Z,{dataKey:"addedon",position:"top",fontSize:t?10:12,fill:"#f16a3f",formatter:r=>{if("number"==typeof r&&0===r)return"";if(t){let t=e.find(e=>e.addedon===r);return t&&t.date===s.addedon.date&&r===s.addedon.value?r.toString():""}{let t=e.find(e=>e.addedon===r);if(!t)return"";let s=a.get(t.date)||0;return"number"==typeof r&&r===s&&r>0?r.toString():""}}})}),(0,r.jsx)(p.y,{dataKey:"foxcard",name:"Fox card",fill:"#c86b82",maxBarSize:t?80:120,children:(0,r.jsx)(b.Z,{dataKey:"foxcard",position:"top",fontSize:t?10:12,fill:"#c86b82",formatter:r=>{if("number"==typeof r&&0===r)return"";if(t){let t=e.find(e=>e.foxcard===r);return t&&t.date===s.foxcard.date&&r===s.foxcard.value?r.toString():""}{let t=e.find(e=>e.foxcard===r);if(!t)return"";let s=a.get(t.date)||0;return"number"==typeof r&&r===s&&r>0?r.toString():""}}})})]})})})]})}var v=a(56651),y=a(56988),j=a(25679);let N=({active:e,payload:t,label:a})=>{if(e&&t&&t.length){let e=t[0],s=t.reduce((e,t)=>e+t.value,0),l=s>0?(e.value/s*100).toFixed(1):"0",n=a?.includes("gi\xe1 buổi")||a?.includes("doanh thu")||a?.includes("Top 10 dịch vụ theo gi\xe1 buổi");return console.log("Tooltip label:",a,"isRevenueChart:",n,"data.value:",e.value,"total:",s,"percentage:",l),(0,r.jsxs)("div",{className:"bg-white p-3 border border-gray-200 rounded-lg shadow-lg",children:[(0,r.jsx)("p",{className:"font-medium text-gray-900",children:e.name||e.payload.label}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:[n?"Doanh thu: ":"Số lượng: ",(0,r.jsx)("span",{className:"font-semibold",children:n?`${(e.value/1e6).toFixed(1)}M VNĐ`:e.value.toLocaleString()})]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Tỷ lệ: ",(0,r.jsxs)("span",{className:"font-semibold",children:[l,"%"]})]})]})}return null};function w({pieChartData:e,pieTop10Data:t,pieTop10AvgData:a,top10ServicesLoading:s,top10ServicesError:l,top10ServicesUsageLoading:n,top10ServicesUsageError:i,isMobile:o,renderPieLabel:c}){return(0,r.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:gap-3",children:[(0,r.jsxs)("div",{className:"w-full sm:w-1/3 bg-white rounded-xl shadow-lg mt-5 p-4",children:[(0,r.jsx)("div",{className:"text-xl font-medium text-gray-700 text-center mb-4",children:"Tỉ lệ dịch vụ/combo/cộng th\xeam"}),(0,r.jsx)(d.u,{width:"100%",height:o?220:320,children:(0,r.jsxs)(v.r,{children:[(0,r.jsx)(y.F,{data:e,dataKey:"value",nameKey:"label",cx:"50%",cy:"50%",outerRadius:o?80:120,label:c,children:e.map(e=>(0,r.jsx)(j.f,{fill:e.color},e.key))}),(0,r.jsx)(x.m,{content:(0,r.jsx)(N,{label:"Tỉ lệ dịch vụ/combo/cộng th\xeam"})})]})}),(0,r.jsx)("div",{className:"overflow-hidden",children:(0,r.jsx)("ul",{className:"flex flex-wrap justify-center gap-2 mt-2 text-xs",children:e.map(e=>(0,r.jsxs)("li",{className:"flex items-start gap-1",children:[(0,r.jsx)("span",{className:"inline-block w-3 h-3 rounded-full flex-shrink-0 mt-0.5",style:{background:e.color}}),(0,r.jsx)("span",{className:"break-words",children:e.label})]},e.key))})})]}),(0,r.jsxs)("div",{className:"w-full sm:w-1/3 bg-white rounded-xl shadow-lg mt-5 p-4",children:[(0,r.jsx)("div",{className:"text-xl font-medium text-gray-700 text-center mb-4",children:"Top 10 dịch vụ theo số lượng"}),s&&(0,r.jsx)("div",{className:"text-blue-600 text-sm text-center mb-4",children:"\uD83D\uDD04 Đang tải dữ liệu top 10 dịch vụ..."}),l&&(0,r.jsxs)("div",{className:"text-red-600 text-sm text-center mb-4",children:["❌ Lỗi API top 10 dịch vụ: ",l]}),(0,r.jsx)(d.u,{width:"100%",height:o?220:320,children:(0,r.jsxs)(v.r,{children:[(0,r.jsx)(y.F,{data:t,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:o?80:120,label:c,children:t.map(e=>(0,r.jsx)(j.f,{fill:e.color},e.name))}),(0,r.jsx)(x.m,{content:(0,r.jsx)(N,{label:"Top 10 dịch vụ theo số lượng"})})]})}),(0,r.jsx)("div",{className:"overflow-hidden",children:(0,r.jsx)("ul",{className:"flex flex-wrap  gap-2 mt-2 text-xs",children:t.map(e=>(0,r.jsxs)("li",{className:"flex items-start gap-1",children:[(0,r.jsx)("span",{className:"inline-block w-3 h-3 rounded-full flex-shrink-0 mt-0.5",style:{background:e.color}}),(0,r.jsx)("span",{className:"break-words",children:e.name})]},e.name))})})]}),(0,r.jsxs)("div",{className:"w-full sm:w-1/3 bg-white rounded-xl shadow-lg mt-5 p-4",children:[(0,r.jsx)("div",{className:"text-xl font-medium text-gray-700 text-center mb-4",children:"Top 10 dịch vụ theo gi\xe1 buổi"}),n&&(0,r.jsx)("div",{className:"text-blue-600 text-sm text-center mb-4",children:"\uD83D\uDD04 Đang tải dữ liệu top 10 dịch vụ theo gi\xe1 buổi..."}),i&&(0,r.jsxs)("div",{className:"text-red-600 text-sm text-center mb-4",children:["❌ Lỗi API top 10 dịch vụ theo gi\xe1 buổi:"," ",i]}),(0,r.jsx)(d.u,{width:"100%",height:o?220:320,children:(0,r.jsxs)(v.r,{children:[(0,r.jsx)(y.F,{data:a,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:o?80:120,label:c,children:a.map(e=>(0,r.jsx)(j.f,{fill:e.color},e.name))}),(0,r.jsx)(x.m,{content:(0,r.jsx)(N,{label:"Top 10 dịch vụ theo gi\xe1 buổi"})})]})}),(0,r.jsx)("div",{className:"overflow-hidden",children:(0,r.jsx)("ul",{className:"flex flex-wrap  gap-2 mt-2 text-xs",children:a.map(e=>(0,r.jsxs)("li",{className:"flex items-start gap-1",children:[(0,r.jsx)("span",{className:"inline-block w-3 h-3 rounded-full flex-shrink-0 mt-0.5",style:{background:e.color}}),(0,r.jsx)("span",{className:"break-words",children:e.name})]},e.name))})})]})]})}var S=a(76180),k=a.n(S);let C=({active:e,payload:t,label:a})=>{if(e&&t&&t.length){let e=t[0];return(0,r.jsxs)("div",{className:"bg-white p-3 border border-gray-200 rounded-lg shadow-lg",children:[(0,r.jsx)("p",{className:"font-medium text-gray-900",children:e.name||e.payload.name}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:[a?.includes("gi\xe1 buổi")?"Doanh thu: ":"Số lượng: ",(0,r.jsx)("span",{className:"font-semibold",children:a?.includes("gi\xe1 buổi")?`${(e.value/1e6).toFixed(1)}M VNĐ`:e.value.toLocaleString()})]})]})}return null};function T({bottom3ServicesUsageData:e,bottom3ServicesUsageLoading:t,bottom3ServicesUsageError:a,bottom3ServicesRevenueLoading:s,bottom3ServicesRevenueError:l,bottom3Data:n,bottom3RevenueData:i,filteredPieData:o,isMobile:c}){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(k(),{id:"2f0483ac8cc1fbf0",dynamic:[c?"8px":"12px"],children:`.recharts-pie-label-text.__jsx-style-dynamic-selector{font-size:${c?"8px":"12px"}!important}`}),(0,r.jsxs)("div",{className:k().dynamic([["2f0483ac8cc1fbf0",[c?"8px":"12px"]]])+" flex flex-col lg:flex-row gap-2 justify-center",children:[(0,r.jsxs)("div",{className:k().dynamic([["2f0483ac8cc1fbf0",[c?"8px":"12px"]]])+" w-full lg:w-1/2 bg-white rounded-xl shadow-lg mt-5 p-4",children:[(0,r.jsx)("div",{className:k().dynamic([["2f0483ac8cc1fbf0",[c?"8px":"12px"]]])+" text-lg lg:text-xl font-medium text-gray-700 text-center mb-4",children:"Bottom 3 dịch vụ theo số lượng"}),t&&(0,r.jsx)("div",{className:k().dynamic([["2f0483ac8cc1fbf0",[c?"8px":"12px"]]])+" text-blue-600 text-sm text-center mb-4",children:"\uD83D\uDD04 Đang tải dữ liệu bottom 3 dịch vụ..."}),a&&(0,r.jsxs)("div",{className:k().dynamic([["2f0483ac8cc1fbf0",[c?"8px":"12px"]]])+" text-red-600 text-sm text-center mb-4",children:["❌ Lỗi API bottom 3 dịch vụ: ",a]}),(0,r.jsx)(d.u,{width:"100%",height:c?250:350,children:(0,r.jsxs)(v.r,{children:[(0,r.jsx)(y.F,{data:(()=>{if(e){let t=["#bdbdbd","#9e9e9e","#e0e0e0"];return e.map((e,a)=>({name:e.serviceName,value:e.count,color:t[a%t.length]}))}let t=new Map;o.forEach(e=>{let a=e.serviceName||e.type;t.set(a,(t.get(a)||0)+1)});let a=Array.from(t.entries()).sort((e,t)=>e[1]-t[1]).slice(0,3),r=["#bdbdbd","#9e9e9e","#e0e0e0"];return a.map(([e,t],a)=>({name:e,value:t,color:r[a%r.length]}))})(),dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:c?45:90,label:({percent:e})=>e&&e>.15?`${(100*e).toFixed(1)}%`:"",labelLine:!1,isAnimationActive:!1,children:(()=>{if(e){let t=["#bdbdbd","#9e9e9e","#e0e0e0"];return e.map((e,a)=>(0,r.jsx)(j.f,{fill:t[a%t.length]},e.serviceName))}let t=new Map;o.forEach(e=>{let a=e.serviceName||e.type;t.set(a,(t.get(a)||0)+1)});let a=Array.from(t.entries()).sort((e,t)=>e[1]-t[1]).slice(0,3),s=["#bdbdbd","#9e9e9e","#e0e0e0"];return a.map(([e],t)=>(0,r.jsx)(j.f,{fill:s[t%s.length]},e))})()}),(0,r.jsx)(x.m,{content:(0,r.jsx)(C,{label:"Bottom 3 dịch vụ theo số lượng"})})]})}),(0,r.jsx)("div",{className:k().dynamic([["2f0483ac8cc1fbf0",[c?"8px":"12px"]]])+" overflow-hidden",children:(0,r.jsx)("ul",{className:k().dynamic([["2f0483ac8cc1fbf0",[c?"8px":"12px"]]])+" flex flex-wrap gap-2 mt-2 text-xs",children:n.map(e=>(0,r.jsxs)("li",{className:k().dynamic([["2f0483ac8cc1fbf0",[c?"8px":"12px"]]])+" flex items-start gap-1",children:[(0,r.jsx)("span",{style:{background:e.color},className:k().dynamic([["2f0483ac8cc1fbf0",[c?"8px":"12px"]]])+" inline-block w-3 h-3 rounded-full flex-shrink-0 mt-0.5"}),(0,r.jsx)("span",{className:k().dynamic([["2f0483ac8cc1fbf0",[c?"8px":"12px"]]])+" break-words",children:e.name})]},e.name))})})]}),(0,r.jsxs)("div",{className:k().dynamic([["2f0483ac8cc1fbf0",[c?"8px":"12px"]]])+" w-full lg:w-1/2 bg-white rounded-xl shadow-lg mt-5 p-4",children:[(0,r.jsx)("div",{className:k().dynamic([["2f0483ac8cc1fbf0",[c?"8px":"12px"]]])+" text-lg lg:text-xl font-medium text-gray-700 text-center mb-4",children:"Bottom 3 dịch vụ theo gi\xe1 buổi"}),s&&(0,r.jsx)("div",{className:k().dynamic([["2f0483ac8cc1fbf0",[c?"8px":"12px"]]])+" text-blue-600 text-sm text-center mb-4",children:"\uD83D\uDD04 Đang tải dữ liệu bottom 3 dịch vụ theo gi\xe1 buổi..."}),l&&(0,r.jsxs)("div",{className:k().dynamic([["2f0483ac8cc1fbf0",[c?"8px":"12px"]]])+" text-red-600 text-sm text-center mb-4",children:["❌ Lỗi API bottom 3 dịch vụ theo gi\xe1 buổi:"," ",l]}),(0,r.jsx)(d.u,{width:"100%",height:c?250:350,children:(0,r.jsxs)(v.r,{children:[(0,r.jsx)(y.F,{data:i,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:c?45:90,label:({percent:e})=>e&&e>.15?`${(100*e).toFixed(1)}%`:"",labelLine:!1,isAnimationActive:!1,children:i.map(e=>(0,r.jsx)(j.f,{fill:e.color},e.name))}),(0,r.jsx)(x.m,{content:(0,r.jsx)(C,{label:"Bottom 3 dịch vụ theo gi\xe1 buổi"})})]})}),(0,r.jsx)("ul",{className:k().dynamic([["2f0483ac8cc1fbf0",[c?"8px":"12px"]]])+" flex flex-wrap  gap-3 mt-2 text-xs",children:n.map(e=>(0,r.jsxs)("li",{className:k().dynamic([["2f0483ac8cc1fbf0",[c?"8px":"12px"]]])+"  flex gap-1",children:[(0,r.jsx)("span",{style:{background:e.color},className:k().dynamic([["2f0483ac8cc1fbf0",[c?"8px":"12px"]]])+" inline-block w-3 h-3 rounded-full"}),e.name]},e.name))})]})]})]})}function D({title:e,value:t,delta:a,className:s,valueColor:l}){let n=null!==a&&a>0,i=null!==a&&a<0;return(0,r.jsxs)("div",{className:`bg-white rounded-xl shadow p-6 flex flex-col items-center min-w-[220px] border-4 transition-all duration-300 hover:scale-105 hover:shadow-lg ${s??"border-gray-200"}`,children:[(0,r.jsx)("div",{className:"text-sm text-gray-700 mb-1 text-center",children:e}),(0,r.jsx)("div",{className:`text-4xl font-bold mb-1 text-center ${l??"text-black"}`,children:t.toLocaleString()}),(0,r.jsxs)("div",{className:`text-lg font-semibold flex items-center gap-1 ${n?"text-green-600":i?"text-red-500":"text-gray-500"}`,children:[n&&(0,r.jsx)("span",{children:"↑"}),i&&(0,r.jsx)("span",{children:"↓"}),null===a?"N/A":Math.abs(a).toLocaleString()]})]})}function M({serviceSummary:e,serviceSummaryLoading:t,serviceSummaryError:a}){let[s,n]=l().useState(0),i=l().useRef(null),o=l().useCallback(()=>{if(i.current){let e=i.current,t=e.scrollLeft,a=e.clientWidth,r=e.scrollWidth-a;t<=0?n(0):t>=r?n(2):n(Math.round(t/r*2))}},[]),d=e=>{if(i.current){let t=i.current,a=t.clientWidth,r=t.scrollWidth-a;t.scrollTo({left:0===e?0:2===e?r:r/2,behavior:"smooth"}),n(e)}},c=l().useMemo(()=>e?{comboThisWeek:e.totalCombo,retailThisWeek:e.totalLe,ctThisWeek:e.totalCT,giftThisWeek:e.totalGift,totalServiceThisWeek:e.totalAll,pendingThisWeek:e.totalPending||0,deltaCombo:e.totalCombo-e.prevCombo,deltaRetail:e.totalLe-e.prevLe,deltaCT:e.totalCT-e.prevCT,deltaGift:e.totalGift-e.prevGift,deltaTotalService:e.totalAll-e.prevAll,deltaPending:(e.totalPending||0)-(e.prevPending||0)}:{comboThisWeek:1629,retailThisWeek:726,ctThisWeek:0,giftThisWeek:0,totalServiceThisWeek:2355,pendingThisWeek:180,deltaCombo:100,deltaRetail:50,deltaCT:0,deltaGift:0,deltaTotalService:150,deltaPending:25},[e]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"w-full mb-2",children:[t&&(0,r.jsx)("div",{className:"text-blue-600 text-sm",children:"\uD83D\uDD04 Đang tải dữ liệu..."}),a&&(0,r.jsxs)("div",{className:"text-red-600 text-sm",children:["❌ Lỗi API: ",a]})]}),(0,r.jsx)("div",{className:"md:hidden w-full mb-5 mt-5",children:(0,r.jsxs)("div",{style:{scrollbarWidth:"thin",scrollbarColor:"#fbbf24 #f3f4f6"},className:"jsx-426aa263b6fa0a9f max-h-96 overflow-y-auto",children:[(0,r.jsx)(k(),{id:"426aa263b6fa0a9f",children:"div.jsx-426aa263b6fa0a9f::-webkit-scrollbar{width:6px}div.jsx-426aa263b6fa0a9f::-webkit-scrollbar-track{background:#f3f4f6;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px}div.jsx-426aa263b6fa0a9f::-webkit-scrollbar-thumb{background:#fbbf24;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px}div.jsx-426aa263b6fa0a9f::-webkit-scrollbar-thumb:hover{background:#f59e0b}"}),(0,r.jsxs)("div",{className:"jsx-426aa263b6fa0a9f flex flex-col gap-4",children:[(0,r.jsx)(D,{title:"Tổng Combo",value:c.comboThisWeek,delta:c.deltaCombo,valueColor:"text-black",className:"bg-[#33a7b5] w-full"}),(0,r.jsx)(D,{title:"Tổng dịch vụ lẻ",value:c.retailThisWeek,delta:c.deltaRetail,valueColor:"text-black",className:"bg-[#9b51e0] w-full"}),(0,r.jsx)(D,{title:"Tổng dịch vụ CT",value:c.ctThisWeek,delta:c.deltaCT,valueColor:"text-black",className:"bg-[#ee2c82] w-full"}),(0,r.jsx)(D,{title:"Tổng qu\xe0 tặng",value:c.giftThisWeek,delta:c.deltaGift,valueColor:"text-black",className:"bg-[#f16a3f] w-full"}),(0,r.jsx)(D,{title:"Tổng dịch vụ thực hiện",value:c.totalServiceThisWeek,delta:c.deltaTotalService,valueColor:"text-black",className:"bg-[#7adcb4] w-full"}),(0,r.jsx)(D,{title:"Tổng dịch vụ chưa thực hiện",value:c.pendingThisWeek,delta:c.deltaPending,valueColor:"text-black",className:"bg-[#ff6b6b] w-full"})]})]})}),(0,r.jsxs)("div",{className:"hidden md:flex flex-col items-center w-full",children:[(0,r.jsxs)("div",{ref:i,onScroll:o,style:{scrollbarWidth:"none",scrollbarColor:"#fbbf24 #f3f4f6"},className:"jsx-fcbb50f812f88ea2 flex overflow-x-auto scrollbar-hide gap-4 mb-5 mt-5 w-[80%]",children:[(0,r.jsx)(k(),{id:"fcbb50f812f88ea2",children:"div.jsx-fcbb50f812f88ea2::-webkit-scrollbar{height:8px}div.jsx-fcbb50f812f88ea2::-webkit-scrollbar-track{background:#f3f4f6;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px}div.jsx-fcbb50f812f88ea2::-webkit-scrollbar-thumb{background:#fbbf24;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px}div.jsx-fcbb50f812f88ea2::-webkit-scrollbar-thumb:hover{background:#f59e0b}"}),(0,r.jsx)(D,{title:"Tổng Combo",value:c.comboThisWeek,delta:c.deltaCombo,valueColor:"text-black",className:"bg-[#33a7b5] flex-shrink-0 w-64"}),(0,r.jsx)(D,{title:"Tổng dịch vụ lẻ",value:c.retailThisWeek,delta:c.deltaRetail,valueColor:"text-black",className:"bg-[#9b51e0] flex-shrink-0 w-64"}),(0,r.jsx)(D,{title:"Tổng dịch vụ CT",value:c.ctThisWeek,delta:c.deltaCT,valueColor:"text-black",className:"bg-[#ee2c82] flex-shrink-0 w-64"}),(0,r.jsx)(D,{title:"Tổng qu\xe0 tặng",value:c.giftThisWeek,delta:c.deltaGift,valueColor:"text-black",className:"bg-[#f16a3f] flex-shrink-0 w-64"}),(0,r.jsx)(D,{title:"Tổng dịch vụ thực hiện",value:c.totalServiceThisWeek,delta:c.deltaTotalService,valueColor:"text-black",className:"bg-[#7adcb4] flex-shrink-0 w-64"}),(0,r.jsx)(D,{title:"Tổng dịch vụ chưa thực hiện",value:c.pendingThisWeek,delta:c.deltaPending,valueColor:"text-black",className:"bg-[#ff6b6b] flex-shrink-0 w-64"})]}),(0,r.jsx)("div",{className:"flex justify-center gap-2 mt-4",children:[0,1,2].map(e=>(0,r.jsx)("button",{onClick:()=>d(e),className:`w-3 h-3 rounded-full transition-all duration-300 ${s===e?"bg-orange-300 scale-25":"bg-gray-300 hover:bg-gray-400"}`,title:`Card ${e+1}`},e))})]})]})}function _({shopLoading:e,shopError:t,isMobile:a,storeServiceChartData:s}){return(0,r.jsxs)("div",{className:"w-full bg-white rounded-xl shadow-lg mt-5 p-4",children:[(0,r.jsx)("div",{className:"text-xl font-medium text-gray-700 text-center mb-4",children:"Tổng dịch vụ thực hiện theo cửa h\xe0ng"}),e&&(0,r.jsx)("div",{className:"text-blue-600 text-sm text-center mb-4",children:"\uD83D\uDD04 Đang tải dữ liệu cửa h\xe0ng..."}),t&&(0,r.jsxs)("div",{className:"text-red-600 text-sm text-center mb-4",children:["❌ Lỗi API cửa h\xe0ng: ",t]}),(0,r.jsx)("div",{className:"w-full overflow-x-auto",children:(0,r.jsx)("div",{className:"min-w-[600px] md:min-w-0 ",children:(0,r.jsx)(d.u,{width:a?500:"100%",height:800,children:(0,r.jsxs)(c.E,{data:s,layout:"vertical",margin:{top:20,right:30,left:a?60:120,bottom:20},children:[(0,r.jsx)(h.d,{strokeDasharray:"3 3"}),(0,r.jsx)(u.W,{type:"number",tickFormatter:e=>e>=1e3?`${e/1e3}k`:e.toString(),tick:{fontSize:a?10:14}}),(0,r.jsx)(m.h,{dataKey:"store",type:"category",tick:{fontSize:a?10:12},width:a?150:200,tickLine:!1,axisLine:!1,interval:0}),(0,r.jsx)(x.m,{}),(0,r.jsx)(g.s,{wrapperStyle:{fontSize:a?10:14}}),(0,r.jsx)(p.y,{dataKey:"combo",name:"Combo",stackId:"a",fill:"#795548"}),(0,r.jsx)(p.y,{dataKey:"service",name:"Dịch vụ",stackId:"a",fill:"#c5e1a5"}),(0,r.jsx)(p.y,{dataKey:"other",name:"Kh\xe1c",stackId:"a",fill:"#f16a3f",children:(0,r.jsx)(b.Z,{dataKey:"total",position:"right",formatter:e=>"number"==typeof e?e>=1e3?`${(e/1e3).toFixed(1)}k`:e.toString():"",fill:"#333",fontSize:a?10:12})})]})})})})]})}function A({regionLoading:e,regionError:t,isMobile:a,regionChartData:s}){return(0,r.jsxs)("div",{className:"w-full bg-white rounded-xl shadow-lg mt-5 p-4",children:[(0,r.jsx)("div",{className:"text-xl font-medium text-gray-700 text-center mb-4",children:"Tổng dịch vụ thực hiện theo khu vực"}),e&&(0,r.jsx)("div",{className:"text-blue-600 text-sm text-center mb-4",children:"\uD83D\uDD04 Đang tải dữ liệu khu vực..."}),t&&(0,r.jsxs)("div",{className:"text-red-600 text-sm text-center mb-4",children:["❌ Lỗi API khu vực: ",t]}),(0,r.jsx)("div",{className:"w-full overflow-x-auto",children:(0,r.jsx)("div",{className:"min-w-[600px] md:min-w-0 ",children:(0,r.jsx)(d.u,{width:a?500:"100%",height:a?400:500,children:(0,r.jsxs)(c.E,{data:s,layout:"vertical",margin:{top:20,right:30,left:a?40:100,bottom:20},children:[(0,r.jsx)(h.d,{strokeDasharray:"3 3"}),(0,r.jsx)(u.W,{type:"number",tickFormatter:e=>e>=1e3?`${e/1e3}k`:e.toString(),tick:{fontSize:a?10:14}}),(0,r.jsx)(m.h,{dataKey:"region",type:"category",tick:{fontSize:a?10:12},width:a?120:150}),(0,r.jsx)(x.m,{}),(0,r.jsx)(g.s,{wrapperStyle:{fontSize:a?10:14}}),(0,r.jsx)(p.y,{dataKey:"combo",name:"Combo",stackId:"a",fill:"#795548"}),(0,r.jsx)(p.y,{dataKey:"service",name:"Dịch vụ",stackId:"a",fill:"#c5e1a5"}),(0,r.jsx)(p.y,{dataKey:"other",name:"Kh\xe1c",stackId:"a",fill:"#f16a3f"})]})})})})]})}function P({serviceTableData:e,serviceTableLoading:t,serviceTableError:a,serviceData:s}){return(0,r.jsxs)("div",{className:"w-full bg-white rounded-xl shadow-lg mt-5 p-4",children:[(0,r.jsx)("div",{className:"text-lg lg:text-xl font-medium text-gray-700 text-center mb-4",children:"Bảng dịch vụ"}),t&&(0,r.jsx)("div",{className:"text-blue-600 text-sm text-center mb-4",children:"\uD83D\uDD04 Đang tải dữ liệu bảng dịch vụ..."}),a&&(0,r.jsxs)("div",{className:"text-red-600 text-sm text-center mb-4",children:["❌ Lỗi API bảng dịch vụ: ",a]}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsx)("div",{style:{maxHeight:400,overflowY:"auto",scrollbarWidth:"none",msOverflowStyle:"none",width:"100%"},children:(0,r.jsxs)("table",{className:"min-w-[700px] lg:min-w-full text-xs sm:text-sm border table-fixed",style:{tableLayout:"fixed",width:"100%"},children:[(0,r.jsx)("thead",{className:"sticky top-0 z-10",children:(0,r.jsxs)("tr",{className:"bg-yellow-200 text-gray-900",children:[(0,r.jsx)("th",{className:"w-12 px-2 py-2 border text-center font-bold",children:"STT"}),(0,r.jsx)("th",{className:"w-64 px-2 py-2 border text-left font-bold",children:"Dịch vụ"}),(0,r.jsx)("th",{className:"w-24 px-2 py-2 border text-center font-bold",children:"Loại"}),(0,r.jsx)("th",{className:"w-20 px-2 py-2 border text-right font-bold bg-orange-100",children:"Số lượng"}),(0,r.jsx)("th",{className:"w-20 px-2 py-2 border text-right font-bold",children:"Δ"}),(0,r.jsx)("th",{className:"w-24 px-2 py-2 border text-right font-bold",children:"% Số lượng"}),(0,r.jsx)("th",{className:"w-32 px-2 py-2 border text-right font-bold bg-blue-100",children:"Tổng gi\xe1"}),(0,r.jsx)("th",{className:"w-20 px-2 py-2 border text-right font-bold",children:"% Δ"}),(0,r.jsx)("th",{className:"w-24 px-2 py-2 border text-right font-bold",children:"% Tổng gi\xe1"})]})}),(0,r.jsx)("tbody",{children:e?e.map((e,t)=>(0,r.jsxs)("tr",{className:t%2==0?"bg-white":"bg-gray-50",children:[(0,r.jsx)("td",{className:"w-12 px-2 py-1 border text-center",children:t+1}),(0,r.jsx)("td",{className:"w-64 px-2 py-1 border text-left font-medium",title:e.serviceName,children:(0,r.jsxs)("div",{className:"truncate",children:[(0,r.jsx)("span",{className:"hidden lg:inline",children:e.serviceName}),(0,r.jsx)("span",{className:"lg:hidden text-xs",children:e.serviceName.length>15?e.serviceName.substring(0,15)+"...":e.serviceName})]})}),(0,r.jsx)("td",{className:"w-24 px-2 py-1 border text-center",children:e.type}),(0,r.jsx)("td",{className:"w-20 px-2 py-1 border text-right font-bold bg-orange-100 text-orange-700",children:e.usageCount?.toLocaleString?.()??e.usageCount}),(0,r.jsxs)("td",{className:`w-20 px-2 py-1 border text-right font-semibold ${e.usageDeltaCount>0?"text-green-600":e.usageDeltaCount<0?"text-red-500":""}`,children:[e.usageDeltaCount?.toLocaleString?.()??e.usageDeltaCount," ",e.usageDeltaCount>0?"↑":e.usageDeltaCount<0?"↓":""]}),(0,r.jsxs)("td",{className:"w-24 px-2 py-1 border text-right",children:[e.usagePercent?.toFixed(1),"%"]}),(0,r.jsx)("td",{className:"w-32 px-2 py-1 border text-right font-bold bg-blue-100 text-blue-700",children:e.totalRevenue?.toLocaleString?.()??e.totalRevenue}),(0,r.jsxs)("td",{className:`w-20 px-2 py-1 border text-right font-semibold ${e.revenueDeltaPercent>100?"text-green-600":e.revenueDeltaPercent<100?"text-red-500":""}`,children:[e.revenueDeltaPercent?.toFixed(1),"%"," ",e.revenueDeltaPercent>100?"↑":e.revenueDeltaPercent<100?"↓":""]}),(0,r.jsxs)("td",{className:"w-24 px-2 py-1 border text-right",children:[e.revenuePercent?.toFixed(1),"%"]})]},`${e.serviceName}-${t}`)):s.map((e,t)=>{let a=Math.floor(1e3*Math.random())*(Math.random()>.2?1:-1),s=a>0?(10*Math.random()+100).toFixed(1):(10*Math.random()+90).toFixed(1);return(0,r.jsxs)("tr",{className:t%2==0?"bg-white":"bg-gray-50",children:[(0,r.jsx)("td",{className:"w-12 px-2 py-1 border text-center",children:t+1}),(0,r.jsx)("td",{className:"w-64 px-2 py-1 border text-left font-medium",title:e.tenDichVu,children:(0,r.jsxs)("div",{className:"truncate",children:[(0,r.jsx)("span",{className:"hidden lg:inline",children:e.tenDichVu}),(0,r.jsx)("span",{className:"lg:hidden text-xs",children:e.tenDichVu.length>15?e.tenDichVu.substring(0,15)+"...":e.tenDichVu})]})}),(0,r.jsx)("td",{className:"w-24 px-2 py-1 border text-center",children:e.loaiDichVu}),(0,r.jsx)("td",{className:"w-20 px-2 py-1 border text-right font-bold bg-orange-100 text-orange-700",children:e.soLuong?.toLocaleString?.()??e.soLuong}),(0,r.jsxs)("td",{className:`w-20 px-2 py-1 border text-right font-semibold ${a>0?"text-green-600":a<0?"text-red-500":""}`,children:[a?.toLocaleString?.()??a," ",a>0?"↑":a<0?"↓":""]}),(0,r.jsxs)("td",{className:"w-24 px-2 py-1 border text-right",children:[e.percentSoLuong,"%"]}),(0,r.jsx)("td",{className:"w-32 px-2 py-1 border text-right font-bold bg-blue-100 text-blue-700",children:e.tongGia?.toLocaleString?.()??e.tongGia}),(0,r.jsxs)("td",{className:`w-20 px-2 py-1 border text-right font-semibold ${a>0?"text-green-600":a<0?"text-red-500":""}`,children:[s,"%"," ",a>0?"↑":a<0?"↓":""]}),(0,r.jsxs)("td",{className:"w-24 px-2 py-1 border text-right",children:[e.percentTongGia,"%"]})]},`${e.tenDichVu}-${t}`)})}),(0,r.jsx)("tfoot",{children:(0,r.jsxs)("tr",{className:"bg-gray-100 font-bold border-t-2 border-gray-400 sticky bottom-0 z-10",children:[(0,r.jsx)("td",{className:"w-12 px-2 py-1 border text-center"}),(0,r.jsxs)("td",{className:"w-64 px-2 py-1 border text-left",children:[(0,r.jsx)("span",{className:"hidden lg:inline",children:"Tổng cộng"}),(0,r.jsx)("span",{className:"lg:hidden text-xs",children:"Tổng"})]}),(0,r.jsx)("td",{className:"w-24 px-2 py-1 border text-center"}),(0,r.jsx)("td",{className:"w-20 px-2 py-1 border text-right bg-orange-100 text-orange-700",children:e?e.reduce((e,t)=>e+(t.usageCount||0),0).toLocaleString():s.reduce((e,t)=>e+(t.soLuong||0),0).toLocaleString()}),(0,r.jsx)("td",{className:"w-20 px-2 py-1 border text-right",children:e?(e.reduce((e,t)=>e+(t.usageDeltaCount||0),0)/e.length).toFixed(0):"—"}),(0,r.jsx)("td",{className:"w-24 px-2 py-1 border text-right",children:"100%"}),(0,r.jsx)("td",{className:"w-32 px-2 py-1 border text-right bg-blue-100 text-blue-700",children:e?e.reduce((e,t)=>e+(t.totalRevenue||0),0).toLocaleString():s.reduce((e,t)=>e+(t.tongGia||0),0).toLocaleString()}),(0,r.jsx)("td",{className:"w-20 px-2 py-1 border text-right",children:e?(e.reduce((e,t)=>e+(t.revenueDeltaPercent||0),0)/e.length).toFixed(1):"—"}),(0,r.jsx)("td",{className:"w-24 px-2 py-1 border text-right",children:"100%"})]})})]})})})]})}var H=a(13193),F=a(70212),L=a(34276);let R="https://338bc771545b.ngrok-free.app";function $(e,t,a){let[r,l]=(0,s.useState)(null),[n,i]=(0,s.useState)(!0),[o,d]=(0,s.useState)(null);return{data:r,loading:n,error:o}}function E(){let{notification:e,showSuccess:t,showError:a,hideNotification:d}=(0,H.h)();(0,s.useRef)(!1),(0,s.useRef)(!1);let{reportPageError:c,reportDataLoadSuccess:h,reportFilterChange:u,reportResetFilters:m,reportPagePerformance:x}=(0,L.n)("services"),[g,p]=(0,F.V)("services-startDate",(0,n.Ec)((0,n.Xj)()).subtract({days:7})),[b,v]=(0,F.V)("services-endDate",(0,n.Ec)((0,n.Xj)())),[y,j]=(0,F.V)("services-selectedBranches",[]),[N,S]=(0,F.V)("services-selectedRegions",[]),[k,C]=(0,F.V)("services-selectedServiceTypes",["Kh\xe1ch h\xe0ng Th\xe0nh vi\xean","KH trải nghiệm","Added on","Qu\xe0 tặng"]),[D,E]=(0,F.V)("services-selectedGenders",["Nam","Nữ","#N/A"]),V=g?`${g.year}-${String(g.month).padStart(2,"0")}-${String(g.day).padStart(2,"0")}T00:00:00`:"",z=b?`${b.year}-${String(b.month).padStart(2,"0")}-${String(b.day).padStart(2,"0")}T23:59:59`:"",{data:K}=$(`${R}/api/service-record/service-type-breakdown`,V,z),{data:Q,loading:G,error:W}=$(`${R}/api/service-record/service-summary`,V,z),{data:B,loading:I,error:O}=$(`${R}/api/service-record/region`,V,z),{data:U,loading:q,error:X}=$(`${R}/api/service-record/shop`,V,z),{data:Z,loading:Y,error:J}=$(`${R}/api/service-record/top10-services-revenue`,V,z),{data:ee,loading:et,error:ea}=$(`${R}/api/service-record/top10-services-usage`,V,z),{data:er,loading:es,error:el}=$(`${R}/api/service-record/bottom3-services-usage`,V,z),{data:en,loading:ei,error:eo}=$(`${R}/api/service-record/bottom3-services-revenue`,V,z),{data:ed,loading:ec,error:eh}=$(`${R}/api/service-record/top-table`,V,z),eu=[W,O,X,J,ea,el,eo,eh];[G,I,q,Y,et,es,ei,ec].some(e=>e),eu.some(e=>e);let em=640>function(){let[e,t]=(0,s.useState)(1024);return e}(),ex=[{key:"Kh\xe1ch h\xe0ng Th\xe0nh vi\xean",label:"Combo"},{key:"KH trải nghiệm",label:"Dịch vụ"},{key:"Added on",label:"Added on"},{key:"Qu\xe0 tặng",label:"Gifts"},{key:"Fox card",label:"Fox card"}],eg=["Nam","Nữ","#N/A"],[ep]=(0,s.useState)(""),eb=l().useMemo(()=>["Crescent Mall Q7","Vincom Thảo Điền","Vista Verde","Aeon Mall T\xe2n Ph\xfa Celadon","Westpoint Phạm H\xf9ng","Aeon Mall B\xecnh T\xe2n","Vincom Phan Văn Trị","Vincom Landmark 81","TTTM Estella Place","V\xf5 Thị S\xe1u Q.1","The Sun Avenue","Trương Định Q.3","Hoa Lan Q.PN","Nowzone Q.1","Everrich Infinity Q.5","SC VivoCity","Đảo Ngọc Ngũ X\xe3 HN","Vincom L\xea Văn Việt","The Bonatica Q.TB","Midtown Q.7","Trần Ph\xfa Đ\xe0 Nẵng","Vincom Quang Trung","Vincom B\xe0 Triệu","Imperia Sky Garden HN","Gold Coast Nha Trang","Riviera Point Q7","Saigon Ofice","Millenium Apartment Q.4","Parc Mall Q.8","Saigon Mia Trung Sơn"],[]),ef=l().useMemo(()=>({"Crescent Mall Q7":"HCM","Vincom Thảo Điền":"HCM","Vista Verde":"HCM","Aeon Mall T\xe2n Ph\xfa Celadon":"HCM","Westpoint Phạm H\xf9ng":"HCM","Aeon Mall B\xecnh T\xe2n":"HCM","Vincom Phan Văn Trị":"HCM","Vincom Landmark 81":"HCM","TTTM Estella Place":"HCM","V\xf5 Thị S\xe1u Q.1":"HCM","The Sun Avenue":"HCM","Trương Định Q.3":"HCM","Hoa Lan Q.PN":"HCM","Nowzone Q.1":"HCM","Everrich Infinity Q.5":"HCM","SC VivoCity":"HCM","Vincom L\xea Văn Việt":"HCM","The Bonatica Q.TB":"HCM","Midtown Q.7":"HCM","Riviera Point Q7":"HCM","Saigon Ofice":"HCM","Millenium Apartment Q.4":"HCM","Parc Mall Q.8":"HCM","Saigon Mia Trung Sơn":"HCM","Đảo Ngọc Ngũ X\xe3 HN":"H\xe0 Nội","Imperia Sky Garden HN":"H\xe0 Nội","Vincom B\xe0 Triệu":"H\xe0 Nội","Gold Coast Nha Trang":"Nha Trang","Trần Ph\xfa Đ\xe0 Nẵng":"Đ\xe0 Nẵng","Vincom Quang Trung":"HCM"}),[]),ev=l().useMemo(()=>[...Array.from({length:30},(e,t)=>{let a=`${t+1} thg 6`,r=["Crescent Mall Q7","Vincom Thảo Điền","Vista Verde","Aeon Mall T\xe2n Ph\xfa Celadon","Westpoint Phạm H\xf9ng","Aeon Mall B\xecnh T\xe2n","Vincom Phan Văn Trị","Vincom Landmark 81","TTTM Estella Place","V\xf5 Thị S\xe1u Q.1","The Sun Avenue","Trương Định Q.3","Hoa Lan Q.PN","Nowzone Q.1","Everrich Infinity Q.5","SC VivoCity","Đảo Ngọc Ngũ X\xe3 HN","Vincom L\xea Văn Việt","The Bonatica Q.TB","Midtown Q.7","Trần Ph\xfa Đ\xe0 Nẵng","Vincom Quang Trung","Vincom B\xe0 Triệu","Imperia Sky Garden HN","Gold Coast Nha Trang","Riviera Point Q7","Saigon Ofice","Millenium Apartment Q.4","Parc Mall Q.8","Saigon Mia Trung Sơn"];return[{date:a,value:12e5+t%5*2e4+1e3*t,value2:1e6+t%3*15e3+800*t,type:"KH trải nghiệm",status:"New",gender:"Nam",region:ef[r[t%r.length]],branch:r[t%r.length]},{date:a,value:125e4+t%4*18e3+1200*t,value2:105e4+t%2*17e3+900*t,type:"KH trải nghiệm",status:"New",gender:"Nữ",region:ef[r[(t+1)%r.length]],branch:r[(t+1)%r.length]},{date:a,value:13e5+t%6*22e3+1100*t,value2:11e5+t%4*13e3+700*t,type:"Kh\xe1ch h\xe0ng Th\xe0nh vi\xean",status:"New",gender:"Nam",region:ef[r[(t+2)%r.length]],branch:r[(t+2)%r.length]},{date:a,value:135e4+t%3*25e3+900*t,value2:115e4+t%5*12e3+600*t,type:"Kh\xe1ch h\xe0ng Th\xe0nh vi\xean",status:"New",gender:"Nữ",region:ef[r[(t+3)%r.length]],branch:r[(t+3)%r.length]}]}).flat()],[ef]),ey=[{date:"9 thg 6, 2025",HCM:100,HaNoi:90,DaNang:80,NhaTrang:70,DaDongCua:60,type:"Tổng",status:"All"},{date:"8 thg 6, 2025",HCM:100,HaNoi:90,DaNang:80,NhaTrang:70,DaDongCua:60,type:"Tổng",status:"All"},{date:"7 thg 6, 2025",HCM:100,HaNoi:90,DaNang:80,NhaTrang:70,DaDongCua:60,type:"Tổng",status:"All"},{date:"6 thg 6, 2025",HCM:100,HaNoi:90,DaNang:80,NhaTrang:70,DaDongCua:60,type:"Tổng",status:"All"},{date:"5 thg 6, 2025",HCM:100,HaNoi:90,DaNang:80,NhaTrang:70,DaDongCua:60,type:"Tổng",status:"All"},{date:"4 thg 6, 2025",HCM:100,HaNoi:90,DaNang:80,NhaTrang:70,DaDongCua:60,type:"Tổng",status:"All"},{date:"3 thg 6, 2025",HCM:100,HaNoi:90,DaNang:80,NhaTrang:70,DaDongCua:60,type:"Tổng",status:"All"},{date:"1 thg 6, 2025",HCM:100,HaNoi:90,DaNang:80,NhaTrang:70,DaDongCua:60,type:"Tổng",status:"All"},{date:"2 thg 6, 2025",HCM:100,HaNoi:90,DaNang:80,NhaTrang:70,DaDongCua:60,type:"Tổng",status:"All"}],ej=l().useCallback((e,t,a)=>{let r=function(e){let t=e.match(/^(\d{1,2}) thg (\d{1,2}), (\d{4})$/);if(t){let[,e,a,r]=t;return(0,i._U)(`${r}-${a.padStart(2,"0")}-${e.padStart(2,"0")}`)}if(t=e.match(/^(\d{1,2}) thg (\d{1,2})$/)){let[,e,a]=t,r=String(new Date().getFullYear());return(0,i._U)(`${r}-${a.padStart(2,"0")}-${e.padStart(2,"0")}`)}throw Error("Invalid date format: "+e)}(e.date);return r.compare(t)>=0&&0>=r.compare(a)},[]),eN=g.subtract({days:7}),ew=g.subtract({days:1}),eS=eT(ey,N,y),ek=eT(ey,N,y),eC=["HCM","H\xe0 Nội","Đ\xe0 Nẵng","Nha Trang","Đ\xe3 Đ\xf3ng Cửa","Kh\xe1c"].map(e=>{let t=ev.filter(t=>t.region===e&&ej(t,g,b)).length,a=ev.filter(t=>t.region===e&&ej(t,eN,ew)).length,r=function(e){switch(e){case"HCM":default:return"HCM";case"H\xe0 Nội":return"HaNoi";case"Đ\xe0 Nẵng":return"DaNang";case"Nha Trang":return"NhaTrang";case"Đ\xe3 Đ\xf3ng Cửa":return"DaDongCua";case"Kh\xe1c":return"Khac"}}(e),s=eS.reduce((e,t)=>e+Number(t[r]??0),0),l=ek.reduce((e,t)=>e+Number(t[r]??0),0);return{region:e,ordersThisWeek:t,deltaOrders:t-a,revenueThisWeek:s,percentDelta:0===l?null:(s-l)/l*100,revenueLastWeek:l}});function eT(e,t,a){return e.filter(e=>{let r=!t||0===t.length||!e.region||t.includes(e.region),s=!a||0===a.length||!e.branch||a.includes(e.branch);return r&&s})}let[eD]=(0,s.useState)(""),[eM]=(0,s.useState)("");(0,s.useRef)(null),(0,s.useRef)(null);let e_=ex.filter(e=>e.label.toLowerCase().includes(eD.toLowerCase())),eA=eg.filter(e=>e.toLowerCase().includes(eM.toLowerCase())),eP=eC.map(e=>({name:e.region,total:Object.values(ef).filter(t=>t===e.region).length})),eH=l().useMemo(()=>eP.filter(e=>e.name.toLowerCase().includes(ep.toLowerCase())),[eP,ep]),eF={};eb.forEach(e=>{eF[e]=ev.filter(t=>t.branch===e&&ej(t,g,b)).reduce((e,t)=>e+t.value,0)});let eL={};ev.forEach(e=>{"Kh\xe1ch h\xe0ng Th\xe0nh vi\xean"!==e.type&&(eL[e.date]||(eL[e.date]={count:0,avgPerShop:0}),eL[e.date].count++)}),Object.keys(eL).forEach(e=>{let t=new Set(ev.filter(t=>t.date===e&&"Kh\xe1ch h\xe0ng Th\xe0nh vi\xean"!==t.type).map(e=>e.branch));eL[e].avgPerShop=t.size>0?Math.round(eL[e].count/t.size):0});let eR=Object.entries(eL).sort((e,t)=>{let[a,r]=e[0].split(" thg "),[s,l]=t[0].split(" thg ");return Number(r)!==Number(l)?Number(r)-Number(l):Number(a)-Number(s)}),e$=[240,173,201,281,269,167,166,131,228,247,380,403,217,193,210,236,244,367,411,271,256,288,291,358,398,309,191,49,17,31,67];eR.forEach(([,e],t)=>{e.count=e$[t%e$.length],e.avgPerShop=5+Math.floor(11*Math.random())});let eE=l().useMemo(()=>{let e=[],t=g;for(;0>=t.compare(b);)e.push(t),t=t.add({days:1});return e},[g,b]),eV=l().useMemo(()=>{if(!K)return eE.map(e=>({date:`${e.day} thg ${e.month}`,combo:0,service:0,addedon:0,foxcard:0}));let e=new Map;return eE.forEach(t=>{let a=`${t.year}-${String(t.month).padStart(2,"0")}-${String(t.day).padStart(2,"0")}`;e.set(a,{combo:0,service:0,addedon:0,foxcard:0})}),K.forEach(t=>{let a=t.date,r=e.get(a);if(r)switch(t.type){case"Combo":r.combo=t.count;break;case"Dịch vụ":r.service=t.count;break;case"Kh\xe1c":r.addedon=t.count}}),eE.map(t=>{let a=`${t.year}-${String(t.month).padStart(2,"0")}-${String(t.day).padStart(2,"0")}`,r=e.get(a)||{combo:0,service:0,addedon:0,foxcard:0},s=Math.round(.218*(r.combo+r.service+r.addedon));return{date:`${t.day} thg ${t.month}`,combo:r.combo,service:r.service,addedon:r.addedon,foxcard:s}})},[K,eE]),ez=l().useMemo(()=>{if(!B)return[];let e=new Map;return B.forEach(t=>{e.has(t.region)||e.set(t.region,{combo:0,service:0,other:0});let a=e.get(t.region);switch(t.type){case"Combo":a.combo=t.total;break;case"Dịch vụ":a.service=t.total;break;case"Kh\xe1c":a.other=t.total}}),Array.from(e.entries()).map(([e,t])=>({region:e,combo:t.combo,service:t.service,other:t.other,total:t.combo+t.service+t.other})).sort((e,t)=>t.total-e.total)},[B]),eK=l().useMemo(()=>{if(!K)return[];let e=new Map;K.forEach(t=>{let a=t.type;e.has(a)||e.set(a,{count:0,type:t.type}),e.get(a).count+=t.count});let t=Array.from(e.values()).reduce((e,t)=>e+t.count,0);return Array.from(e.entries()).map(([e,a])=>({tenDichVu:e,loaiDichVu:e,soLuong:a.count,tongGia:1e6*a.count,percentSoLuong:t>0?(a.count/t*100).toFixed(1):"0.0",percentTongGia:t>0?(a.count/t*100).toFixed(1):"0.0"}))},[K]);ev.some(e=>"Added on"===e.type)||ev.push({date:`${g.day} thg ${g.month}`,value:1e6,value2:5e5,type:"Added on",status:"New",gender:"Nam",region:"HCM",branch:"Crescent Mall Q7"}),ev.some(e=>"Qu\xe0 tặng"===e.type)||ev.push({date:`${g.day} thg ${g.month}`,value:8e5,value2:3e5,type:"Qu\xe0 tặng",status:"New",gender:"#N/A",region:"HCM",branch:"Vincom Landmark 81"}),ev.some(e=>"#N/A"===e.gender)||ev.push({date:`${g.day} thg ${g.month}`,value:12e5,value2:6e5,type:"KH trải nghiệm",status:"New",gender:"#N/A",region:"HCM",branch:"Vista Verde"});let eQ=U?Object.entries(U.reduce((e,t)=>(e[t.shopName]||(e[t.shopName]={}),e[t.shopName][t.serviceType]=t.total,e),{})).map(([e,t])=>{let a=t.Combo||0,r=t["Dịch vụ"]||0,s=t["Kh\xe1c"]||0;return{store:e,combo:a,service:r,other:s,total:a+r+s}}).sort((e,t)=>t.total-e.total):eb.map(e=>{let t=ev.filter(t=>t.branch===e&&ej(t,g,b)&&k.includes(t.type)&&D.includes(t.gender)),a=t.filter(e=>"Kh\xe1ch h\xe0ng Th\xe0nh vi\xean"===e.type).length,r=t.filter(e=>"KH trải nghiệm"===e.type).length,s=t.filter(e=>"Added on"===e.type).length,l=t.filter(e=>"Qu\xe0 tặng"===e.type).length,n=a+r+s+l;return{store:e,combo:a,service:r,addedon:s,gifts:l,foxcard:Math.round(.218*n),total:n}}).sort((e,t)=>t.total-e.total),eG=eg.map(e=>{let t=ev.filter(t=>t.gender===e&&ej(t,g,b)&&k.includes(t.type)).reduce((e,t)=>e+t.value,0);return{gender:e,total:t}}),eW=ev.filter(e=>ej(e,g,b)&&(0===N.length||!e.region||N.includes(e.region))&&(0===y.length||!e.branch||y.includes(e.branch))&&k.includes(e.type)&&D.includes(e.gender)),eB=l().useMemo(()=>{if(Q){let e=[{key:"combo",label:"Combo",value:Q.totalCombo,color:"#795548"},{key:"service",label:"Dịch vụ",value:Q.totalLe,color:"#c5e1a5"},{key:"addedon",label:"Added on",value:Q.totalCT,color:"#f16a3f"},{key:"gifts",label:"Gifts",value:Q.totalGift,color:"#8fd1fc"}],t=Math.round(.218*e.reduce((e,t)=>e+t.value,0));return[...e,{key:"foxcard",label:"Fox card",value:t,color:"#b26e7a"}]}let e=[{key:"combo",label:"Combo",value:eW.filter(e=>"Kh\xe1ch h\xe0ng Th\xe0nh vi\xean"===e.type).length,color:"#795548"},{key:"service",label:"Dịch vụ",value:eW.filter(e=>"KH trải nghiệm"===e.type).length,color:"#c5e1a5"},{key:"addedon",label:"Added on",value:eW.filter(e=>"Added on"===e.type).length,color:"#f16a3f"},{key:"gifts",label:"Gifts",value:eW.filter(e=>"Qu\xe0 tặng"===e.type).length,color:"#8fd1fc"}],t=Math.round(.218*e.reduce((e,t)=>e+t.value,0));return[...e,{key:"foxcard",label:"Fox card",value:t,color:"#b26e7a"}]},[Q,eW]),eI=l().useMemo(()=>{if(ee)return ee.map((e,t)=>({name:e.serviceName,value:e.count,color:`hsl(0,0%,${40+5*t}%)`}));let e=ev.filter(e=>ej(e,g,b)&&(0===N.length||!e.region||N.includes(e.region))&&(0===y.length||!e.branch||y.includes(e.branch))&&k.includes(e.type)&&D.includes(e.gender)),t=new Map;e.forEach(e=>{let a=e.serviceName||e.type;t.set(a,(t.get(a)||0)+1)});let a=Array.from(t.entries()).sort((e,t)=>t[1]-e[1]),r=a.slice(0,10),s=a.slice(10).reduce((e,[,t])=>e+t,0),l=r.map(([e,t],a)=>({name:e,value:t,color:`hsl(0,0%,${40+5*a}%)`}));return s>0&&l.push({name:"Kh\xe1c",value:s,color:"#ededed"}),l},[ee,ev,g,b,ej,N,y,k,D]),eO=l().useMemo(()=>{if(Z)return Z.map((e,t)=>({name:e.serviceName,value:e.servicePrice,color:`hsl(30, 100%, ${45+5*t}%)`}));let e=new Map;eW.forEach(t=>{let a=t.serviceName||t.type;e.has(a)||e.set(a,{totalValue:0,count:0});let r=e.get(a);r.totalValue+=t.value,r.count+=1});let t=Array.from(e.entries()).map(([e,{totalValue:t,count:a}])=>({name:e,avg:a>0?t/a:0,count:a})).sort((e,t)=>t.avg-e.avg),a=t.slice(0,10),r=t.slice(10).reduce((e,t)=>e+t.avg,0),s=a.map((e,t)=>({name:e.name,value:e.avg,color:`hsl(30, 100%, ${45+5*t}%)`}));return t.length>10&&s.push({name:"Kh\xe1c",value:r,color:"#ffe0b2"}),s},[Z,eW]),eU=l().useMemo(()=>{if(er){let e=["#bdbdbd","#9e9e9e","#e0e0e0"];return er.map((t,a)=>({name:t.serviceName,value:t.count,color:e[a%e.length]}))}let e=new Map;eW.forEach(t=>{let a=t.serviceName||t.type;e.set(a,(e.get(a)||0)+1)});let t=Array.from(e.entries()).sort((e,t)=>e[1]-t[1]).slice(0,3),a=["#bdbdbd","#9e9e9e","#e0e0e0"];return t.map(([e,t],r)=>({name:e,value:t,color:a[r%a.length]}))},[er,eW]),eq=l().useMemo(()=>{if(en){let e=["#bdbdbd","#9e9e9e","#e0e0e0"];return en.map((t,a)=>({name:t.serviceName,value:t.servicePrice,color:e[a%e.length]}))}let e=new Map;eW.forEach(t=>{let a=t.serviceName||t.type;e.has(a)||e.set(a,{totalValue:0,count:0});let r=e.get(a);r.totalValue+=t.value,r.count+=1});let t=Array.from(e.entries()).map(([e,{totalValue:t,count:a}])=>({name:e,avg:a>0?t/a:0,count:a})).sort((e,t)=>e.avg-t.avg).slice(0,3),a=["#bdbdbd","#9e9e9e","#e0e0e0"];return t.map((e,t)=>({name:e.name,value:e.avg,color:a[t%a.length]}))},[en,eW]);return(0,r.jsxs)("div",{className:"p-2 sm:p-4 md:p-6 max-w-full",children:[(0,r.jsx)(H.E,{type:e.type,message:e.message,isVisible:e.isVisible,onClose:d}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("div",{className:"p-2",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Services Report"}),(0,r.jsx)("button",{onClick:()=>{(0,F.e)(["services-startDate","services-endDate","services-selectedBranches","services-selectedRegions","services-selectedServiceTypes","services-selectedGenders"]),p((0,n.Ec)((0,n.Xj)()).subtract({days:7})),v((0,n.Ec)((0,n.Xj)())),j([]),S([]),C(["Kh\xe1ch h\xe0ng Th\xe0nh vi\xean","KH trải nghiệm","Added on","Qu\xe0 tặng"]),E(["Nam","Nữ","#N/A"]),t("Đ\xe3 reset tất cả filter về mặc định!"),m()},className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors text-sm",children:"Reset Filters"})]}),(0,r.jsx)(o,{startDate:g,endDate:b,setStartDate:p,setEndDate:v,today:n.Ec,getLocalTimeZone:n.Xj,selectedRegions:N,setSelectedRegions:S,selectedBranches:y,setSelectedBranches:j,selectedServiceTypes:k,setSelectedServiceTypes:C,selectedGenders:D,setSelectedGenders:E,regionOptions:eP,locationOptions:eb,filteredRegionOptions:eH,ALL_SERVICE_TYPES:ex,ALL_GENDERS:eg,filteredServiceTypes:e_,filteredGenders:eA,genderActualPrice:eG,formatMoneyShort:function(e){return e>=1e12?(e/1e12).toFixed(1)+" T":e>=1e9?(e/1e9).toFixed(1)+" T":e>=1e6?(e/1e6).toFixed(1)+" Tr":e.toLocaleString()}})]}),(0,r.jsx)(f,{weeklyServiceChartData:eV,isMobile:em}),(0,r.jsx)(w,{pieChartData:eB,pieTop10Data:eI,pieTop10AvgData:eO,top10ServicesLoading:Y,top10ServicesError:J,top10ServicesUsageLoading:et,top10ServicesUsageError:ea,isMobile:em,renderPieLabel:({percent:e,x:t,y:a,index:s})=>em&&void 0!==e&&e<0||void 0!==e&&e<.05?null:(0,r.jsxs)("text",{x:t,y:a,fill:eI[s??0]?.color||"#333",fontSize:em?10:14,fontWeight:"bold",textAnchor:"middle",dominantBaseline:"central",children:[(100*e).toFixed(1),"%"]})}),(0,r.jsx)(T,{bottom3ServicesUsageData:er,bottom3ServicesUsageLoading:es,bottom3ServicesUsageError:el,bottom3ServicesRevenueLoading:ei,bottom3ServicesRevenueError:eo,bottom3Data:eU,bottom3RevenueData:eq,filteredPieData:eW,isMobile:em}),(0,r.jsx)(M,{serviceSummary:Q,serviceSummaryLoading:G,serviceSummaryError:W}),(0,r.jsx)(_,{shopLoading:q,shopError:X,isMobile:em,storeServiceChartData:eQ}),(0,r.jsx)(A,{regionLoading:I,regionError:O,isMobile:em,regionChartData:ez}),(0,r.jsx)(P,{serviceTableData:ed,serviceTableLoading:ec,serviceTableError:eh,serviceData:eK})]})]})}},56397:()=>{},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},70212:(e,t,a)=>{"use strict";a.d(t,{V:()=>s,e:()=>l});var r=a(43210);function s(e,t){let[a,s]=(0,r.useState)(()=>t);return[a,t=>{try{let e="function"==typeof t?t(a):t;s(e)}catch(t){console.warn(`Error setting localStorage key "${e}":`,t)}}]}function l(e){}a(7562)},75913:(e,t,a)=>{"use strict";a(56397);var r=a(43210),s=function(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}(r),l="undefined"!=typeof process&&process.env&&!0,n=function(e){return"[object String]"===Object.prototype.toString.call(e)},i=function(){function e(e){var t=void 0===e?{}:e,a=t.name,r=void 0===a?"stylesheet":a,s=t.optimizeForSpeed,i=void 0===s?l:s;o(n(r),"`name` must be a string"),this._name=r,this._deletedRulePlaceholder="#"+r+"-deleted-rule____{}",o("boolean"==typeof i,"`optimizeForSpeed` must be a boolean"),this._optimizeForSpeed=i,this._serverSheet=void 0,this._tags=[],this._injected=!1,this._rulesCount=0,this._nonce=null}var t,a=e.prototype;return a.setOptimizeForSpeed=function(e){o("boolean"==typeof e,"`setOptimizeForSpeed` accepts a boolean"),o(0===this._rulesCount,"optimizeForSpeed cannot be when rules have already been inserted"),this.flush(),this._optimizeForSpeed=e,this.inject()},a.isOptimizeForSpeed=function(){return this._optimizeForSpeed},a.inject=function(){var e=this;o(!this._injected,"sheet already injected"),this._injected=!0,this._serverSheet={cssRules:[],insertRule:function(t,a){return"number"==typeof a?e._serverSheet.cssRules[a]={cssText:t}:e._serverSheet.cssRules.push({cssText:t}),a},deleteRule:function(t){e._serverSheet.cssRules[t]=null}}},a.getSheetForTag=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]},a.getSheet=function(){return this.getSheetForTag(this._tags[this._tags.length-1])},a.insertRule=function(e,t){return o(n(e),"`insertRule` accepts only strings"),"number"!=typeof t&&(t=this._serverSheet.cssRules.length),this._serverSheet.insertRule(e,t),this._rulesCount++},a.replaceRule=function(e,t){this._optimizeForSpeed;var a=this._serverSheet;if(t.trim()||(t=this._deletedRulePlaceholder),!a.cssRules[e])return e;a.deleteRule(e);try{a.insertRule(t,e)}catch(r){l||console.warn("StyleSheet: illegal rule: \n\n"+t+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),a.insertRule(this._deletedRulePlaceholder,e)}return e},a.deleteRule=function(e){this._serverSheet.deleteRule(e)},a.flush=function(){this._injected=!1,this._rulesCount=0,this._serverSheet.cssRules=[]},a.cssRules=function(){return this._serverSheet.cssRules},a.makeStyleTag=function(e,t,a){t&&o(n(t),"makeStyleTag accepts only strings as second parameter");var r=document.createElement("style");this._nonce&&r.setAttribute("nonce",this._nonce),r.type="text/css",r.setAttribute("data-"+e,""),t&&r.appendChild(document.createTextNode(t));var s=document.head||document.getElementsByTagName("head")[0];return a?s.insertBefore(r,a):s.appendChild(r),r},t=[{key:"length",get:function(){return this._rulesCount}}],function(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}();function o(e,t){if(!e)throw Error("StyleSheet: "+t+".")}var d=function(e){for(var t=5381,a=e.length;a;)t=33*t^e.charCodeAt(--a);return t>>>0},c={};function h(e,t){if(!t)return"jsx-"+e;var a=String(t),r=e+a;return c[r]||(c[r]="jsx-"+d(e+"-"+a)),c[r]}function u(e,t){var a=e+(t=t.replace(/\/style/gi,"\\/style"));return c[a]||(c[a]=t.replace(/__jsx-style-dynamic-selector/g,e)),c[a]}var m=function(){function e(e){var t=void 0===e?{}:e,a=t.styleSheet,r=void 0===a?null:a,s=t.optimizeForSpeed,l=void 0!==s&&s;this._sheet=r||new i({name:"styled-jsx",optimizeForSpeed:l}),this._sheet.inject(),r&&"boolean"==typeof l&&(this._sheet.setOptimizeForSpeed(l),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer=void 0,this._indices={},this._instancesCounts={}}var t=e.prototype;return t.add=function(e){var t=this;void 0===this._optimizeForSpeed&&(this._optimizeForSpeed=Array.isArray(e.children),this._sheet.setOptimizeForSpeed(this._optimizeForSpeed),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed());var a=this.getIdAndRules(e),r=a.styleId,s=a.rules;if(r in this._instancesCounts){this._instancesCounts[r]+=1;return}var l=s.map(function(e){return t._sheet.insertRule(e)}).filter(function(e){return -1!==e});this._indices[r]=l,this._instancesCounts[r]=1},t.remove=function(e){var t=this,a=this.getIdAndRules(e).styleId;if(function(e,t){if(!e)throw Error("StyleSheetRegistry: "+t+".")}(a in this._instancesCounts,"styleId: `"+a+"` not found"),this._instancesCounts[a]-=1,this._instancesCounts[a]<1){var r=this._fromServer&&this._fromServer[a];r?(r.parentNode.removeChild(r),delete this._fromServer[a]):(this._indices[a].forEach(function(e){return t._sheet.deleteRule(e)}),delete this._indices[a]),delete this._instancesCounts[a]}},t.update=function(e,t){this.add(t),this.remove(e)},t.flush=function(){this._sheet.flush(),this._sheet.inject(),this._fromServer=void 0,this._indices={},this._instancesCounts={}},t.cssRules=function(){var e=this,t=this._fromServer?Object.keys(this._fromServer).map(function(t){return[t,e._fromServer[t]]}):[],a=this._sheet.cssRules();return t.concat(Object.keys(this._indices).map(function(t){return[t,e._indices[t].map(function(e){return a[e].cssText}).join(e._optimizeForSpeed?"":"\n")]}).filter(function(e){return!!e[1]}))},t.styles=function(e){var t,a;return t=this.cssRules(),void 0===(a=e)&&(a={}),t.map(function(e){var t=e[0],r=e[1];return s.default.createElement("style",{id:"__"+t,key:"__"+t,nonce:a.nonce?a.nonce:void 0,dangerouslySetInnerHTML:{__html:r}})})},t.getIdAndRules=function(e){var t=e.children,a=e.dynamic,r=e.id;if(a){var s=h(r,a);return{styleId:s,rules:Array.isArray(t)?t.map(function(e){return u(s,e)}):[u(s,t)]}}return{styleId:h(r),rules:Array.isArray(t)?t:[t]}},t.selectFromServer=function(){return Array.prototype.slice.call(document.querySelectorAll('[id^="__jsx-"]')).reduce(function(e,t){return e[t.id.slice(2)]=t,e},{})},e}(),x=r.createContext(null);x.displayName="StyleSheetContext";s.default.useInsertionEffect||s.default.useLayoutEffect;var g=void 0;function p(e){var t=g||r.useContext(x);return t&&t.add(e),null}p.dynamic=function(e){return e.map(function(e){return h(e[0],e[1])}).join(" ")},t.style=p},76180:(e,t,a)=>{"use strict";e.exports=a(75913).style},79551:e=>{"use strict";e.exports=require("url")},96375:(e,t,a)=>{Promise.resolve().then(a.bind(a,31331))}};var t=require("../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[383,397,203,447,685,650,761,556],()=>a(18873));module.exports=r})();